const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/IntroColumn-BZi0ztkN.js","assets/index-BLLZ9mTO.js","assets/react-D41Hy763.js","assets/redux-BaDTb7KV.js","assets/index-D1aTzvq1.css","assets/App-BVpMKgT1.js"])))=>i.map(i=>d[i]);
import{j as e,v as t,w as n,x as a,b as s,a as o,y as l,_ as r,n as i,z as c,e as d}from"./index-BLLZ9mTO.js";import{r as u,R as m}from"./redux-BaDTb7KV.js";import{S as f,C as x}from"./Card-Ck-Uya6e.js";import{u as p,c as h,F as g,a as v,b,g as y,f as w,d as k,e as j,h as C,R as N,_ as E,i as S,r as T,n as R,j as $,k as P,l as L,m as M,o as O,p as z,q as D,s as F,t as A,v as U,w as I,x as W,y as B,z as _,P as V,I as G,A as H}from"./App-BVpMKgT1.js";import{L as Y}from"./LazyFlag-CX88JOSC.js";import{D as X}from"./Dropdown-C-WnEOdd.js";import{c as q,a as J,E as K}from"./ExportUtil-KvAMXrQ5.js";import{R as Q}from"./index-B5U7umHI.js";import"./react-D41Hy763.js";const Z=e=>e.some((e=>{var t,n;return null==(n=null==(t=null==e?void 0:e.contestant)?void 0:t.youtube)?void 0:n.length})),ee=e=>{const t=e.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/);return t&&11===t[7].length?t[7]:null},te=e=>e?`https://img.youtube.com/vi/${e}/hqdefault.jpg`:null,ne=n=>{var a,s,o,l,r,i,c,d;const m=p((e=>e.categories)),f=p((e=>e.activeCategory)),x=p((e=>e.globalSearch)),N=p((e=>e.showTotalRank)),E=p((e=>e.showComparison)),S=p((e=>e.showThumbnail)),T=p((e=>e.showPlace)),R=p((e=>e.vote)),$=n.countryContestant.contestant,P=n.countryContestant.country,L=u.useRef(null);p((e=>e.theme));const M=(e=>{if(!e)return null;const t=ee(e);return te(t)||null})(null==$?void 0:$.youtube);u.useEffect((()=>{L.current&&(L.current.scrollLeft=n.categoryScrollPosition)}),[n.categoryScrollPosition]);const O=function(){if(N||E)return y(m,n.countryContestant)}();return e.jsxs("div",{children:[e.jsxs("div",{className:h(n.className,"m-auto text-slate-400 bg-[#03022d] bg-opacity-30 no-select","relative mx-[.5rem] min-h-[2.5em] py-[0.4em] flex flex-row","items-stretch !cursor-grabber whitespace-normal text-sm overflow-hidden","shadow rounded border border-0.5",n.isDragging?"shadow-slate-700 shadow-sm border-solid":"",n.isDragging||1!==n.rank?"":"first-card-glow",n.rank?"border-solid border-slate-400":"border-dashed"),style:{position:"relative"},children:[M&&S&&e.jsx("div",{className:"absolute top-0 right-0 h-full w-[30%] pointer-events-none overflow-hidden",children:e.jsx("div",{className:"relative w-full h-full",children:e.jsx("img",{src:M,className:"w-full h-full object-cover opacity-40",style:{display:"block",WebkitMaskImage:"linear-gradient(to right, transparent 0%, black 30%)",maskImage:"linear-gradient(to right, transparent 0%, black 30%)",objectPosition:"50% 50%",scale:"1.1"},onError:e=>{e.target.parentElement.parentElement.style.display="none"},onLoad:e=>{const t=e.target;120!==t.naturalWidth&&320!==t.naturalWidth||(t.parentElement.parentElement.style.display="none")},alt:""})})}),e.jsxs("div",{className:"relative z-10 flex flex-row items-stretch w-full",children:[e.jsx("div",{className:"-my-2 flex-shrink-0 pb-[1px] mr-3 font-bold w-8 pr-[0.01em] border-r-[0.05em] border-slate-500 bg-[#334678] bg-opacity-80 text-slate-300 tracking-tighter items-center justify-center flex text-lg rounded-sm",children:n.rank}),e.jsx("div",{className:"relative w-14 min-w-14 mr-3 flex items-center",children:e.jsxs("div",{className:"relative w-full",children:["yu"!==P.key?e.jsx(Y,{code:P.key,className:"w-full opacity-80"}):e.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/6/61/Flag_of_Yugoslavia_%281946-1992%29.svg",alt:"Flag of Yugoslavia",className:"w-full h-auto opacity-80"}),x&&$&&e.jsx("div",{className:"bottom-0 left-0 right-0 bg-slate-600 bg-opacity-30 text-slate-300 text-sm font-bold text-center py-1",children:$.year})]})}),e.jsxs("div",{className:h("flex-grow text-slate-300 font-bold"),children:[e.jsxs("div",{className:"overflow-hidden overflow-ellipsis",children:[e.jsxs("span",{className:h("float-right flex flex-row items-center",(null==$?void 0:$.youtube)?"bg-opacity-80 bg-[#1c214c] border-[0.1em] border-gray-600 rounded-[0.2em] px-[0.5em] py-[0.1em] mr-[0.4em]":""),children:[(null==$?void 0:$.youtube)&&e.jsx("div",{onClick:()=>{n.openSongModal()},className:"cursor-pointer rounded text-slate-500 hover:text-slate-300 mr-[0.9em] -ml-1",children:e.jsx(g,{className:"text-base",title:"lyrics"})}),(null==$?void 0:$.youtube)&&e.jsx("a",{href:null==$?void 0:$.youtube,target:"_blank",rel:"noopener noreferrer",className:"rounded text-slate-500 hover:text-slate-300",children:e.jsx(v,{className:"text-xl -m-[0.1em] my-[0.1em]",title:"youtube"})})]}),e.jsx("span",{className:"overflow-hidden overflow-ellipsis",children:null==P?void 0:P.name})]}),e.jsx("div",{className:"pr-[1.5em] flex flex-grow items-center justify-between font-normal",children:e.jsx("div",{className:"",children:$?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"font-xs text-sm text-slate-400",children:null==$?void 0:$.artist}),e.jsx("span",{className:h("ml-2 font-xs text-xs text-slate-400 rounded-sm bg-[#1c214c] bg-opacity-60"),children:(null==(a=$.song)?void 0:a.length)&&!(null==(s=$.song)?void 0:s.includes("TBD"))?`"${$.song}"`:`${$.song}`}),e.jsxs("div",{className:"mt-1 font-xs text-xs text-gray-400 mb-1 flex flex-wrap",children:[void 0!==(null==(o=null==$?void 0:$.votes)?void 0:o.totalPoints)&&t(R,"t")&&e.jsxs("div",{className:"flex items-center mr-2",children:[e.jsx("span",{className:"text-gray-500",children:"total: "}),e.jsx("span",{children:`${null==(l=null==$?void 0:$.votes)?void 0:l.totalPoints}`})]}),void 0!==(null==(r=null==$?void 0:$.votes)?void 0:r.telePoints)&&t(R,"tv")&&e.jsxs("div",{className:"flex items-center mr-2",children:[e.jsx("span",{className:"text-gray-500",children:"tele: "}),e.jsx("span",{children:`${null==(i=null==$?void 0:$.votes)?void 0:i.telePoints}`})]}),void 0!==(null==(c=null==$?void 0:$.votes)?void 0:c.juryPoints)&&t(R,"j")&&e.jsxs("div",{className:"flex items-center mr-2",children:[e.jsx("span",{className:"text-gray-500",children:"jury: "}),e.jsx("span",{children:`${null==(d=null==$?void 0:$.votes)?void 0:d.juryPoints}`})]})]}),(null==$?void 0:$.finalsRank)&&T&&e.jsxs("div",{className:"mt-1 font-xs text-xs text-gray-400 mb-0 flex flex-wrap items-center mr-2",children:[e.jsx("span",{className:"text-gray-500",children:"place: "}),e.jsx("span",{children:`${null==$?void 0:$.finalsRank}`})]})]}):e.jsx("span",{className:"font-xs text-xs text-gray-500 strong",children:"Did not participate"})})})]}),!N&&e.jsx("div",{id:"right-edge",className:"mb-[0em] absolute bottom-0 right-0 flex-shrink-0 flex flex-row justify-between text-xl font-bold text-slate-500 z-10",children:e.jsx("div",{id:"gripper",className:"text-right pl-[0.3em] mr-[0.3em]",children:"⋮⋮"})})]})]},n.rank?"ranked-":`unranked-card-${(null==$?void 0:$.id)??P.id}`),(null==m?void 0:m.length)>0&&(N||E)&&e.jsx("div",{ref:L,className:"mt-0 mx-[0.6em] shadow-lg rounded-b-md bg-[#1c214c] bg-opacity-100 border-gray-600 border-x-[0.01em] border-b-[0.01em] overflow-x-auto relative ml-[2em]",onScroll:n.onCategoryScroll,children:e.jsx("div",{className:"flex",children:m.map(((t,a)=>{if(!N&&a===f)return null;const s=null==O?void 0:O[t.name],{arrowIcon:o,rankDifference:l}=function(e,t){const n=e&&t?t-e:0;let a=null;return n<0?a=Math.abs(n)>=3?w:k:n>0&&(a=n>=3?j:C),{arrowIcon:a,rankDifference:n}}(n.rank,s);return e.jsxs("div",{className:"px-2 py-1 text-xs flex-shrink-0 text-slate-400 h-[2em] flex",title:`weight: ${t.weight}`,children:[e.jsxs("span",{className:"",children:[t.name,":"]})," ",e.jsx("span",{className:"ml-1 font-medium text-slate-300",children:s||"--"}),o&&e.jsx(b,{icon:o,className:h("pt-[0.2em] ml-1 inline-block text-sm text-opacity-40",l<0?"text-green-500":"text-red-500")})]},a)}))})})]})};function ae(e,t){if(null==e)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.includes(a))continue;n[a]=e[a]}return n}function se(e,t){return(se=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function oe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,se(e,t)}function le(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}const re=!1,ie=m.createContext(null);var ce=function(e){return e.scrollTop},de="unmounted",ue="exited",me="entering",fe="entered",xe="exiting",pe=function(e){function t(t,n){var a;a=e.call(this,t,n)||this;var s,o=n&&!n.isMounting?t.enter:t.appear;return a.appearStatus=null,t.in?o?(s=ue,a.appearStatus=me):s=fe:s=t.unmountOnExit||t.mountOnEnter?de:ue,a.state={status:s},a.nextCallback=null,a}oe(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===de?{status:ue}:null};var n=t.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==me&&n!==fe&&(t=me):n!==me&&n!==fe||(t=xe)}this.updateStatus(!1,t)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var e,t,n,a=this.props.timeout;return e=t=n=a,null!=a&&"number"!=typeof a&&(e=a.exit,t=a.enter,n=void 0!==a.appear?a.appear:t),{exit:e,enter:t,appear:n}},n.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===me){if(this.props.unmountOnExit||this.props.mountOnEnter){var n=this.props.nodeRef?this.props.nodeRef.current:N.findDOMNode(this);n&&ce(n)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===ue&&this.setState({status:de})},n.performEnter=function(e){var t=this,n=this.props.enter,a=this.context?this.context.isMounting:e,s=this.props.nodeRef?[a]:[N.findDOMNode(this),a],o=s[0],l=s[1],r=this.getTimeouts(),i=a?r.appear:r.enter;!e&&!n||re?this.safeSetState({status:fe},(function(){t.props.onEntered(o)})):(this.props.onEnter(o,l),this.safeSetState({status:me},(function(){t.props.onEntering(o,l),t.onTransitionEnd(i,(function(){t.safeSetState({status:fe},(function(){t.props.onEntered(o,l)}))}))})))},n.performExit=function(){var e=this,t=this.props.exit,n=this.getTimeouts(),a=this.props.nodeRef?void 0:N.findDOMNode(this);t&&!re?(this.props.onExit(a),this.safeSetState({status:xe},(function(){e.props.onExiting(a),e.onTransitionEnd(n.exit,(function(){e.safeSetState({status:ue},(function(){e.props.onExited(a)}))}))}))):this.safeSetState({status:ue},(function(){e.props.onExited(a)}))},n.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},n.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(a){n&&(n=!1,t.nextCallback=null,e(a))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},n.onTransitionEnd=function(e,t){this.setNextCallback(t);var n=this.props.nodeRef?this.props.nodeRef.current:N.findDOMNode(this),a=null==e&&!this.props.addEndListener;if(n&&!a){if(this.props.addEndListener){var s=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],o=s[0],l=s[1];this.props.addEndListener(o,l)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},n.render=function(){var e=this.state.status;if(e===de)return null;var t=this.props,n=t.children;t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef;var a=ae(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return m.createElement(ie.Provider,{value:null},"function"==typeof n?n(e,a):m.cloneElement(m.Children.only(n),a))},t}(m.Component);function he(){}pe.contextType=ie,pe.propTypes={},pe.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:he,onEntering:he,onEntered:he,onExit:he,onExiting:he,onExited:he},pe.UNMOUNTED=de,pe.EXITED=ue,pe.ENTERING=me,pe.ENTERED=fe,pe.EXITING=xe;var ge=function(e,t){return e&&t&&t.split(" ").forEach((function(t){return a=t,void((n=e).classList?n.classList.remove(a):"string"==typeof n.className?n.className=le(n.className,a):n.setAttribute("class",le(n.className&&n.className.baseVal||"",a)));var n,a}))},ve=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return(t=e.call.apply(e,[this].concat(a))||this).appliedClasses={appear:{},enter:{},exit:{}},t.onEnter=function(e,n){var a=t.resolveArguments(e,n),s=a[0],o=a[1];t.removeClasses(s,"exit"),t.addClass(s,o?"appear":"enter","base"),t.props.onEnter&&t.props.onEnter(e,n)},t.onEntering=function(e,n){var a=t.resolveArguments(e,n),s=a[0],o=a[1]?"appear":"enter";t.addClass(s,o,"active"),t.props.onEntering&&t.props.onEntering(e,n)},t.onEntered=function(e,n){var a=t.resolveArguments(e,n),s=a[0],o=a[1]?"appear":"enter";t.removeClasses(s,o),t.addClass(s,o,"done"),t.props.onEntered&&t.props.onEntered(e,n)},t.onExit=function(e){var n=t.resolveArguments(e)[0];t.removeClasses(n,"appear"),t.removeClasses(n,"enter"),t.addClass(n,"exit","base"),t.props.onExit&&t.props.onExit(e)},t.onExiting=function(e){var n=t.resolveArguments(e)[0];t.addClass(n,"exit","active"),t.props.onExiting&&t.props.onExiting(e)},t.onExited=function(e){var n=t.resolveArguments(e)[0];t.removeClasses(n,"exit"),t.addClass(n,"exit","done"),t.props.onExited&&t.props.onExited(e)},t.resolveArguments=function(e,n){return t.props.nodeRef?[t.props.nodeRef.current,e]:[e,n]},t.getClassNames=function(e){var n=t.props.classNames,a="string"==typeof n,s=a?""+(a&&n?n+"-":"")+e:n[e];return{baseClassName:s,activeClassName:a?s+"-active":n[e+"Active"],doneClassName:a?s+"-done":n[e+"Done"]}},t}oe(t,e);var n=t.prototype;return n.addClass=function(e,t,n){var a=this.getClassNames(t)[n+"ClassName"],s=this.getClassNames("enter").doneClassName;"appear"===t&&"done"===n&&s&&(a+=" "+s),"active"===n&&e&&ce(e),a&&(this.appliedClasses[t][n]=a,function(e,t){e&&t&&t.split(" ").forEach((function(t){return a=t,void((n=e).classList?n.classList.add(a):function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")}(n,a)||("string"==typeof n.className?n.className=n.className+" "+a:n.setAttribute("class",(n.className&&n.className.baseVal||"")+" "+a)));var n,a}))}(e,a))},n.removeClasses=function(e,t){var n=this.appliedClasses[t],a=n.base,s=n.active,o=n.done;this.appliedClasses[t]={},a&&ge(e,a),s&&ge(e,s),o&&ge(e,o)},n.render=function(){var e=this.props;e.classNames;var t=ae(e,["classNames"]);return m.createElement(pe,E({},t,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},t}(m.Component);ve.defaultProps={classNames:""},ve.propTypes={};const be=({icon:t,text:n,className:a,url:s,onClick:o,afterClick:l})=>e.jsxs("li",{role:"menuitem",className:h("text-slate-300 bg-slate-600 hover:bg-slate-700 flex w-full cursor-pointer select-none items-center gap-2 px-3 pt-[9px] pb-2 text-start transition-all hover:bg-blue-gray-50 hover:text-blue-gray-900 focus:bg-blue-gray-50 focus:bg-opacity-80 focus:text-blue-gray-900 active:bg-blue-gray-50 active:bg-opacity-80 active:text-blue-gray-900 bg-opacity-95 hover:bg-opacity-100",a),onClick:void 0!==s?()=>{return e=s,void window.open(e,"_blank","noopener,noreferrer");var e}:()=>{null==o||o(),null==l||l()},children:[e.jsx("div",{className:"w-[1.2em] text-center",children:t&&e.jsx(b,{icon:t})}),e.jsx("p",{className:"text-sm font-medium",children:n})]}),ye=({buttonIcon:t,text:n,children:a})=>{const[s,o]=u.useState(!1),[l,r]=u.useState({opacity:0,visibility:"hidden",transition:"opacity 200ms ease, visibility 200ms ease"}),i=u.useRef(null);u.useEffect((()=>{if(i.current){const e=i.current.getBoundingClientRect(),t={top:`${e.top+window.scrollY}px`,left:e.left+window.scrollX-180+"px",opacity:s?1:0,visibility:s?"visible":"hidden",transition:"opacity 200ms ease, visibility 200ms ease"};r(t)}}),[s]);return e.jsxs("li",{ref:i,className:h("relative bg-slate-600 hover:bg-slate-700 flex w-full cursor-pointer select-none items-center justify-between gap-2 px-3 pt-[9px] pb-2 text-start transition-all bg-opacity-95 hover:bg-opacity-100",{"!bg-slate-700":s}),onClick:()=>{o(!s)},children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-[1.2em] text-center",children:t&&e.jsx(b,{icon:t})}),e.jsx("p",{className:h("text-sm font-medium mx-2"),children:n})]}),e.jsx(b,{icon:S,className:"transition-transform "+(s?"rotate-90":"")}),T.createPortal(e.jsx("ul",{style:l,className:"absolute shadow-lg shadow-blue-gray-500/10 rounded-sm border border-slate-500 overflow-auto flex flex-col min-w-[180px] z-20 ",children:a}),document.body)]})},we={voteCode:"",showPlace:!1,baseItemHeight:90,itemMargin:8,canvasWidth:500,padding:10,headerHeight:40,footerMargin:10,maxSongWidth:300,flagSize:60,rankWidth:45,cardCornerRadius:4,fontFamily:"Arial",pixelRatio:3,fontSizes:{title:28,rankNumber:28,countryName:16,artist:16,song:16,stats:12}},ke={background:"#13172b",headerGradient:["#517cbc","#1a2a45","#9e33ea"],cardBackground:"rgba(40, 49, 91, 0.7)",cardBorder:"#94a3b8",rankBackground:"#334678",titleText:"#cbd5e1",rankText:"#cbd5e1",countryText:"#cbd5e1",artistText:"#94a3b8",songText:"#94a3b8",songBackground:"rgba(28, 33, 76, 0)",statLabelText:"#6b7280",statValueText:"#9ca3af",footerText:"#93c5fd",firstPlaceGlow:"rgba(100, 10, 10, 0.9)",firstPlaceGlowOpacity:.1,shadow:"rgba(0, 0, 0, 0.3)"},je=(e,t,n)=>new Promise(((a,s)=>{fetch(e,{mode:"cors",headers:{Origin:window.location.origin}}).then((e=>{if(!e.ok)throw new Error(`Failed to load SVG: ${e.status} ${e.statusText}`);return e.text()})).then((o=>{const l=new Blob([o],{type:"image/svg+xml"}),r=URL.createObjectURL(l),i=new Image(t,n);i.onload=()=>{URL.revokeObjectURL(r),a(i)},i.onerror=()=>{URL.revokeObjectURL(r),s(new Error(`Failed to load SVG from ${e}`))},i.src=r})).catch(s)})),Ce=(e,t="normal")=>new Promise((n=>{document.fonts.ready.then((()=>{if(document.fonts.check(`${t} 16px ${e}`))n(!0);else try{const a=new FontFace(e,`local(${e})`,{weight:t});a.load().then((()=>{document.fonts.add(a),n(!0)})).catch((()=>{n(!1)}))}catch(a){n(!1)}}))})),Ne=(e,t,n,a,s,o=4)=>{a<2*o&&(o=a/2),s<2*o&&(o=s/2),e.beginPath(),e.moveTo(t+o,n),e.arcTo(t+a,n,t+a,n+s,o),e.arcTo(t+a,n+s,t,n+s,o),e.arcTo(t,n+s,t,n,o),e.arcTo(t,n,t+a,n,o),e.closePath(),e.fill()},Ee=(e,t,n,a,s,o)=>{e.fillStyle=(e=>{const t={al:"#dc3545",am:"#dc3545",au:"#28a745",at:"#dc3545",az:"#17a2b8",be:"#000000",hr:"#dc3545",cy:"#ffc107",cz:"#fd7e14",dk:"#343a40",ee:"#6f42c1",fi:"#28a745",fr:"#0d6efd",ge:"#dc3545",de:"#6c757d",gr:"#28a745",is:"#fd7e14",ie:"#28a745",il:"#28a745",it:"#28a745",lv:"#6f42c1",lt:"#ffc107",lu:"#dc3545",mt:"#28a745",me:"#6c757d",nl:"#fd7e14",no:"#dc3545",pl:"#6c757d",pt:"#28a745",sm:"#28a745",rs:"#dc3545",si:"#28a745",es:"#6f42c1",se:"#28a745",ch:"#6f42c1",ua:"#28a745",gb:"#28a745",uk:"#28a745"};if(t[e.toLowerCase()])return t[e.toLowerCase()];let n=0;for(let s=0;s<e.length;s++)n=e.charCodeAt(s)+((n<<5)-n);let a="#";for(let s=0;s<3;s++){const e=n>>8*s&255;a+=("00"+Math.min(Math.max(e,60),200).toString(16)).substr(-2)}return a})(t),e.fillRect(n,a,s,o),e.fillStyle="#ffffff",e.font="bold 16px Arial",e.textAlign="center",e.textBaseline="middle",e.fillText(t.toUpperCase(),n+s/2,a+o/2)},Se=(e,t,n,a,s,o,l,r)=>{e.fillStyle=l.background,((e,t,n,a,s,o=0,l="rgba(0, 0, 0, 0.3)")=>{e.save(),e.shadowColor=l,e.shadowBlur=4,e.shadowOffsetX=0,e.shadowOffsetY=2,o>0?Ne(e,t,n,a,s,o):e.fillRect(t,n,a,s),e.restore()})(e,t,n,a,s,r.cardCornerRadius,l.shadow),e.fillStyle=l.cardBackground,Ne(e,t,n,a,s,r.cardCornerRadius),e.strokeStyle=l.cardBorder,e.lineWidth=1,e.beginPath(),e.moveTo(t+r.cardCornerRadius,n),e.arcTo(t+a,n,t+a,n+s,r.cardCornerRadius),e.arcTo(t+a,n+s,t,n+s,r.cardCornerRadius),e.arcTo(t,n+s,t,n,r.cardCornerRadius),e.arcTo(t,n,t+a,n,r.cardCornerRadius),e.stroke()},Te=(e,a,s,o,l,r,i,c)=>{var d,u,m;const{country:f,contestant:x}=a,p=c.canvasWidth-2*c.padding,h=c.padding,g=l,v=g+r/2;Se(e,h,g,p,r,0,i,c),((e,t,n,a,s,o,l,r)=>{e.fillStyle=l.rankBackground,e.beginPath(),e.moveTo(n,a+r.cardCornerRadius),e.arcTo(n,a,n+r.cardCornerRadius,a,r.cardCornerRadius),e.lineTo(n+s,a),e.lineTo(n+s,a+o),e.lineTo(n+r.cardCornerRadius,a+o),e.arcTo(n,a+o,n,a+o-r.cardCornerRadius,r.cardCornerRadius),e.lineTo(n,a+r.cardCornerRadius),e.fill(),e.fillStyle=l.rankText,e.font=`bold ${r.fontSizes.rankNumber}px ${r.fontFamily}`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.toString(),n+s/2,a+o/2),e.strokeStyle=l.cardBorder,e.lineWidth=1,e.beginPath(),e.moveTo(n+s,a),e.lineTo(n+s,a+o),e.stroke()})(e,o,h,g,c.rankWidth,r,i,c);const b=h+c.rankWidth+15,y=v-.75*c.flagSize/2;((e,t,n,a,s,o,l)=>{if(t)try{e.globalAlpha=.8,e.drawImage(t,a,s,o,.75*o),e.globalAlpha=1}catch(r){Ee(e,n,a,s,o,.75*o)}else Ee(e,n,a,s,o,.75*o)})(e,s,f.key,b,y,c.flagSize);const w=b+c.flagSize+15;if(x){let a=1;if(x.song){e.font=`${c.fontSizes.song}px ${c.fontFamily}`;const t=`"${x.song}"`,n=x.artist;e.font=`${c.fontSizes.artist}px ${c.fontFamily}`;const s=p-(w+e.measureText(n).width+10-h)-40;if(e.measureText(t).width>s){const n=t.split(" ");let o=n[0],l=s;for(let t=1;t<n.length;t++){const s=o+" "+n[t];e.measureText(s).width<=l?o=s:(a++,o=n[t],l=c.maxSongWidth)}}}const s=x.votes&&n(c.voteCode),o=x.finalsRank&&c.showPlace,l=s||o,v=24;let b=g+(r-((2+(a>1?a-1:0)+(l?1:0))*v+(l?10:0)))/2+(n(c.voteCode)&&x.votes?10:5);e.fillStyle=i.countryText,e.font=`bold ${c.fontSizes.countryName}px ${c.fontFamily}`,e.textAlign="left",e.textBaseline="top",e.fillText(f.name,w,b),b+=v,e.fillStyle=i.artistText,e.font=`${c.fontSizes.artist}px ${c.fontFamily}`;const y=x.artist;if(e.fillText(y,w,b),x.song){e.font=`${c.fontSizes.song}px ${c.fontFamily}`;const t=`"${x.song}"`,n=w+e.measureText(y).width+10;if(e.measureText(t).width<=p-(n-h)-40){const a=e.measureText(t).width+8,s=c.fontSizes.song+2;e.fillStyle=i.songBackground,Ne(e,n-4,b-1,a,s,3),e.fillStyle=i.songText,e.fillText(t,n,b),b+=s}else{const a=t.split(" ");let s=[],o=a[0],l=n,r=p-(n-h)-40;for(let t=1;t<a.length;t++){const n=a[t],i=o+" "+n;e.measureText(i).width<=r?o=i:(s.push({text:o,x:l}),o=n,l=w,r=c.maxSongWidth)}s.push({text:o,x:l});const d=s.shift();if(d){const t=e.measureText(d.text).width+8,n=c.fontSizes.song+2;e.fillStyle=i.songBackground,Ne(e,d.x-4,b-1,t,n,3),e.fillStyle=i.songText,e.fillText(d.text,d.x,b)}b+=v,s.forEach((t=>{const n=e.measureText(t.text).width+8,a=c.fontSizes.song+2;e.fillStyle=i.songBackground,Ne(e,t.x-4,b-1,n,a,3),e.fillStyle=i.songText,e.fillText(t.text,t.x,b),b+=a}))}}else b+=v;if(s||o){let n=w;const a=80;if(b+=10,void 0!==(null==(d=x.votes)?void 0:d.totalPoints)&&t(c.voteCode,"t")&&(e.fillStyle=i.statLabelText,e.font=`${c.fontSizes.stats}px ${c.fontFamily}`,e.fillText("total:",n,b),e.fillStyle=i.statValueText,e.fillText(`${x.votes.totalPoints}`,n+35,b),n+=a),void 0!==(null==(u=x.votes)?void 0:u.telePoints)&&t(c.voteCode,"tv")&&(e.fillStyle=i.statLabelText,e.fillText("tele:",n,b),e.fillStyle=i.statValueText,e.fillText(`${x.votes.telePoints}`,n+35,b),n+=a),void 0!==(null==(m=x.votes)?void 0:m.juryPoints)&&t(c.voteCode,"j")&&(e.fillStyle=i.statLabelText,e.fillText("jury:",n,b),e.fillStyle=i.statValueText,e.fillText(`${x.votes.juryPoints}`,n+35,b)),x.finalsRank&&c.showPlace){const t=c.canvasWidth-80;e.fillStyle=i.statLabelText,e.font=`${c.fontSizes.stats}px ${c.fontFamily}`,e.fillText("place:",t,b),e.fillStyle=i.statValueText,e.fillText(`${x.finalsRank}`,t+40,b)}}}else e.fillStyle=i.countryText,e.font=`bold ${c.fontSizes.countryName}px ${c.fontFamily}`,e.textAlign="left",e.textBaseline="middle",e.fillText(f.name,w,g+r/2)},Re=async(e,t="My Eurovision Ranking",a={},s={})=>{const o={...we,...a},l={...ke,...s},r=document.createElement("canvas"),i=r.getContext("2d");if(!i)throw new Error("Canvas 2D context not supported");await Ce(o.fontFamily,"normal"),await Ce(o.fontFamily,"bold");const{heights:c,totalHeight:d}=((e,t,a)=>{var s;const o=[];let l=0;for(const r of t){let t=a.baseItemHeight;if(null==(s=r.contestant)?void 0:s.song){e.font=`${a.fontSizes.song}px ${a.fontFamily}`;const s=`"${r.contestant.song}"`,o=r.contestant.artist;e.font=`${a.fontSizes.artist}px ${a.fontFamily}`;const l=e.measureText(o).width,i=a.padding+a.rankWidth+a.flagSize+15+l+15,c=a.canvasWidth-a.padding-i-40;let d=1;if(e.measureText(s).width>c){const n=s.split(" ");let o=n[0],l=c;for(let t=1;t<n.length;t++){const s=o+" "+n[t];e.measureText(s).width<=l?o=s:(d++,o=n[t],l=a.maxSongWidth)}t+=24*(d-1)}const u=r.contestant.votes&&n(a.voteCode),m=r.contestant.finalsRank&&a.showPlace,f=24*(d-1+2+(u||m?1:0))+(u||m?10:0);t=Math.max(t,f+30)}o.push(t),l+=t+a.itemMargin}return{heights:o,totalHeight:l}})(i,e,o),u=o.headerHeight+d+o.footerMargin+30,m=o.canvasWidth*o.pixelRatio,f=u*o.pixelRatio;r.width=m,r.height=f,r.style.width=`${o.canvasWidth}px`,r.style.height=`${u}px`,i.scale(o.pixelRatio,o.pixelRatio),i.fillStyle=l.background,i.fillRect(0,0,o.canvasWidth,u),((e,t,n,a,s,o)=>{const l=e.createLinearGradient(0,0,n,a);s.headerGradient.forEach(((e,t)=>{l.addColorStop(t/(s.headerGradient.length-1),e)})),e.fillStyle=l,e.fillRect(0,0,n,a),e.fillStyle=s.titleText,e.font=`bold ${o.fontSizes.title}px ${o.fontFamily}`,e.textAlign="center",e.textBaseline="middle",e.fillText(t,n/2,a/1.8)})(i,t,o.canvasWidth,o.headerHeight,l,o);const x=e.map((e=>e.country.key)),p={};await Promise.all(x.map((async e=>{try{const t=o.flagSize*Math.min(2,o.pixelRatio);p[e]=await(async(e,t,n)=>{try{const s=[`https://flagcdn.com/w320/${e.toLowerCase()}.png`,`https://flagsapi.com/${e.toUpperCase()}/flat/64.png`];for(const e of s)try{if(e.endsWith(".svg"))return await je(e,t,n);{const a=new Image(t,n);return await new Promise(((t,n)=>{a.onload=()=>t(),a.onerror=n,a.crossOrigin="anonymous",a.src=e})),a}}catch(a){}throw new Error(`Could not load flag for ${e} from any source`)}catch(a){return null}})(e,t,.75*t)}catch(t){p[e]=null}})));let h=o.headerHeight+o.itemMargin;for(let n=0;n<e.length;n++){const t=e[n],a=n+1,s=c[n],r=p[t.country.key];Te(i,t,r,a,h,s,l,o),h+=s+o.itemMargin}return((e,t,n,a,s,o)=>{const l=e.createLinearGradient(0,0,n,0);o.headerGradient.forEach(((e,t)=>{l.addColorStop(t/(o.headerGradient.length-1),e)})),e.fillStyle=l,e.fillRect(0,s,n,a),e.fillStyle=o.footerText,e.font="14px Arial",e.textAlign="center",e.textBaseline="middle",e.fillText(t,n/2,s+a/2)})(i,"created with eurovision-ranker.com",o.canvasWidth,30,u-30,l),r},$e=({className:t="",showText:n=!0,afterClick:a=(()=>{})})=>{const[s,o]=u.useState(!1),l=p((e=>e.name)),r=p((e=>e.rankedItems)),i=p((e=>e.showPlace)),c=p((e=>e.vote));let d={};d.showPlace=i,d.voteCode=c;return e.jsx(be,{icon:$,text:"Download image",onClick:async()=>{if(0!==r.length){o(!0);try{await(async(e,t="",n={},a={})=>{if(0!==e.length){n.pixelRatio||(n.pixelRatio=2);try{const s=await Re(e,t,n,a),o=`eurovision-${t?t.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""):"eurovision-ranking"}.png`,l=await new Promise(((e,t)=>{s.toBlob((n=>{n?e(n):t(new Error("Failed to create image blob"))}),"image/png",1)})),r=URL.createObjectURL(l),i=document.createElement("a");i.href=r,i.download=o,i.click(),URL.revokeObjectURL(r),R.success("Ranking image downloaded successfully")}catch(s){R.error("Failed to create ranking image")}}else R.error("Please rank some countries first")})(r,l,d)}catch(e){R.error("Failed to create image")}finally{setTimeout((()=>{o(!1)}),1e3)}}else R.error("Please rank some countries first")},afterClick:a})},Pe=t=>{const[n,s]=u.useState(!1),o=u.useRef(null),l=p((e=>e.rankedItems)),r=p((e=>e.headerMenuOpen)),i=P(),c=u.useRef(null),d=e=>{var t;const n=e.target,a=(e=>{for(;e;){if(e.id&&e.id.startsWith("react-joyride"))return!0;e=e.parentElement}return!1})(n);(null==(t=o.current)?void 0:t.contains(n))||a||s(!1)};function m(){s(!1)}return u.useEffect((()=>(document.addEventListener("mousedown",d),()=>{document.removeEventListener("mousedown",d),clearTimeout(undefined),document.body.classList.remove("no-scroll")})),[]),u.useEffect((()=>{r?(s(!0),document.body.classList.add("no-scroll"),i(a(!1))):setTimeout((()=>{document.body.classList.remove("no-scroll")}),300)}),[r]),e.jsxs("div",{className:"relative inline-block",ref:o,children:[e.jsx("button",{className:h("tour-step-6 w-6 h-6 bg-[#6e6795] hover:bg-slate-400 rounded-full flex justify-center items-center cursor-pointer",{"!bg-slate-400":n}),onClick:()=>{const e=n;s(!n),e?setTimeout((()=>{document.body.classList.remove("no-scroll")}),300):document.body.classList.add("no-scroll")},children:e.jsx(b,{className:"text-slate-300",icon:L})}),e.jsx(ve,{in:n,timeout:200,classNames:"menu",nodeRef:c,unmountOnExit:!0,children:e.jsxs("ul",{role:"menu",className:"absolute z-20 min-w-[180px] right-0 mt-1 shadow-lg shadow-blue-gray-500/10 rounded-sm border border-slate-500 overflow-auto flex flex-col",children:[e.jsx(be,{icon:M,text:"View Heat Map",className:"tour-step-8",onClick:t.onMapClick,afterClick:m}),Z(l)&&e.jsx(be,{icon:O,text:"YouTube Playlist",className:"tour-step-7",onClick:()=>{var e;return window.open(null==(e=t.generateYoutubePlaylistUrl)?void 0:e.call(t),"_blank")},afterClick:m}),e.jsx(be,{icon:z,text:"Edit Name",onClick:()=>t.openNameModal(),afterClick:m}),e.jsx(be,{icon:D,text:"Categories",className:"tour-step-9",onClick:()=>t.openConfig("categories"),afterClick:m}),e.jsx(be,{icon:F,text:"Rankings",onClick:()=>t.openConfig("rankings"),afterClick:m}),e.jsx(be,{icon:A,text:"Display settings",onClick:()=>t.openConfig("display"),afterClick:m}),l.length>0&&e.jsx($e,{className:"text-blue-300 hover:text-white mr-2",iconClassName:"text-lg",afterClick:m}),e.jsxs(ye,{text:"Copy",buttonIcon:U,children:[e.jsx(be,{text:"URL",icon:I,onClick:q}),e.jsx(be,{text:"Text",icon:W,onClick:()=>J(l,K.TEXT)}),e.jsx(be,{text:"CSV",icon:B,onClick:()=>J(l,K.CSV)}),e.jsx(be,{text:"JSON",icon:B,onClick:()=>J(l,K.JSON)})]})]})})]})},Le=({setMapModalShow:t,generateYoutubePlaylistUrl:n,openNameModal:a,openConfig:r,supportedYears:i,className:c,downloadButton:d})=>{const m=P(),f=p((e=>e.year)),x=p((e=>e.name)),g=p((e=>e.globalSearch)),v=p((e=>e.rankedItems)),b=p((e=>e.showTotalRank)),y=p((e=>e.categories)),w=p((e=>e.showUnranked)),k=p((e=>e.activeCategory)),[j,C]=u.useState(0);return u.useEffect((()=>{0!==j?(b&&m(s(!1)),m(o(j-1))):!b&&(null==y?void 0:y.length)&&m(s(!0))}),[j]),u.useEffect((()=>{C(void 0!==k?k+1:0)}),[k]),e.jsxs("div",{className:h("z-40 rounded-t-md round-b-sm w-full text-center font-bold bg-blue-900 gradient-background text-slate-300 py-1 text-md tracking-tighter shadow-md ranked-bar-background",c),children:[w?e.jsx("div",{className:"w-full m-auto flex items-center justify-center",children:e.jsx(X,{className:"tour-step-1 min-w-[5em] w-auto",buttonClassName:"!h-[1.8em]",value:f,onChange:e=>{m(l(e))},options:i,showSearch:!0})}):e.jsxs("div",{className:"mr-2 ml-5 flex justify-between items-center",children:[(null==v?void 0:v.length)>0&&e.jsx(e.Fragment,{}),e.jsxs("div",{className:"justify-center w-full ml-2 mr-2",children:[g?null:f,x&&e.jsxs("span",{className:"font-bold text-slate-400 text-md",children:[g?"":" - ",x]})]}),e.jsx(Pe,{openNameModal:a,openConfig:r,onMapClick:t,generateYoutubePlaylistUrl:()=>n(v)})]}),!w&&y.length>0&&e.jsxs("div",{className:"flex bg-gray-800 bg-opacity-40 border-gray-200 mt-1 -mb-[0.2em] overflow-x-auto",children:[e.jsx(Q,{placeholder:e.jsx(e.Fragment,{}),children:e.jsx("button",{className:h("px-4 py-[0.2em] text-sm font-strong flex-shrink-0",0===j?"text-blue-400 border-b-0 border-blue-400":"text-gray-400 hover:text-blue-500"),onClick:()=>C(0),children:"Total"},"total-tab")},"total-ripple"),y.map(((t,n)=>e.jsx(Q,{placeholder:e.jsx(e.Fragment,{}),children:e.jsx("button",{className:h("px-4 py-[0.2em] text-sm font-medium flex-shrink-0",j===n+1?"text-blue-400 border-b-0 border-blue-400":"text-gray-500 hover:text-blue-500"),onClick:()=>C(n+1),children:t.name},`cat-btn-${n+1}`)},`ripple-${n+1}`)))]},"total-tab-container")]})},Me=m.lazy((()=>r((()=>import("./IntroColumn-BZi0ztkN.js")),__vite__mapDeps([0,1,2,3,4,5])))),Oe=t=>{const[n,a]=u.useState(!1);return u.useEffect((()=>{a(!0)}),[]),e.jsx(u.Suspense,{fallback:e.jsx("div",{className:"w-[10em]"}),children:n?e.jsx(Me,{...t}):e.jsx("div",{children:"Loading..."})})},ze=({openSongModal:t,openModal:n,openConfigModal:a,setRunTour:s,openNameModal:o,openMapModal:l})=>{const r=P(),[m,g]=u.useState(0),v=p((e=>e.showUnranked)),b=p((e=>e.theme)),y=p((e=>e.showTotalRank)),w=p((e=>e.isDeleteMode)),k=p((e=>e.rankedItems)),j=p((e=>e.categories)),C=p((e=>e.activeCategory)),[N,E]=u.useState(0),S=e=>{E(e.currentTarget.scrollLeft)};u.useEffect((()=>{0!==m&&i(C,j,k)}),[m]);const T=u.useCallback((e=>{r(_(e)),g(Math.random())}),[r]);return e.jsx("div",{className:"tour-step-5 z-20",children:e.jsx(f,{droppableId:"rankedItems",children:i=>e.jsxs("div",{className:h("grid h-full max-h-full min-h-full grid-rows-[auto_1fr]"),children:[e.jsx(Le,{setMapModalShow:()=>l(),generateYoutubePlaylistUrl:()=>(e=>"https://www.youtube.com/watch_videos?video_ids="+e.map((e=>{var t,n,a;if(!(null==(n=null==(t=null==e?void 0:e.contestant)?void 0:t.youtube)?void 0:n.length))return;let s=new URL(null==(a=null==e?void 0:e.contestant)?void 0:a.youtube);return new URLSearchParams(s.search).get("v")})).filter((e=>null==e?void 0:e.length)).join(","))(k),supportedYears:c,openNameModal:o,openConfig:a,className:v?"min-w-[9em] max-w-50vw-6em":"w-[80vw] max-w-[30.5em] min-w-[20.5em]"}),e.jsx("div",{className:"px-1 overflow-y-auto h-full",children:e.jsxs("ul",{...i.droppableProps,ref:i.innerRef,className:h("overflow-y-auto overflow-x-hidden pt-3 ranked-items-background w-full h-full",v?"min-w-[9em] max-w-50vw-6em":"w-[85vw] max-w-[30em] min-w-[20em]",{"auroral-background":b.includes("ab")}),children:[0===k.length&&v&&e.jsx(Oe,{openModal:n,openConfigModal:a,setRunTour:s}),!v&&0===k.length&&e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("span",{className:"text-center mb-40 min-mt-5 text-slate-500 mx-10 text-sm",children:[e.jsx("div",{children:"Click 'Select' to choose"})," countries to rank",e.jsx("div",{children:e.jsx("img",{src:"/eurovision-heart.svg",alt:"Heart",style:{display:"inline",verticalAlign:"middle"},className:"ml-[0.5em] mt-3 w-5 h-5 opacity-70 grayscale"})})]})}),k.map(((n,a)=>e.jsx(V,{draggableId:(null==n?void 0:n.uid)??n.id,index:a,isDragDisabled:y,children:(s,o)=>e.jsx("li",{ref:s.innerRef,...s.draggableProps,...s.dragHandleProps,className:h("no-select m-2 mx-1",{"mt-0":0===a}),children:v?e.jsx(x,{className:"m-auto text-slate-400 bg-[#03022d] no-select",rank:a+1,countryContestant:n,isDeleteMode:v&&w,deleteCallBack:T,isDragging:o.isDragging},`card-${(null==n?void 0:n.uid)??n.id}`):e.jsx(ne,{rank:a+1,countryContestant:n,openSongModal:()=>t(n),isDragging:o.isDragging,categoryScrollPosition:N,onCategoryScroll:S},`card-${(null==n?void 0:n.uid)??n.id}`)},`li-${(null==n?void 0:n.uid)??n.id}`)},`draggable-${(null==n?void 0:n.uid)??n.id}`))),i.placeholder]})}),v&&(null==k?void 0:k.length)>0&&e.jsxs("div",{className:"pl-2 rounded-b-md h-8 bg-blue-900 ranked-bar-background text-slate-300 items-center flex shadow-md gradient-background",children:[e.jsx(G,{className:h("tour-step-4 ml-auto py-1 pl-[0.7em] pr-[0.9em] mr-0 w-[6em]",{"tada-animation-6s":v&&(null==k?void 0:k.length)}),onClick:()=>r(d(!v)),title:"View List"}),e.jsx(H,{className:h("ml-2 mr-auto text-lg justify-center align-center bounce-right text-blue-300",{"tada-animation":v&&(null==k?void 0:k.length)})})]})]})})})};export{ze as default};
