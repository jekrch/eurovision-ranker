const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/IntroColumn-DY2zIMdX.js","assets/index-CLc5HTt1.js","assets/react-D41Hy763.js","assets/redux-BaDTb7KV.js","assets/index-CER-3SMH.css","assets/App-Bzswl8Rx.js","assets/DisplayTab-DQPZDdT3.js","assets/Dropdown-BGwFHogs.js"])))=>i.map(i=>d[i]);
import{j as e,w as t,x as a,b as n,a as r,y as o,_ as s,n as i,z as l,e as c}from"./index-CLc5HTt1.js";import{r as d,R as u}from"./redux-BaDTb7KV.js";import{S as m,C as x}from"./Card-C2zjaiWB.js";import{u as f,g as p,c as h,L as g,F as v,a as b,b as y,d as w,f as k,e as j,h as C,i as N,R as E,_ as S,j as R,r as T,n as M,k as P,l as $,m as L,o as B,p as O,q as F,s as A,t as D,v as z,w as I,x as U,y as W,z as _,A as H,B as G,C as Y,D as V,H as X,P as J,I as q,E as K}from"./App-Bzswl8Rx.js";import{D as Q}from"./Dropdown-BGwFHogs.js";import{c as Z,a as ee,E as te}from"./ExportUtil-d4dlOniH.js";import{R as ae}from"./index-BpM3ftgM.js";import"./react-D41Hy763.js";const ne=a=>{var n,r,o,s,i,l,c,u;const m=f((e=>e.categories)),x=f((e=>e.activeCategory)),E=f((e=>e.globalSearch)),S=f((e=>e.showTotalRank)),R=f((e=>e.showComparison)),T=f((e=>e.showThumbnail)),M=f((e=>e.showPlace)),P=f((e=>e.vote)),$=a.countryContestant.contestant,L=a.countryContestant.country,B=d.useRef(null),O=p(null==$?void 0:$.youtube);d.useEffect((()=>{B.current&&(B.current.scrollLeft=a.categoryScrollPosition)}),[a.categoryScrollPosition]);const F=function(){if(S||R)return w(m,a.countryContestant)}();return e.jsxs("div",{children:[e.jsxs("div",{className:h(a.className,"m-auto text-[var(--er-text-tertiary)] bg-[var(--er-surface-primary)]x bg-opacity-30 no-select","relative mx-[.5rem] min-h-[2.5em] py-[0.4em] flex flex-row","items-stretch !cursor-grabber whitespace-normal text-sm overflow-hidden","shadow border border-0.5 border-solid border-[var(--er-border-primary)] rounded-l-lg rounded-r-sm",a.isDragging?"shadow-[var(--er-button-primary-hover)] shadow-sm border-solid":"",a.isDragging||1!==a.rank?"":"first-card-glow"),style:{position:"relative"},children:[O&&T&&e.jsx("div",{className:"absolute top-0 right-0 h-full w-[30%] pointer-events-none overflow-hidden",children:e.jsx("div",{className:"relative w-full h-full",children:e.jsx("img",{src:O,className:"w-full h-full object-cover opacity-40",style:{display:"block",WebkitMaskImage:"linear-gradient(to right, transparent 0%, black 30%)",maskImage:"linear-gradient(to right, transparent 0%, black 30%)",objectPosition:"50% 50%",transform:"scale(1.1)"},onError:e=>{e.target.parentElement.parentElement.style.display="none"},onLoad:e=>{const t=e.target;120!==t.naturalWidth&&320!==t.naturalWidth||(t.parentElement.parentElement.style.display="none")},alt:""})})}),e.jsxs("div",{className:"relative z-10 flex flex-row items-stretch w-full",children:[e.jsx("div",{className:"-my-2 flex-shrink-0 pb-[1px] mr-0 font-bold w-8 pr-[0.01em] border-r-[0.05em] border-[var(--er-border-secondary)] bg-[var(--er-surface-accent-70)] bg-opacity-70 text-[var(--er-text-primary)] tracking-tighter items-center justify-center flex text-lg rounded-sm",children:a.rank}),e.jsxs("div",{className:"relative w-[5em] min-w-[4rem] -my-[0.2em]x my-1 ml-[0.2em]x ml-2 -mr-3 self-stretch overflow-hidden",children:["yu"!==L.key?e.jsx(g,{code:L.key,className:"block w-full h-full object-cover opacity-80",style:{WebkitMaskImage:"linear-gradient(to right, rgba(0,0,0,0.9) 50%, transparent 100%)",maskImage:"linear-gradient(to right, rgba(0,0,0,0.9) 50%, transparent 100%)"}}):e.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/6/61/Flag_of_Yugoslavia_%281946-1992%29.svg",alt:"Flag of Yugoslavia",className:"block w-full h-full object-cover opacity-80",style:{WebkitMaskImage:"linear-gradient(to right, black 70%, transparent 100%)",maskImage:"linear-gradient(to right, black 70%, transparent 100%)"}}),E&&$&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-[var(--er-button-neutral-40)] text-[var(--er-text-secondary)] text-sm font-bold text-center py-1 z-10",children:$.year})]}),e.jsxs("div",{className:h("flex-grow text-[var(--er-text-secondary)] font-bold pl-3"),children:[" ",e.jsxs("div",{className:"overflow-hidden overflow-ellipsis",children:[e.jsxs("span",{className:h("float-right flex flex-row items-center",(null==$?void 0:$.youtube)?"bg-opacity-70 bg-[var(--er-surface-tertiary-70)] border-[0.1em] border-[var(--er-border-tertiary)] rounded-[0.2em] px-[0.5em] py-[0.1em] mr-[0.4em]":""),children:[(null==$?void 0:$.youtube)&&e.jsx("div",{onClick:()=>{a.openSongModal()},className:"cursor-pointer rounded text-[var(--er-text-muted)] hover:text-[var(--er-text-secondary)] mr-[1.3em] -ml-1",children:e.jsx(v,{className:"text-base",title:"lyrics"})}),(null==$?void 0:$.youtube)&&e.jsx("a",{href:null==$?void 0:$.youtube,target:"_blank",rel:"noopener noreferrer",className:"rounded text-[var(--er-text-muted)] hover:text-[var(--er-text-secondary)]",children:e.jsx(b,{className:"text-xl -m-[0.1em] my-[0.1em]",title:"youtube"})})]}),e.jsx("span",{className:"overflow-hidden overflow-ellipsis",children:null==L?void 0:L.name})]}),e.jsx("div",{className:"pr-[1.5em] flex flex-grow items-center justify-between font-normal",children:e.jsx("div",{className:"",children:$?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"font-xs text-sm text-[var(--er-text-tertiary)]",children:null==$?void 0:$.artist}),e.jsx("span",{className:h("ml-2 font-xs text-xs text-[var(--er-text-tertiary)] rounded-sm bg-[var(--er-surface-tertiary)] bg-opacity-60"),children:(null==(n=$.song)?void 0:n.length)&&!(null==(r=$.song)?void 0:r.includes("TBD"))?`"${$.song}"`:`${$.song}`}),e.jsxs("div",{className:"mt-1 font-xs text-xs text-[var(--er-text-subtle)] mb-1 flex flex-wrap",children:[void 0!==(null==(o=null==$?void 0:$.votes)?void 0:o.totalPoints)&&t(P,"t")&&e.jsxs("div",{className:"flex items-center mr-2",children:[e.jsx("span",{className:"text-[var(--er-text-muted)]",children:"total: "}),e.jsx("span",{children:`${null==(s=null==$?void 0:$.votes)?void 0:s.totalPoints}`})]}),void 0!==(null==(i=null==$?void 0:$.votes)?void 0:i.telePoints)&&t(P,"tv")&&e.jsxs("div",{className:"flex items-center mr-2",children:[e.jsx("span",{className:"text-[var(--er-text-muted)]",children:"tele: "}),e.jsx("span",{children:`${null==(l=null==$?void 0:$.votes)?void 0:l.telePoints}`})]}),void 0!==(null==(c=null==$?void 0:$.votes)?void 0:c.juryPoints)&&t(P,"j")&&e.jsxs("div",{className:"flex items-center mr-2",children:[e.jsx("span",{className:"text-[var(--er-text-muted)]",children:"jury: "}),e.jsx("span",{children:`${null==(u=null==$?void 0:$.votes)?void 0:u.juryPoints}`})]})]}),(null==$?void 0:$.finalsRank)&&M&&e.jsxs("div",{className:"mt-1 font-xs text-xs text-[var(--er-text-subtle)] mb-0 flex flex-wrap items-center mr-2",children:[e.jsx("span",{className:"text-[var(--er-text-muted)]",children:"place: "}),e.jsx("span",{children:`${null==$?void 0:$.finalsRank}`})]})]}):e.jsx("span",{className:"font-xs text-xs text-[var(--er-text-muted)] font-bold",children:"Did not participate"})})})]}),!S&&e.jsx("div",{id:"right-edge",className:"mb-[0em] absolute bottom-0 right-0 flex-shrink-0 flex flex-row justify-between text-xl font-bold text-[var(--er-text-muted)] z-10",children:e.jsx("div",{id:"gripper",className:"text-right pl-[0.3em] mr-[0.3em]",children:"⋮⋮"})})]})]},a.rank?"ranked-":`unranked-card-${(null==$?void 0:$.id)??L.id}`),(null==m?void 0:m.length)>0&&(S||R)&&e.jsx("div",{ref:B,className:"mt-0 mx-[0.6em] shadow-lg rounded-b-md bg-[var(--er-surface-tertiary)] bg-opacity-100 border-[var(--er-border-medium)] border-x-[0.01em] border-b-[0.01em] overflow-x-auto relative ml-[2em]",onScroll:a.onCategoryScroll,children:e.jsx("div",{className:"flex",children:m.map(((t,n)=>{if(!S&&n===x)return null;const r=null==F?void 0:F[t.name],{arrowIcon:o,rankDifference:s}=function(e,t){const a=e&&t?t-e:0;let n=null;return a<0?n=Math.abs(a)>=3?k:j:a>0&&(n=a>=3?C:N),{arrowIcon:n,rankDifference:a}}(a.rank,r);return e.jsxs("div",{className:"px-2 py-1 text-xs flex-shrink-0 text-[var(--er-text-tertiary)] h-[2em] flex items-center",title:`weight: ${t.weight}`,children:[e.jsxs("span",{className:"",children:[t.name,":"]})," ",e.jsx("span",{className:"ml-1 font-medium text-[var(--er-text-secondary)]",children:r||"--"}),o&&e.jsx(y,{icon:o,className:h("ml-1 inline-block text-sm text-opacity-40",s<0?"text-[var(--r-accent-success)]":"text-[var(--r-accent-error)]")})]},n)}))})})]})};function re(e,t){if(null==e)return{};var a={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;a[n]=e[n]}return a}function oe(e,t){return(oe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function se(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,oe(e,t)}function ie(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}const le=!1,ce=u.createContext(null);var de=function(e){return e.scrollTop},ue="unmounted",me="exited",xe="entering",fe="entered",pe="exiting",he=function(e){function t(t,a){var n;n=e.call(this,t,a)||this;var r,o=a&&!a.isMounting?t.enter:t.appear;return n.appearStatus=null,t.in?o?(r=me,n.appearStatus=xe):r=fe:r=t.unmountOnExit||t.mountOnEnter?ue:me,n.state={status:r},n.nextCallback=null,n}se(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===ue?{status:me}:null};var a=t.prototype;return a.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},a.componentDidUpdate=function(e){var t=null;if(e!==this.props){var a=this.state.status;this.props.in?a!==xe&&a!==fe&&(t=xe):a!==xe&&a!==fe||(t=pe)}this.updateStatus(!1,t)},a.componentWillUnmount=function(){this.cancelNextCallback()},a.getTimeouts=function(){var e,t,a,n=this.props.timeout;return e=t=a=n,null!=n&&"number"!=typeof n&&(e=n.exit,t=n.enter,a=void 0!==n.appear?n.appear:t),{exit:e,enter:t,appear:a}},a.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===xe){if(this.props.unmountOnExit||this.props.mountOnEnter){var a=this.props.nodeRef?this.props.nodeRef.current:E.findDOMNode(this);a&&de(a)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===me&&this.setState({status:ue})},a.performEnter=function(e){var t=this,a=this.props.enter,n=this.context?this.context.isMounting:e,r=this.props.nodeRef?[n]:[E.findDOMNode(this),n],o=r[0],s=r[1],i=this.getTimeouts(),l=n?i.appear:i.enter;!e&&!a||le?this.safeSetState({status:fe},(function(){t.props.onEntered(o)})):(this.props.onEnter(o,s),this.safeSetState({status:xe},(function(){t.props.onEntering(o,s),t.onTransitionEnd(l,(function(){t.safeSetState({status:fe},(function(){t.props.onEntered(o,s)}))}))})))},a.performExit=function(){var e=this,t=this.props.exit,a=this.getTimeouts(),n=this.props.nodeRef?void 0:E.findDOMNode(this);t&&!le?(this.props.onExit(n),this.safeSetState({status:pe},(function(){e.props.onExiting(n),e.onTransitionEnd(a.exit,(function(){e.safeSetState({status:me},(function(){e.props.onExited(n)}))}))}))):this.safeSetState({status:me},(function(){e.props.onExited(n)}))},a.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},a.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},a.setNextCallback=function(e){var t=this,a=!0;return this.nextCallback=function(n){a&&(a=!1,t.nextCallback=null,e(n))},this.nextCallback.cancel=function(){a=!1},this.nextCallback},a.onTransitionEnd=function(e,t){this.setNextCallback(t);var a=this.props.nodeRef?this.props.nodeRef.current:E.findDOMNode(this),n=null==e&&!this.props.addEndListener;if(a&&!n){if(this.props.addEndListener){var r=this.props.nodeRef?[this.nextCallback]:[a,this.nextCallback],o=r[0],s=r[1];this.props.addEndListener(o,s)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},a.render=function(){var e=this.state.status;if(e===ue)return null;var t=this.props,a=t.children;t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef;var n=re(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return u.createElement(ce.Provider,{value:null},"function"==typeof a?a(e,n):u.cloneElement(u.Children.only(a),n))},t}(u.Component);function ge(){}he.contextType=ce,he.propTypes={},he.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:ge,onEntering:ge,onEntered:ge,onExit:ge,onExiting:ge,onExited:ge},he.UNMOUNTED=ue,he.EXITED=me,he.ENTERING=xe,he.ENTERED=fe,he.EXITING=pe;var ve=function(e,t){return e&&t&&t.split(" ").forEach((function(t){return n=t,void((a=e).classList?a.classList.remove(n):"string"==typeof a.className?a.className=ie(a.className,n):a.setAttribute("class",ie(a.className&&a.className.baseVal||"",n)));var a,n}))},be=function(e){function t(){for(var t,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this).appliedClasses={appear:{},enter:{},exit:{}},t.onEnter=function(e,a){var n=t.resolveArguments(e,a),r=n[0],o=n[1];t.removeClasses(r,"exit"),t.addClass(r,o?"appear":"enter","base"),t.props.onEnter&&t.props.onEnter(e,a)},t.onEntering=function(e,a){var n=t.resolveArguments(e,a),r=n[0],o=n[1]?"appear":"enter";t.addClass(r,o,"active"),t.props.onEntering&&t.props.onEntering(e,a)},t.onEntered=function(e,a){var n=t.resolveArguments(e,a),r=n[0],o=n[1]?"appear":"enter";t.removeClasses(r,o),t.addClass(r,o,"done"),t.props.onEntered&&t.props.onEntered(e,a)},t.onExit=function(e){var a=t.resolveArguments(e)[0];t.removeClasses(a,"appear"),t.removeClasses(a,"enter"),t.addClass(a,"exit","base"),t.props.onExit&&t.props.onExit(e)},t.onExiting=function(e){var a=t.resolveArguments(e)[0];t.addClass(a,"exit","active"),t.props.onExiting&&t.props.onExiting(e)},t.onExited=function(e){var a=t.resolveArguments(e)[0];t.removeClasses(a,"exit"),t.addClass(a,"exit","done"),t.props.onExited&&t.props.onExited(e)},t.resolveArguments=function(e,a){return t.props.nodeRef?[t.props.nodeRef.current,e]:[e,a]},t.getClassNames=function(e){var a=t.props.classNames,n="string"==typeof a,r=n?""+(n&&a?a+"-":"")+e:a[e];return{baseClassName:r,activeClassName:n?r+"-active":a[e+"Active"],doneClassName:n?r+"-done":a[e+"Done"]}},t}se(t,e);var a=t.prototype;return a.addClass=function(e,t,a){var n=this.getClassNames(t)[a+"ClassName"],r=this.getClassNames("enter").doneClassName;"appear"===t&&"done"===a&&r&&(n+=" "+r),"active"===a&&e&&de(e),n&&(this.appliedClasses[t][a]=n,function(e,t){e&&t&&t.split(" ").forEach((function(t){return n=t,void((a=e).classList?a.classList.add(n):function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")}(a,n)||("string"==typeof a.className?a.className=a.className+" "+n:a.setAttribute("class",(a.className&&a.className.baseVal||"")+" "+n)));var a,n}))}(e,n))},a.removeClasses=function(e,t){var a=this.appliedClasses[t],n=a.base,r=a.active,o=a.done;this.appliedClasses[t]={},n&&ve(e,n),r&&ve(e,r),o&&ve(e,o)},a.render=function(){var e=this.props;e.classNames;var t=re(e,["classNames"]);return u.createElement(he,S({},t,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},t}(u.Component);be.defaultProps={classNames:""},be.propTypes={};const ye=({icon:t,text:a,className:n,url:r,onClick:o,afterClick:s,disabled:i})=>e.jsxs("li",{role:"menuitem",className:h("text-[var(--er-text-secondary)] bg-[var(--er-button-neutral)] hover:bg-[var(--er-button-neutral-hover)] flex w-full cursor-pointer select-none items-center gap-2 px-3 pt-[9px] pb-2 text-start transition-all hover:bg-blue-gray-50 hover:text-blue-gray-900 focus:bg-blue-gray-50 focus:bg-opacity-80 focus:text-blue-gray-900 active:bg-blue-gray-50 active:bg-opacity-80 active:text-blue-gray-900 bg-opacity-95 hover:bg-opacity-100",n),onClick:void 0!==r?()=>{return e=r,void(i||window.open(e,"_blank","noopener,noreferrer"));var e}:()=>{i||(null==o||o(),null==s||s())},children:[e.jsx("div",{className:"w-[1.2em] text-center",children:t&&e.jsx(y,{icon:t,color:i?"gray":"",className:h(i?"fill-slate-300":"")})}),e.jsx("p",{className:h("text-sm font-medium",i?"text-[var(--er-text-subtle)]":""),children:a})]}),we=({buttonIcon:t,text:a,children:n})=>{const[r,o]=d.useState(!1),[s,i]=d.useState({opacity:0,visibility:"hidden",transition:"opacity 200ms ease, visibility 200ms ease"}),l=d.useRef(null);d.useEffect((()=>{if(l.current){const e=l.current.getBoundingClientRect(),t={top:`${e.top+window.scrollY}px`,left:e.left+window.scrollX-180+"px",opacity:r?1:0,visibility:r?"visible":"hidden",transition:"opacity 200ms ease, visibility 200ms ease"};i(t)}}),[r]);return e.jsxs("li",{ref:l,className:h("relative bg-[var(--er-button-neutral)] hover:bg-[var(--er-button-neutral-hover)] flex w-full cursor-pointer select-none items-center justify-between gap-2 px-3 pt-[9px] pb-2 text-start transition-all bg-opacity-95 hover:bg-opacity-100",{"!bg-[var(--er-button-neutral-hover)]":r}),onClick:()=>{o(!r)},children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-[1.2em] text-center",children:t&&e.jsx(y,{icon:t})}),e.jsx("p",{className:h("text-sm font-medium mx-2"),children:a})]}),e.jsx(y,{icon:R,className:"transition-transform "+(r?"rotate-90":"")}),T.createPortal(e.jsx("ul",{style:s,className:"absolute shadow-lg shadow-blue-gray-500/10 rounded-sm border border-[var(--er-border-secondary)] overflow-auto flex flex-col min-w-[180px] z-20 ",children:n}),document.body)]})},ke={baseItemHeight:70,itemMargin:12,canvasWidth:800,padding:20,columnPadding:20,headerHeight:60,footerMargin:10,itemPadding:8,rankBoxWidth:55,rankBoxColor:"#48488a",flagBoxWidth:60,flagBoxHeight:45,flagBoxColor:"#3A3A6A",textBoxColor:"transparent",boxGap:15,textPaddingLeft:20,cardCornerRadius:8,boxCornerRadius:4,fontFamily:"Arial, sans-serif",pixelRatio:2,fontSizes:{title:26,rankNumber:25,artist:15,song:13}},je={background:"#1E1E3F",headerGradient:["#3B3B7A","#2A2A5F"],cardBackground:"#2C2C54",titleText:"#E0E0FF",rankText:"#FFFFFF",artistText:"#D0D0F0",songText:"#B0B0D0",footerText:"#A0A0C0",shadow:"rgba(0, 0, 0, 0.2)"},Ce=(e,t,a)=>new Promise(((n,r)=>{fetch(e,{mode:"cors",headers:{Origin:window.location.origin}}).then((t=>{if(!t.ok)throw new Error(`Failed to load SVG: ${t.status} ${t.statusText} from ${e}`);return t.text()})).then((o=>{const s=new Blob([o],{type:"image/svg+xml"}),i=URL.createObjectURL(s),l=new Image(t,a);l.onload=()=>{URL.revokeObjectURL(i),n(l)},l.onerror=t=>{URL.revokeObjectURL(i),r(new Error(`Failed to load SVG image from data URL (original: ${e}): ${t}`))},l.src=i})).catch((e=>r(e)))})),Ne=(e,t="normal")=>new Promise((a=>{const n=`${t} 16px ${e}`;document.fonts&&"function"==typeof document.fonts.check?document.fonts.ready.then((()=>{if(document.fonts.check(n))return void a(!0);new FontFace(e,`local('${e}')`,{weight:t}).load().then((e=>{document.fonts.add(e),a(!0)})).catch((()=>{a(!1)}))})).catch((()=>{a(!1)})):a(!0)})),Ee=(e,t,a,n,r,o=4,s=!0,i=!1)=>{n<2*o&&(o=n/2),r<2*o&&(o=r/2),e.beginPath(),e.moveTo(t+o,a),e.arcTo(t+n,a,t+n,a+r,o),e.arcTo(t+n,a+r,t,a+r,o),e.arcTo(t,a+r,t,a,o),e.arcTo(t,a,t+n,a,o),e.closePath(),s&&e.fill(),i&&e.stroke()},Se=(e,t,a,n,r,o,s)=>{e.fillStyle=s.flagBoxColor,Ee(e,a,n,r,o,s.boxCornerRadius),e.fillStyle=(e=>{const t={al:"#dc3545",am:"#dc3545",au:"#28a745",at:"#dc3545",az:"#17a2b8",be:"#000000",hr:"#dc3545",cy:"#ffc107",cz:"#fd7e14",dk:"#343a40",ee:"#6f42c1",fi:"#28a745",fr:"#0d6efd",ge:"#dc3545",de:"#6c757d",gr:"#28a745",is:"#fd7e14",ie:"#28a745",il:"#28a745",it:"#28a745",lv:"#6f42c1",lt:"#ffc107",lu:"#dc3545",mt:"#28a745",me:"#6c757d",nl:"#fd7e14",no:"#dc3545",pl:"#6c757d",pt:"#28a745",sm:"#28a745",rs:"#dc3545",si:"#28a745",es:"#6f42c1",se:"#28a745",ch:"#6f42c1",ua:"#28a745",gb:"#28a745",uk:"#28a745"};if(t[e.toLowerCase()])return t[e.toLowerCase()];let a=0;for(let r=0;r<e.length;r++)a=e.charCodeAt(r)+((a<<5)-a);let n="#";for(let r=0;r<3;r++){const e=a>>8*r&255;n+=("00"+Math.min(Math.max(e,60),200).toString(16)).slice(-2)}return n})(t);e.fillRect(a+2,n+2,r-4,o-4),e.fillStyle="#ffffff",e.font=`bold ${Math.min(16,o-8)}px ${s.fontFamily}`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.toUpperCase(),a+r/2,n+o/2)},Re=(e,t,a,n)=>{if(a<=0)return[t];const r=t.split(" "),o=[];let s=r[0]||"";e.font=n;for(let i=1;i<r.length;i++){const t=r[i],n=s+" "+t,{width:l}=e.measureText(n);l<a&&s?s=n:(s&&o.push(s),s=t)}return s&&o.push(s),o.filter((e=>""!==e.trim()))},Te=(e,t,a,n,r,o,s,i,l,c)=>{const{country:d,contestant:u}=t;e.save(),e.shadowColor=l.shadow,e.shadowBlur=5,e.shadowOffsetX=2,e.shadowOffsetY=2,e.fillStyle=l.cardBackground,Ee(e,r,o,s,i,c.cardCornerRadius,!0,!1),e.restore();const m=r+c.itemPadding,x=o+c.itemPadding,f=i-2*c.itemPadding;let p=c.rankBoxColor;1===n?p="#a807de":2===n?p="#7c07a3":3===n&&(p="#591a8a"),e.fillStyle=p,Ee(e,m,x,c.rankBoxWidth,f,c.boxCornerRadius),e.fillStyle=l.rankText,e.font=`bold ${c.fontSizes.rankNumber}px ${c.fontFamily}`,e.textAlign="center",e.textBaseline="middle",e.fillText(n.toString(),m+c.rankBoxWidth/2,x+f/2);const h=m+c.rankBoxWidth+c.boxGap,g=o+(i-c.flagBoxHeight)/2;a?((e,t,a,n,r,o,s,i)=>{e.save(),e.fillStyle=i.flagBoxColor,Ee(e,n,r,o,s,i.boxCornerRadius,!0,!1),e.beginPath(),e.moveTo(n+i.boxCornerRadius-2,r),e.arcTo(n+o,r,n+o,r+s,i.boxCornerRadius),e.arcTo(n+o,r+s,n,r+s,i.boxCornerRadius),e.arcTo(n,r+s,n,r,i.boxCornerRadius),e.arcTo(n,r,n+o,r,i.boxCornerRadius),e.closePath(),e.clip();const l=t.naturalWidth||t.width,c=t.naturalHeight||t.height;if(!l||!c)return e.restore(),void Se(e,a,n,r,o,s,i);const d=l/c,u=o/s;let m=0,x=0,f=l,p=c;d>u?(f=c*u,m=(l-f)/2):d<u&&(p=l/u,x=(c-p)/2);try{e.drawImage(t,m,x,f,p,n,r,o,s)}catch(h){}e.restore()})(e,a,d.key,h,g,c.flagBoxWidth,c.flagBoxHeight,c):Se(e,d.key,h,g,c.flagBoxWidth,c.flagBoxHeight,c);const v=h+c.flagBoxWidth+c.textPaddingLeft,b=o+c.itemPadding,y=s-(v-r)-c.itemPadding,w=i-2*c.itemPadding;"transparent"!==c.textBoxColor&&(e.fillStyle=c.textBoxColor,Ee(e,v,b,y,w,c.boxCornerRadius));const k=(null==u?void 0:u.artist)||"Unknown Artist",j=(null==u?void 0:u.song)?`"${u.song}"`:"",C=`bold ${c.fontSizes.artist}px ${c.fontFamily}`,N=`${c.fontSizes.song}px ${c.fontFamily}`,E=1.25,S=Re(e,k,y,C);let R=S.length*c.fontSizes.artist*E,T=[];j&&(T=Re(e,j,y,N),R+=5+T.length*c.fontSizes.song*E);let M=b+(w-R)/2;M=Math.max(M,b),e.textAlign="left",e.textBaseline="top",e.fillStyle=l.artistText,e.font=C,S.forEach((t=>{e.fillText(t,v,M),M+=c.fontSizes.artist*E})),j&&(M+=5,e.fillStyle=l.songText,e.font=N,T.forEach((t=>{e.fillText(t,v,M),M+=c.fontSizes.song*E})))},Me=async(e,t="My Eurovision Ranking",a={},n={})=>{const r={...ke,...a};r.fontSizes={...ke.fontSizes,...a.fontSizes};const o={...je,...n},s=document.createElement("canvas"),i=s.getContext("2d");if(!i)throw new Error("Canvas 2D context not supported");await Ne(r.fontFamily,"normal"),await Ne(r.fontFamily,"bold");const l=(r.canvasWidth-2*r.padding-1*r.columnPadding)/2,c=e.map((e=>((e,t,a,n)=>{var r,o;const s=(null==(r=t.contestant)?void 0:r.artist)||"Unknown Artist",i=(null==(o=t.contestant)?void 0:o.song)?`"${t.contestant.song}"`:"",l=a-(n.itemPadding+n.rankBoxWidth+n.boxGap+n.flagBoxWidth+n.textPaddingLeft)-n.itemPadding;let c=0;const d=`bold ${n.fontSizes.artist}px ${n.fontFamily}`;if(c+=Re(e,s,l,d).length*n.fontSizes.artist*1.25,i){c+=5;const t=`${n.fontSizes.song}px ${n.fontFamily}`;c+=Re(e,i,l,t).length*n.fontSizes.song*1.25}const u=Math.max(n.flagBoxHeight,c);return Math.max(n.baseItemHeight,u+2*n.itemPadding)})(i,e,l,r))),d=Math.ceil(e.length/2);let u=Array(2).fill(0);for(let C=0;C<e.length;C++){const e=Math.floor(C/d);e<2?u[e]+=c[C]+r.itemMargin:u[1]+=c[C]+r.itemMargin}u=u.map((e=>e>0?e-r.itemMargin:0));const m=Math.max(0,...u),x=t&&""!==t.trim(),f=x?r.headerHeight:0,p=f+r.padding+m+r.padding+r.footerMargin+30,h=r.canvasWidth*r.pixelRatio,g=p*r.pixelRatio;s.width=h,s.height=g,s.style.width=`${r.canvasWidth}px`,s.style.height=`${p}px`,i.scale(r.pixelRatio,r.pixelRatio),i.fillStyle=o.background,i.fillRect(0,0,r.canvasWidth,p),x&&((e,t,a,n,r,o)=>{const s=e.createLinearGradient(0,0,a,n);r.headerGradient.forEach(((e,t)=>{s.addColorStop(t/(r.headerGradient.length-1||1),e)})),e.fillStyle=s,e.fillRect(0,0,a,n),e.fillStyle=r.titleText,e.font=`bold ${o.fontSizes.title}px ${o.fontFamily}`,e.textAlign="center",e.textBaseline="middle",e.fillText(t,a/2,n/1.8)})(i,t,r.canvasWidth,r.headerHeight,o,r);const v=e.map((e=>e.country.key)),b={};await Promise.all(v.map((async e=>{try{b[e]=await(async e=>{try{const a=[`https://flagcdn.com/w320/${e.toLowerCase()}.png`,`https://flagsapi.com/${e.toUpperCase()}/flat/64.png`];for(const e of a)try{if(e.endsWith(".svg"))return await Ce(e,100,75);{const t=new Image;return await new Promise(((a,n)=>{t.onload=()=>a(),t.onerror=t=>n(new Error(`Image load error from ${e}: ${t}`)),t.crossOrigin="anonymous",t.src=e})),t}}catch(t){}throw new Error(`Could not load flag for ${e} from any source`)}catch(t){return null}})(e)}catch(t){b[e]=null}})));const y=f+r.padding;let w=Array(2).fill(y);const k=Array(2).fill(0).map(((e,t)=>r.padding+t*(l+r.columnPadding)));for(let C=0;C<e.length;C++){const t=e[C],a=C+1,n=c[C],s=b[t.country.key],u=Math.floor(C/d);Te(i,t,s,a,k[u],w[u],l,n,o,r),w[u]+=n+r.itemMargin}const j=p-30-r.footerMargin;return((e,t,a,n,r,o,s)=>{e.fillStyle=o.background,e.fillRect(0,r,a,n),e.fillStyle=o.footerText,e.font=`italic ${.9*s.fontSizes.song}px ${s.fontFamily}`,e.textAlign="center",e.textBaseline="middle",e.fillText(t,a/2,r+n/2)})(i,"Generated with eurovision-ranker.com",r.canvasWidth,30,j,o,r),s},Pe=({className:t="",showText:a=!0,afterClick:n=(()=>{})})=>{const[r,o]=d.useState(!1),s=f((e=>e.name)),i=f((e=>e.rankedItems));f((e=>e.showPlace)),f((e=>e.vote));let l={};return e.jsx(ye,{icon:P,text:"Download image",onClick:async()=>{if(0!==i.length){o(!0);try{await(async(e,t="",a={},n={})=>{if(0===e.length)return void M.error("Please rank some countries first");const r={...ke,...a};(!r.pixelRatio||r.pixelRatio<2)&&(r.pixelRatio=2);const o=M.loading("Creating your ranking image...");try{const a=await Me(e,t,r,n),s=`${(t&&""!==t.trim()?t.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""):"eurovision-ranking")||"ranking"}.png`,i=await new Promise((e=>{a.toBlob((t=>{e(t)}),"image/png",1)}));if(!i)throw new Error("Failed to create image blob.");const l=URL.createObjectURL(i),c=document.createElement("a");c.href=l,c.download=s,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(l),M.dismiss(o),M.success("Ranking image downloaded!")}catch(s){M.dismiss(o),M.error(`Failed to create image: ${s instanceof Error?s.message:String(s)}`)}})(i,s,l)}catch(e){M.error("Failed to create image")}finally{setTimeout((()=>{o(!1)}),1e3)}}else M.error("Please rank some countries first")},afterClick:n})},$e=t=>{const[n,r]=d.useState(!1),o=d.useRef(null),s=f((e=>e.rankedItems)),i=f((e=>e.headerMenuOpen)),l=$(),c=d.useRef(null),u=f((e=>e.showTotalRank)),m=e=>{var t;const a=e.target,n=(e=>{for(;e;){if(e.id&&e.id.startsWith("react-joyride"))return!0;e=e.parentElement}return!1})(a);(null==(t=o.current)?void 0:t.contains(a))||n||r(!1)};function x(){r(!1)}return d.useEffect((()=>(document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m),clearTimeout(undefined),document.body.classList.remove("no-scroll")})),[]),d.useEffect((()=>{i?(r(!0),document.body.classList.add("no-scroll"),l(a(!1))):setTimeout((()=>{document.body.classList.remove("no-scroll")}),300)}),[i]),e.jsxs("div",{className:"relative inline-block",ref:o,children:[e.jsx("button",{className:h("tour-step-6 w-6 h-6 bg-[var(--er-surface-muted-accent)] hover:bg-[var(--er-surface-light)] rounded-full flex justify-center items-center cursor-pointer",{"!bg-[var(--er-surface-light)]":n}),onClick:()=>{const e=n;r(!n),e?setTimeout((()=>{document.body.classList.remove("no-scroll")}),300):document.body.classList.add("no-scroll")},children:e.jsx(y,{className:"text-[var(--er-text-secondary)]",icon:L})}),e.jsx(be,{in:n,timeout:200,classNames:"menu",nodeRef:c,unmountOnExit:!0,children:e.jsxs("ul",{role:"menu",className:"absolute z-20 min-w-[180px] right-0 mt-1 shadow-lg shadow-blue-gray-500/10 rounded-sm border border-[var(--er-border-secondary)] overflow-auto flex flex-col",children:[e.jsx(ye,{icon:B,text:"View Heat Map",className:"tour-step-8",onClick:t.onMapClick,afterClick:x}),O(s)&&e.jsx(ye,{icon:F,text:"YouTube Playlist",className:"tour-step-7",onClick:()=>{var e;return window.open(null==(e=t.generateYoutubePlaylistUrl)?void 0:e.call(t),"_blank")},afterClick:x}),e.jsx(ye,{icon:A,text:"Edit Name",onClick:()=>t.openNameModal(),afterClick:x}),e.jsx(ye,{icon:D,text:"Categories",className:"tour-step-9",onClick:()=>t.openConfig("categories"),afterClick:x}),e.jsx(ye,{icon:z,text:"Rankings",onClick:()=>t.openConfig("rankings"),afterClick:x}),e.jsx(ye,{icon:I,text:"Display settings",onClick:()=>t.openConfig("display"),afterClick:x}),e.jsx(ye,{icon:U,text:"Use Sorter",onClick:t.openSorterModal,disabled:s.length<2||u,afterClick:x}),s.length>0&&e.jsx(Pe,{className:"text-[var(--r-accent-blue)] hover:text-white mr-2",iconClassName:"text-lg",afterClick:x}),e.jsxs(we,{text:"Copy",buttonIcon:W,children:[e.jsx(ye,{text:"URL",icon:_,onClick:Z}),e.jsx(ye,{text:"Text",icon:H,onClick:()=>ee(s,te.TEXT)}),e.jsx(ye,{text:"CSV",icon:G,onClick:()=>ee(s,te.CSV)}),e.jsx(ye,{text:"JSON",icon:G,onClick:()=>ee(s,te.JSON)})]})]})})]})},Le=({setMapModalShow:t,generateYoutubePlaylistUrl:a,openNameModal:s,openConfig:i,supportedYears:l,className:c,downloadButton:u,openSorterModal:m})=>{const x=$(),p=f((e=>e.year)),g=f((e=>e.name)),v=f((e=>e.globalSearch)),b=f((e=>e.rankedItems)),w=f((e=>e.showTotalRank)),k=f((e=>e.categories)),j=f((e=>e.showUnranked)),C=f((e=>e.activeCategory)),[N,E]=d.useState(0);d.useEffect((()=>{0!==N?(w&&x(n(!1)),x(r(N-1))):!w&&(null==k?void 0:k.length)&&x(n(!0))}),[N]),d.useEffect((()=>{E(void 0!==C?C+1:0)}),[C]);const S=b.length<2||w;return e.jsxs("div",{className:h("z-40 rounded-t-md round-b-sm w-full text-center font-bold bg-[var(--er-surface-bar)] gradient-background text-[var(--er-text-secondary)] py-1 text-md tracking-tighter shadow-md ranked-bar-background",c),children:[j?e.jsx("div",{className:"w-full m-auto flex items-center justify-center",children:e.jsx(Q,{className:"tour-step-1 min-w-[5em] w-auto",buttonClassName:"!h-[1.8em]",value:p,onChange:e=>{x(o(e))},options:l,showSearch:!0})}):e.jsxs("div",{className:"mx-2 flex justify-between items-center",children:[e.jsxs("div",{className:"w-6 h-6 tour-step-10",children:[" ",(null==b?void 0:b.length)>0&&e.jsx("button",{title:S?"Sorter unavailable (need >1 item and not on Total Rank tab)":"Open Sorter","aria-label":"Open Sorter","data-umami-event":"Sorter Button (header)",className:h("w-6 h-6 bg-[var(--er-surface-muted-accent)] rounded-full flex justify-center items-center text-[var(--er-text-tertiary)] hover:text-[var(--er-text-muted)]",{"hover:bg-[var(--er-surface-light)] hover:cursor-pointer":!S,"opacity-50 cursor-not-allowed":S}),onClick:m,disabled:S,children:e.jsx(y,{className:"",icon:U})})]}),e.jsxs("div",{className:"justify-center text-center flex-grow mx-2",children:[" ",v?null:p,g&&e.jsxs("span",{className:"font-bold text-[var(--er-text-tertiary)] text-md",children:[v?"":" - ",g]})]}),e.jsx($e,{openNameModal:s,openConfig:i,onMapClick:t,openSorterModal:m,generateYoutubePlaylistUrl:()=>a(b)})]}),!j&&k.length>0&&e.jsxs("div",{className:"flex bg-gray-800 bg-opacity-40 border-[var(--er-border-lightest)] mt-1 -mb-[0.2em] overflow-x-auto",children:[e.jsx(ae,{placeholder:e.jsx(e.Fragment,{}),children:e.jsx("button",{className:h("px-4 py-[0.2em] text-sm font-strong flex-shrink-0",0===N?"text-[var(--r-accent-blue)] border-b-0 border-[var(--r-accent-ring)]":"text-[var(--er-text-subtle)] hover:text-[var(--er-interactive-primary)]"),onClick:()=>E(0),children:"Total"},"total-tab")},"total-ripple"),k.map(((t,a)=>e.jsx(ae,{placeholder:e.jsx(e.Fragment,{}),children:e.jsx("button",{className:h("px-4 py-[0.2em] text-sm font-medium flex-shrink-0",N===a+1?"text-[var(--r-accent-blue)] border-b-0 border-[var(--r-accent-ring)]":"text-[var(--er-text-muted)] hover:text-[var(--er-interactive-primary)]"),onClick:()=>E(a+1),children:t.name},`cat-btn-${a+1}`)},`ripple-${a+1}`)))]},"total-tab-container")]})},Be=u.lazy((()=>s((()=>import("./IntroColumn-DY2zIMdX.js")),__vite__mapDeps([0,1,2,3,4,5,6,7])))),Oe=t=>{const[a,n]=d.useState(!1);return d.useEffect((()=>{n(!0)}),[]),e.jsx(d.Suspense,{fallback:e.jsx("div",{className:"w-[10em]"}),children:a?e.jsx(Be,{...t}):e.jsx("div",{children:"Loading..."})})},Fe=({openSongModal:t,openModal:a,openConfigModal:n,setRunTour:r,setRunSortTour:o,openNameModal:s,openMapModal:u,openSorterModal:p})=>{const g=$(),[v,b]=d.useState(0),y=f((e=>e.showUnranked)),w=f((e=>e.theme)),k=f((e=>e.showTotalRank)),j=f((e=>e.isDeleteMode)),C=f((e=>e.rankedItems)),N=f((e=>e.categories)),E=f((e=>e.activeCategory)),[S,R]=d.useState(0),T=e=>{R(e.currentTarget.scrollLeft)};d.useEffect((()=>{0!==v&&i(E,N,C)}),[v]);const M=d.useCallback((e=>{g(Y(e)),b(Math.random())}),[g]);return e.jsx("div",{className:"tour-step-5 z-20",children:e.jsx(m,{droppableId:"rankedItems",children:i=>e.jsxs("div",{className:h("grid h-full max-h-full min-h-full grid-rows-[auto_1fr]"),children:[e.jsx(Le,{setMapModalShow:()=>u(),generateYoutubePlaylistUrl:()=>V(C),supportedYears:l,openNameModal:s,openConfig:n,openSorterModal:p,className:y?"min-w-[9em] max-w-50vw-6em":"w-[80vw] max-w-[30.5em] min-w-[20.5em]"}),e.jsx("div",{className:"px-1 overflow-y-auto h-full",children:e.jsxs("ul",{...i.droppableProps,ref:i.innerRef,className:h("overflow-y-auto overflow-x-hidden pt-3 ranked-items-background w-full h-full",y?"min-w-[9em] max-w-50vw-6em":"w-[85vw] max-w-[30em] min-w-[20em]",{"auroral-background":w.includes("ab")}),children:[0===C.length&&y&&e.jsx(Oe,{openModal:a,openConfigModal:n,setRunTour:r,setRunSortTour:o}),!y&&0===C.length&&e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("span",{className:"text-center mb-40 min-mt-5 text-[var(--er-text-muted)] mx-10 text-sm",children:[e.jsx("div",{children:"Click 'Select' to choose"})," countries to rank",e.jsx("div",{children:e.jsx(X,{alt:"Heart",style:{display:"inline",verticalAlign:"middle"},className:"ml-[0.5em] mt-3 mb-1 w-6 h-6 pulse-on-load my-heart-icon"})})]})}),C.map(((a,n)=>e.jsx(J,{draggableId:(null==a?void 0:a.uid)??a.id,index:n,isDragDisabled:k,children:(r,o)=>e.jsx("li",{ref:r.innerRef,...r.draggableProps,...r.dragHandleProps,className:h("no-select m-2 mx-1",{"mt-0":0===n}),children:y?e.jsx(x,{className:"m-auto text-[var(--er-text-tertiary)] bg-[var(--er-surface-primary)] no-select",rank:n+1,countryContestant:a,isDeleteMode:y&&j,deleteCallBack:M,isDragging:o.isDragging},`card-${(null==a?void 0:a.uid)??a.id}`):e.jsx(ne,{rank:n+1,countryContestant:a,openSongModal:()=>t(a),isDragging:o.isDragging,categoryScrollPosition:S,onCategoryScroll:T},`card-${(null==a?void 0:a.uid)??a.id}`)},`li-${(null==a?void 0:a.uid)??a.id}`)},`draggable-${(null==a?void 0:a.uid)??a.id}`))),i.placeholder]})}),y&&(null==C?void 0:C.length)>0&&e.jsxs("div",{className:"pl-2 rounded-b-md h-8 !bg-[var(--er-surface-bar)] ranked-bar-background text-[var(--er-text-secondary)] items-center flex shadow-md gradient-background",children:[e.jsx(q,{className:h("tour-step-4 ml-auto py-1 pl-[0.7em] pr-[0.9em] mr-0 w-[6em]",{"tada-animation-6s":y&&(null==C?void 0:C.length)}),onClick:()=>g(c(!y)),title:"View List"}),e.jsx(K,{className:h("ml-2 mr-auto text-lg justify-center align-center bounce-right text-[var(--r-accent-blue)]",{"tada-animation":y&&(null==C?void 0:C.length)})})]})]})})})};export{Fe as default};
