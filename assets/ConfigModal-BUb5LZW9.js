import{j as e,u as a,M as s,N as t,z as l,f as n,O as r,Q as o,R as i,S as c,T as m,U as d,V as h,v as x,W as p,X as u,Y as v,Z as b,$ as j,a0 as g,i as y,a1 as f,a2 as N,a3 as w,a4 as k,a5 as C,a6 as S,A as $}from"./index-8wxkatai.js";import{r as A,R}from"./redux-BaDTb7KV.js";import{u as T,I as z,y as E,a2 as M,c as D,l as F,a3 as I,a4 as O,T as U,a5 as W,a6 as Y,a7 as B,a8 as V,Y as J,v as L,w as P,a9 as X,t as G,aa as K}from"./App-BBGFP-xe.js";import{D as Q}from"./Dropdown-BPFEUAnA.js";import{E as Z,c as _,a as q,g as H,b as ee,d as ae}from"./ExportUtil-DXiAIJNy.js";import{T as se}from"./TabButton-mJYiiOfE.js";import"./react-D41Hy763.js";const te=()=>{const[a,s]=A.useState("Text"),t=Object.values(Z).map((e=>e)),l=T((e=>e.rankedItems));return e.jsxs("div",{className:"mb-0",children:[e.jsx("div",{className:"mb-[1.5em]",children:e.jsx(z,{className:"pl-[0.7em] ml-0 py-[0.5em] px-[1em]",onClick:_,icon:E,title:"Copy URL to Clipboard"})}),e.jsx(Q,{className:"z-50 w-20 h-10 mx-auto",menuClassName:"",value:a,onChange:e=>s(e),options:t,showSearch:!1},"type-selector"),e.jsxs("div",{children:[e.jsx(z,{className:"ml-0 pl-[0.7em] rounded-md text-xs py-[0.5em] pr-[1em]",onClick:async function(){let e=await H(a,l),s=ee(a);ae(e,null==s?void 0:s.fileExtension)},icon:M,title:"Download"}),e.jsx(z,{className:"ml-4 pl-[0.7em] py-[0.5em] pr-[1em]",onClick:()=>q(l,a),icon:E,title:"Copy to Clipboard"})]})]})},le=({checked:a,onChange:s,label:t,className:l,id:n})=>e.jsxs("div",{className:D("inline-flex items-center",l),children:[e.jsxs("label",{className:"relative flex items-center p-3 rounded-full cursor-pointer",htmlFor:"blue",children:[e.jsx("input",{type:"checkbox",className:"before:content[''] peer relative h-5 w-5 cursor-pointer appearance-none rounded-md border border-blue-gray-200 transition-all before:absolute before:top-2/4 before:left-2/4 before:block before:h-12 before:w-12 before:-translate-y-2/4 before:-translate-x-2/4 before:rounded-full before:bg-blue-gray-500 before:opacity-0 before:transition-opacity checked:border-blue-500 checked:bg-blue-500 checked:before:bg-blue-500 hover:before:opacity-10",id:n,checked:a??!1,onChange:e=>s(e.target.checked)},`key-${n}`),e.jsx("span",{className:"absolute text-white transition-opacity opacity-0 pointer-events-none top-2/4 left-2/4 -translate-y-2/4 -translate-x-2/4 peer-checked:opacity-100",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5",viewBox:"0 0 20 20",fill:"currentColor",stroke:"currentColor",strokeWidth:"1",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),e.jsx("span",{className:"text-slate-400 text-sm",children:t})]}),ne=()=>{const t=F(),l=T((e=>e.categories)),n=T((e=>e.activeCategory)),[r,o]=A.useState(""),i=T((e=>e.showComparison)),c=()=>{if(""!==r.trim()){if(!Y(r,l))return;const e=[...l,{name:r,weight:5}];o(""),I(e,t,l,n)}};return e.jsxs("div",{className:"mb-0",children:[e.jsxs("p",{className:"relative mb-[1em] mt-2 text-sm",children:["Create categories to build multiple rankings based on different criteria: e.g. ",e.jsx("i",{children:"Vocals, Dance, Lyrics"})," ","etc."]}),e.jsxs("div",{className:"mt-5 mb-[1.5em]",children:[e.jsx("span",{className:"font-bold ml-0 whitespace-nowrap",children:"Categories"}),e.jsxs("div",{className:"mt-4",children:[e.jsx("input",{type:"text",placeholder:"Enter category name",value:r,onChange:e=>o(e.target.value),onKeyDown:e=>{"Enter"===e.key&&c()},className:"px-2.5 py-1.5 ml-1 mr-3 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"}),e.jsx(z,{className:"ml-1 pl-[0.7em] py-[0.5em] pr-[1em]",onClick:c,icon:void 0,title:"Add"}),(null==l?void 0:l.length)>0&&e.jsx(z,{className:"ml-3 mt-2 bg-rose-800 hover:bg-rose-700 text-white font-normal pl-[0.7em] py-[0.5em] pr-[1em]",onClick:()=>{I([],t,l,n)},disabled:!(null==l?void 0:l.length),icon:O,title:"Clear"})]}),e.jsxs("div",{className:"mt-1",children:[e.jsx(U,{content:"When viewing a category ranking, also display the contestant's rank in each other category",className:"ml-2 pb-1"}),e.jsx(le,{id:"total-checkbox",checked:i,onChange:e=>{return a({cm:!0===(l=e)?"t":"f"}),void t(s(!0===l));var l},label:"Show Category Comparisons"})]}),e.jsxs("table",{className:"mt-4 w-full table-auto",children:[(null==l?void 0:l.length)>0&&e.jsx("thead",{children:e.jsxs("tr",{className:"text-sm",children:[e.jsx("th",{className:"text-left px-2",children:"Name"}),e.jsx("th",{className:"text-left px-2",children:"Weight"}),e.jsx("th",{className:"px-2"})]})}),e.jsx("tbody",{children:l.map(((a,s)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2",children:e.jsx("input",{type:"text",value:a.name,onChange:e=>((e,a)=>{if(!Y(a,l))return;let s=[...l];s[e]={...l[e],name:a},I(s,t,l,n)})(s,e.target.value),className:"px-2.5 py-1.5 mr-3 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white w-full"})}),e.jsx("td",{className:"px-2",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"range",min:"0",max:"10",step:"1",value:a.weight,onChange:e=>((e,a)=>{let s=[...l];s[e]={...s[e],weight:a},I(s,t,l,n)})(s,parseInt(e.target.value)),className:"w-full"}),e.jsx("span",{className:"ml-2 w-3",children:a.weight})]})}),e.jsx("td",{className:"px-2",children:e.jsx("button",{onClick:()=>W(s,t,l,n),className:"bg-rose-800 hover:bg-rose-700 text-white rounded-md px-[0.5em] py-[0.1em]",children:"X"})})]},s)))})]})]})]})},re=()=>{const a=T((e=>e.year)),s=T((e=>e.theme)),[x,p]=A.useState("2026"!==a?a:"2025"),[u,v]=A.useState("All"),[b,j]=A.useState(["All",...t.sort(((e,a)=>e.name.localeCompare(a.name))).map((e=>e.name))]),[g,y]=A.useState(!1),[f,N]=A.useState(!1),[w,k]=A.useState(["",...t.sort(((e,a)=>e.name.localeCompare(a.name))).map((e=>e.name))]),[C,S]=A.useState(""),[$,R]=A.useState("Year");A.useEffect((()=>{(async()=>{const e=await n(x,void 0);j(["All",...e.map((e=>e.country)).sort(((e,a)=>e.name.localeCompare(a.name))).map((e=>e.name))]),N(r(e)),y(o(e))})()}),[x]);const E=async(e,s,l,r)=>{var o;let i,c;(null==r?void 0:r.length)&&"All"!==r&&(c=null==(o=t.find((e=>e.name===r)))?void 0:o.key,c&&(i=`${l}-${s}-${c}`));let m=await n(e,i);if("1956"===d(a))return m.filter((e=>{var a;return"1"===(null==(a=e.contestant)?void 0:a.finalsRank.toString())})).map((e=>e.id)).join("");m=await h(m,s,l,c);return m.filter((e=>{var a;return void 0!==(null==(a=null==e?void 0:e.contestant)?void 0:a.votes)})).map((e=>e.id)).join("")},M=async(e=!1)=>{let a=await i(C);switch(e&&(a=a.filter((e=>e.finalsRank))),$){case"Year":a=a.sort(((e,a)=>Number(a.year)-Number(e.year)));break;case"Rank":a=a.sort(((e,a)=>e.finalsRank||a.finalsRank?e.finalsRank?a.finalsRank?Number(e.finalsRank)-Number(a.finalsRank):-1:1:0))}const t=a.map((e=>e.id)).join("");c(`?r=>${t}&g=t&`+("Rank"===$?"pl=t&":"")+`n=${encodeURIComponent(C)}&`,s)},D=async e=>{const s=x??a;return`?r=${await E(s,"televote","final",e)}&y=${s.substring(2,4)}&n=Final+Televote${I(e)}&v=${m("f","tv",e)}`},F=async e=>{const s=x??a;return`?r=${await E(s,"jury","final",e)}&y=${s.substring(2,4)}&n=Final+Jury${I(e)}&v=${m("f","j",e)}`},I=e=>(null==e?void 0:e.length)&&"All"!==e?`+from+${encodeURIComponent(e).replaceAll(" ","+")}`:"";return e.jsxs("div",{className:"mb-0",children:[e.jsx("p",{className:"relative mb-[1em] mt-2 text-sm",children:"Generate rankings based on selected year, or see all contestants for a selected country."}),e.jsxs("div",{className:"mt-5",children:[e.jsx("span",{className:"font-bold ml-0 whitespace-nowrap",children:"ESC final rankings"}),e.jsx(U,{content:"Select a year and voting country, then click one of the buttons to see official final rankings",className:"ml-0 z-50"}),e.jsxs("div",{className:" mt-[0.7em]",children:[e.jsxs("div",{children:[e.jsx(Q,{className:"w-22 mx-auto mb-2",menuClassName:"",value:x??a,onChange:e=>p(e),options:l.filter((e=>"2020"!==e&&"2026"!==e)),showSearch:!0}),e.jsx("span",{className:"ml-2 text-sm",children:"from"}),e.jsx(U,{content:"Choose which country to display voting counts from. 'All' will show the total vote count",className:"ml-4 z-50"}),e.jsx(Q,{className:"ml-3 mx-auto mb-2",menuClassName:"w-auto",value:u,onChange:e=>v(e),options:b,showSearch:!0},"country-selector")]}),e.jsx("div",{className:"mt-2 ml-0",children:e.jsxs("span",{className:"",children:["2026"!==x?e.jsx(z,{onClick:async()=>{const e=x??a,t=await E(e,"total","final",u);c(`?r=${t}&y=${e.substring(2,4)}&n=Final${I(u)}&v=${m("f","t",u)}`,s)},className:"pl-[1em] pr-[1em] rounded-md",title:"total"}):e.jsx(e.Fragment,{children:"No voting data available yet for 2026"}),f&&e.jsx(z,{onClick:async()=>{const e=await D(u);c(e,s)},className:"ml-3 pl-[1em] pr-[1em] rounded-md",title:"televote"}),g&&e.jsx(z,{onClick:async()=>{const e=await F(u);c(e,s)},className:"ml-3 pl-[1em] pr-[1em] rounded-md",title:"jury"})]})})]})]}),e.jsxs("div",{className:"mt-5",children:[e.jsx("span",{className:"font-bold ml-0 whitespace-nowrap",children:"Contestants by country "}),e.jsx(U,{content:"Display all past and current contestants for a specific country",className:"ml-0 z-50"}),e.jsx("div",{className:" mt-[0.7em]",children:e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx(Q,{className:"mx-auto mb-2 min-w-[5em]",menuClassName:"w-auto",value:C,onChange:e=>S(e),options:w,showSearch:!0},"country-selector"),e.jsx("span",{className:"mx-2",children:"order by"}),e.jsx(Q,{className:"mx-auto mb-2 min-w-[5em]",menuClassName:"w-auto",value:$,onChange:e=>R(e),options:["Year","Rank"],showSearch:!1},"country-order-selector")]}),e.jsxs("div",{className:"mt-2 -ml-4",children:[e.jsx(z,{onClick:M,className:"ml-4 pl-[1em] pr-[1em] rounded-md",title:"all",disabled:!C}),e.jsx(z,{onClick:()=>M(!0),className:"ml-4 pl-[1em] pr-[1em] rounded-md",title:"finalists",disabled:!C})]})]})})]})]})},oe=()=>{const l=F(),n=T((e=>e.vote)),r=T((e=>e.theme)),o=T((e=>e.showComparison)),i=T((e=>e.showThumbnail)),c=T((e=>e.showPlace)),m=T((e=>e.rankedItems)),d=T((e=>e.year)),h=T((e=>e.globalSearch)),[w,k]=A.useState("None"),C=e=>{var a,s;if(!(null==e?void 0:e.length)||"loading"===e)return"All";const l=e.split("-")[2];return l?null==(s=null==(a=t.filter((e=>e.key===l)))?void 0:a[0])?void 0:s.name:"All"},[S,$]=A.useState((()=>C(n))),[R,z]=A.useState(["All",...t.sort(((e,a)=>e.name.localeCompare(a.name))).map((e=>e.name))]);A.useEffect((()=>{k("ab"===r?"Auroral":"None")}),[r]),A.useEffect((()=>{const e=C(n);e!==S&&$(e)}),[n]);const E=(e,s)=>{const t=u(n,e,s);t!==n&&(l(v(t)),a({v:t}))};return A.useEffect((()=>{(async()=>{var e;if("loading"===n)return;let s=(null==(e=null==n?void 0:n.split("-"))?void 0:e[1])??"",r=(e=>{var a,s;return(null==e?void 0:e.length)&&"All"!==e?null==(s=null==(a=t.filter((a=>a.name===e)))?void 0:a[0])?void 0:s.key:""})(S),o=`f-${s}-${r}`;await async function(e,a){if(h){let s=await g(e,a);l(y(s))}else{let e=await f(a,d);l(N(e))}}(m,o),o!==n&&(a({v:o}),l(v(o)))})()}),[S]),e.jsxs("div",{className:"mb-0",children:[e.jsx("div",{children:e.jsxs("div",{className:"mb-[0.5em] border-slate-700 border-b-[1px] pb-2 -mt-2",children:[e.jsxs("span",{className:"flex items-center ml-2",children:[e.jsx(U,{content:"Display the contestant's place in the final contest if applicable"}),e.jsx("span",{className:"ml-3 text-sm font-semibold",children:"Show Place:"}),e.jsx(le,{id:"place-checkbox",checked:c,label:"",onChange:e=>{return a({pl:!0===(s=e)?"t":"f"}),void l(j(!0===s));var s}})]}),e.jsxs("span",{className:"flex items-center ml-2",children:[e.jsx(U,{content:"Select which types of votes to display with each ranked country"}),e.jsx("span",{className:"ml-3 text-sm font-semibold",children:"Show Votes:"}),e.jsx(le,{id:"total-checkbox",checked:x(n,"t"),onChange:e=>E("t",e),label:"Total"}),e.jsx(le,{id:"tele-checkbox",checked:x(n,"tv"),onChange:e=>E("tv",e),label:"Tele",className:"ml-[0.5em]"}),e.jsx(le,{id:"jury-checkbox",checked:x(n,"j"),onChange:e=>E("j",e),label:"Jury",className:"ml-[0.5em]"})]}),e.jsxs("div",{className:"mt-[0.5em]",children:[e.jsx(U,{content:"Choose which country to display voting counts from. 'All' will show the total vote count",className:"ml-4"}),e.jsx("span",{className:"ml-3 text-sm font-semibold",children:"From:"}),e.jsx(Q,{className:"ml-5 min-w[6em] mx-auto mb-2",menuClassName:"w-auto",value:S,onChange:e=>$(e),options:R,showSearch:!0},"country-selector-2")]})]})}),e.jsx("div",{children:e.jsx("div",{className:"mt-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"mb-0",children:[e.jsx(U,{content:"Determine whether to show a thumbnail of the song video",className:"ml-4 pb-1"}),e.jsx(le,{id:"thumbnail-checkbox",checked:i,onChange:e=>{return a({p:!0===(s=e)?"t":"f"}),void l(b(!0===s));var s},label:"Show Video Thumbnails"})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx(U,{content:"When viewing a category ranking, also display the contestant's rank in each other category",className:"ml-4 pb-1"}),e.jsx(le,{id:"total-checkbox",checked:o,onChange:e=>{return a({cm:!0===(t=e)?"t":"f"}),void l(s(!0===t));var t},label:"Show Category Comparisons"})]}),e.jsx("span",{className:"ml-5 font-semibold text-sm mb-[0.7em]",children:"Theme:"}),e.jsx(Q,{className:"ml-5 w-30 mx-auto mb-3",menuClassName:"",value:w,onChange:e=>{"Auroral"===e?(l(p("ab")),a({t:"ab"})):(l(p("")),a({t:""}))},options:["None","Auroral"],showSearch:!1},"theme-selector")]})})})]})},ie=a=>e.jsx("span",{className:D("px-2 py-0.5 bg-blue-500 text-white text-xs font-semibold rounded-full",a.className),children:"Beta"}),ce=()=>{var l;const r=F(),o=T((e=>e.year)),i=T((e=>e.categories)),c=T((e=>e.activeCategory)),[m,d]=A.useState((null==(l=w(o))?void 0:l.length)>1?"Televote":"Total"),[x,p]=A.useState([]),[u,v]=A.useState([]),[b,j]=A.useState(new Map),g=T((e=>e.showComparison)),y=T((e=>e.globalSearch)),f=async(e,a,s)=>{var l;const r=new Map,o=await n(s,"");for(const n of t){const a=await N(e,m,"final",o,n.key);r.has(a)?null==(l=r.get(a))||l.push(n):r.set(a,[n])}return r},N=async(e,a,s,t,l)=>(t=await h(t,a,s,l)).filter((e=>{var a;return void 0!==(null==(a=null==e?void 0:e.contestant)?void 0:a.votes)})).map((a=>e?a.uid:null==a?void 0:a.id)).join("");const E=(e,a)=>`${e.charAt(0).toUpperCase()+e.slice(1)}: ${a}`,M=(e,a)=>`?r=${e.list2Code}&y=${o.substring(2,4)}&n=${E(m,a).replaceAll(" ","+")}&v=f-${C(m)}-${S(a)}`,D=e=>{const a=Math.round(10*e)/10;return a%1==0?a.toFixed(0):a.toFixed(1)},O=(s,t)=>e.jsxs("div",{className:"mt-4",children:[e.jsxs("p",{className:"text-sm mb-2",children:[t," ",m," rankings:"]}),e.jsx("div",{className:"grid grid-cols-[auto,1fr] gap-x-4 gap-y-2",children:s.flatMap((s=>{return(t=[s],l=b,t.flatMap((e=>l.get(e.list2Code)??[])).map((e=>e.name)).sort(((e,a)=>null==e?void 0:e.localeCompare(a)))).map(((t,l)=>e.jsxs(R.Fragment,{children:[e.jsx("div",{className:"whitespace-nowrap flex items-center",children:e.jsx("a",{href:M(s,t),target:"_blank",rel:"noopener noreferrer",className:" text-blue-500 hover:underline",title:E(m,t),children:e.jsxs("span",{className:"mt-auto",children:[t," (",D(s.percentSimilarity),"%)"]})})}),e.jsx("div",{children:e.jsx(z,{className:"pl-[0.7em] py-[0.5em] pr-[1em]",onClick:()=>((e,s)=>{const t=$("r");let l=[...i];if(t){const e={name:"Original",weight:5};l=[...l,e]}const n={name:s,weight:0},o=[...l,n];I(o,r,l,c),a({[`r${o.length}`]:e})})(s.list2Code,E(m,t)),icon:void 0,title:"Add as Category"})})]},`${s.list2Code}-${l}`)));var t,l}))})]});return e.jsxs("div",{className:"mb-0",children:[e.jsxs("div",{className:"relative mb-[1em] mt-2 flex items-center",children:[e.jsx("div",{className:"flex justify-center items-center mr-3 ml-3",children:e.jsx(ie,{className:"flex-shrink-0"})}),e.jsx("p",{className:"text-sm mr-1",children:"Compare your current ranking with the Jury or Tele vote from each participating country"})]}),e.jsxs("div",{className:"mt-5 mb-[1.5em]",children:[e.jsx("div",{children:e.jsx(Q,{className:"z-50 ml-3 mx-auto mb-2",menuClassName:"w-auto",value:m,onChange:e=>{d(e),p([]),v([])},options:w(o),showSearch:!1},"vote-type-selector")}),e.jsxs("div",{className:"mb-1",children:[e.jsx(U,{content:"When viewing a category ranking, also display the contestant's rank in each other category",className:"ml-2 pb-1"}),e.jsx(le,{id:"total-checkbox",checked:g,onChange:e=>{return a({cm:!0===(t=e)?"t":"f"}),void r(s(!0===t));var t},label:"Show Category Comparisons"})]}),e.jsx(z,{className:"ml-3 pl-[0.7em] py-[0.5em] pr-[1em]",onClick:async()=>await(async()=>{const e=k(c).rankings,a=await f(y,0,o);j(a);const s=Array.from(a.keys()),t=await B(o,e,s);p(t)})(),icon:void 0,title:"Most similar"}),e.jsx(z,{className:"ml-3 font-normal pl-[0.7em] rounded-md text-xs py-[0.5em] pr-[1em]",onClick:async()=>await(async()=>{const e=k(c).rankings,a=await f(y,0,o);j(a);const s=Array.from(a.keys()),t=await V(o,e,s);v(t)})(),icon:void 0,title:"Most dissimilar"})]}),x.length>0&&O(x,"Most similar"),u.length>0&&O(u,"Most dissimilar")]})},me=a=>{const[s,t]=A.useState(a.tab),l=T((e=>e.globalSearch)),n=T((e=>e.rankedItems));return new Set(n.map((e=>{var a;return null==(a=e.contestant)?void 0:a.year})).filter(Boolean)).size,A.useEffect((()=>{a.isOpen&&t(a.tab)}),[a.tab,a.isOpen]),e.jsxs(J,{isOpen:a.isOpen,onClose:a.onClose,className:"",children:[e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700 -mt-4",children:e.jsxs("ul",{className:"flex flex-wrap -mb-px text-sm font-medium text-center text-gray-500 dark:text-gray-400",children:[e.jsx(se,{isActive:"rankings"===s,onClick:()=>t("rankings"),icon:L,label:"Rankings"}),e.jsx(se,{isActive:"display"===s,onClick:()=>t("display"),icon:P,label:"Display"}),e.jsx(se,{isActive:"export"===s,onClick:()=>t("export"),icon:X,label:"Export"}),e.jsx(se,{isActive:"categories"===s,onClick:()=>t("categories"),icon:G,label:"Categories"}),!l&&e.jsx(se,{isActive:"analyze"===s,onClick:()=>t("analyze"),icon:K,label:"Analyze"})]})}),e.jsxs("div",{className:"overflow-y-auto pt-4 select-text pb-3 flex-grow",children:["display"===s&&e.jsx(oe,{}),"rankings"===s&&e.jsx(re,{}),"export"===s&&e.jsx(te,{}),"categories"===s&&e.jsx(ne,{}),"analyze"===s&&e.jsx(ce,{})]})]})};export{me as default};
