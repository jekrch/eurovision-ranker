const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/IntroColumn-DD-TWspH.js","assets/index-BIrFF8jZ.js","assets/react-D41Hy763.js","assets/redux-BaDTb7KV.js","assets/index-DrU6UH8l.css","assets/App-3g-Zy4VU.js"])))=>i.map(i=>d[i]);
import{j as e,v as t,w as n,x as s,b as a,a as o,y as l,_ as r,n as i,z as c,e as d}from"./index-BIrFF8jZ.js";import{r as u,R as m}from"./redux-BaDTb7KV.js";import{S as f,C as x}from"./Card-BcR81bWQ.js";import{u as p,c as h,F as g,a as v,b,g as y,f as w,d as j,e as k,h as C,R as N,_ as E,i as S,r as T,n as R,j as $,k as P,l as L,m as M,o as O,p as z,q as D,s as F,t as A,v as U,w as I,x as W,y as B,z as _,P as V,I as G,A as H}from"./App-3g-Zy4VU.js";import{L as Y}from"./LazyFlag-CPqOTJag.js";import{D as X}from"./Dropdown-DP1BYetv.js";import{c as q,a as J,E as K}from"./ExportUtil-DKFZQHV2.js";import{R as Q}from"./index-Ds7ftMoK.js";import"./react-D41Hy763.js";const Z=e=>e.some((e=>{var t,n;return null==(n=null==(t=null==e?void 0:e.contestant)?void 0:t.youtube)?void 0:n.length})),ee=e=>{const t=e.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/);return t&&11===t[7].length?t[7]:null},te=e=>e?`https://img.youtube.com/vi/${e}/hqdefault.jpg`:null,ne=n=>{var s,a,o,l,r,i,c,d;const m=p((e=>e.categories)),f=p((e=>e.activeCategory)),x=p((e=>e.globalSearch)),N=p((e=>e.showTotalRank)),E=p((e=>e.showComparison)),S=p((e=>e.showThumbnail)),T=p((e=>e.showPlace)),R=p((e=>e.vote)),$=n.countryContestant.contestant,P=n.countryContestant.country,L=u.useRef(null);p((e=>e.theme));const M=(e=>{if(!e)return null;const t=ee(e);return te(t)||null})(null==$?void 0:$.youtube);u.useEffect((()=>{L.current&&(L.current.scrollLeft=n.categoryScrollPosition)}),[n.categoryScrollPosition]);const O=function(){if(N||E)return y(m,n.countryContestant)}();return e.jsxs("div",{children:[e.jsxs("div",{className:h(n.className,"m-auto text-slate-400 bg-[#03022d] bg-opacity-30 no-select","relative mx-[.5rem] min-h-[2.5em] py-[0.4em] flex flex-row","items-stretch !cursor-grabber whitespace-normal text-sm overflow-hidden","shadow rounded border border-0.5",n.isDragging?"shadow-slate-700 shadow-sm border-solid":"",n.isDragging||1!==n.rank?"":"first-card-glow",n.rank?"border-solid border-slate-400":"border-dashed"),style:{position:"relative"},children:[M&&S&&e.jsx("div",{className:"absolute top-0 right-0 h-full w-[30%] pointer-events-none overflow-hidden",children:e.jsx("div",{className:"relative w-full h-full",children:e.jsx("img",{src:M,className:"w-full h-full object-cover opacity-40",style:{display:"block",WebkitMaskImage:"linear-gradient(to right, transparent 0%, black 30%)",maskImage:"linear-gradient(to right, transparent 0%, black 30%)",objectPosition:"50% 50%",scale:"1.1"},onError:e=>{e.target.parentElement.parentElement.style.display="none"},onLoad:e=>{const t=e.target;120!==t.naturalWidth&&320!==t.naturalWidth||(t.parentElement.parentElement.style.display="none")},alt:""})})}),e.jsxs("div",{className:"relative z-10 flex flex-row items-stretch w-full",children:[e.jsx("div",{className:"-my-2 flex-shrink-0 pb-[1px] mr-3 font-bold w-8 pr-[0.01em] border-r-[0.05em] border-slate-500 bg-[#334678] bg-opacity-80 text-slate-300 tracking-tighter items-center justify-center flex text-lg rounded-sm",children:n.rank}),e.jsx("div",{className:"relative w-16 mr-3 flex items-center",children:e.jsxs("div",{className:"relative w-full",children:["yu"!==P.key?e.jsx(Y,{code:P.key,className:"w-full opacity-80"}):e.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/6/61/Flag_of_Yugoslavia_%281946-1992%29.svg",alt:"Flag of Yugoslavia",className:"w-full h-auto opacity-80"}),x&&$&&e.jsx("div",{className:"bottom-0 left-0 right-0 bg-slate-600 bg-opacity-30 text-slate-300 text-sm font-bold text-center py-1",children:$.year})]})}),e.jsxs("div",{className:h("flex-grow text-slate-300 font-bold"),children:[e.jsxs("div",{className:"overflow-hidden overflow-ellipsis",children:[e.jsxs("span",{className:h("float-right flex flex-row items-center",(null==$?void 0:$.youtube)?"bg-opacity-80 bg-[#1c214c] border-[0.1em] border-gray-600 rounded-[0.2em] px-[0.5em] py-[0.1em] mr-[0.4em]":""),children:[(null==$?void 0:$.youtube)&&e.jsx("div",{onClick:()=>{n.openSongModal()},className:"cursor-pointer rounded text-slate-500 hover:text-slate-300 mr-[0.9em] -ml-1",children:e.jsx(g,{className:"text-base",title:"lyrics"})}),(null==$?void 0:$.youtube)&&e.jsx("a",{href:null==$?void 0:$.youtube,target:"_blank",rel:"noopener noreferrer",className:"rounded text-slate-500 hover:text-slate-300",children:e.jsx(v,{className:"text-xl -m-[0.1em] my-[0.1em]",title:"youtube"})})]}),e.jsx("span",{className:"overflow-hidden overflow-ellipsis",children:null==P?void 0:P.name})]}),e.jsx("div",{className:"pr-[1.5em] flex flex-grow items-center justify-between font-normal",children:e.jsx("div",{className:"",children:$?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"font-xs text-sm text-slate-400",children:null==$?void 0:$.artist}),e.jsx("span",{className:h("ml-2 font-xs text-xs text-slate-400 rounded-sm bg-[#1c214c] bg-opacity-60"),children:(null==(s=$.song)?void 0:s.length)&&!(null==(a=$.song)?void 0:a.includes("TBD"))?`"${$.song}"`:`${$.song}`}),e.jsxs("div",{className:"mt-1 font-xs text-xs text-gray-400 mb-1 flex flex-wrap",children:[void 0!==(null==(o=null==$?void 0:$.votes)?void 0:o.totalPoints)&&t(R,"t")&&e.jsxs("div",{className:"flex items-center mr-2",children:[e.jsx("span",{className:"text-gray-500",children:"total: "}),e.jsx("span",{children:`${null==(l=null==$?void 0:$.votes)?void 0:l.totalPoints}`})]}),void 0!==(null==(r=null==$?void 0:$.votes)?void 0:r.telePoints)&&t(R,"tv")&&e.jsxs("div",{className:"flex items-center mr-2",children:[e.jsx("span",{className:"text-gray-500",children:"tele: "}),e.jsx("span",{children:`${null==(i=null==$?void 0:$.votes)?void 0:i.telePoints}`})]}),void 0!==(null==(c=null==$?void 0:$.votes)?void 0:c.juryPoints)&&t(R,"j")&&e.jsxs("div",{className:"flex items-center mr-2",children:[e.jsx("span",{className:"text-gray-500",children:"jury: "}),e.jsx("span",{children:`${null==(d=null==$?void 0:$.votes)?void 0:d.juryPoints}`})]})]}),(null==$?void 0:$.finalsRank)&&T&&e.jsxs("div",{className:"mt-1 font-xs text-xs text-gray-400 mb-0 flex flex-wrap items-center mr-2",children:[e.jsx("span",{className:"text-gray-500",children:"place: "}),e.jsx("span",{children:`${null==$?void 0:$.finalsRank}`})]})]}):e.jsx("span",{className:"font-xs text-xs text-gray-500 strong",children:"Did not participate"})})})]}),!N&&e.jsx("div",{id:"right-edge",className:"mb-[0em] absolute bottom-0 right-0 flex-shrink-0 flex flex-row justify-between text-xl font-bold text-slate-500 z-10",children:e.jsx("div",{id:"gripper",className:"text-right pl-[0.3em] mr-[0.3em]",children:"⋮⋮"})})]})]},n.rank?"ranked-":`unranked-card-${(null==$?void 0:$.id)??P.id}`),(null==m?void 0:m.length)>0&&(N||E)&&e.jsx("div",{ref:L,className:"mt-0 mx-[0.6em] shadow-lg rounded-b-md bg-[#1c214c] bg-opacity-100 border-gray-600 border-x-[0.01em] border-b-[0.01em] overflow-x-auto relative ml-[2em]",onScroll:n.onCategoryScroll,children:e.jsx("div",{className:"flex",children:m.map(((t,s)=>{if(!N&&s===f)return null;const a=null==O?void 0:O[t.name],{arrowIcon:o,rankDifference:l}=function(e,t){const n=e&&t?t-e:0;let s=null;return n<0?s=Math.abs(n)>=3?w:j:n>0&&(s=n>=3?k:C),{arrowIcon:s,rankDifference:n}}(n.rank,a);return e.jsxs("div",{className:"px-2 py-1 text-xs flex-shrink-0 text-slate-400 h-[2em] flex",title:`weight: ${t.weight}`,children:[e.jsxs("span",{className:"",children:[t.name,":"]})," ",e.jsx("span",{className:"ml-1 font-medium text-slate-300",children:a||"--"}),o&&e.jsx(b,{icon:o,className:h("pt-[0.2em] ml-1 inline-block text-sm text-opacity-40",l<0?"text-green-500":"text-red-500")})]},s)}))})})]})};function se(e,t){if(null==e)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.includes(s))continue;n[s]=e[s]}return n}function ae(e,t){return(ae=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function oe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,ae(e,t)}function le(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}const re=!1,ie=m.createContext(null);var ce=function(e){return e.scrollTop},de="unmounted",ue="exited",me="entering",fe="entered",xe="exiting",pe=function(e){function t(t,n){var s;s=e.call(this,t,n)||this;var a,o=n&&!n.isMounting?t.enter:t.appear;return s.appearStatus=null,t.in?o?(a=ue,s.appearStatus=me):a=fe:a=t.unmountOnExit||t.mountOnEnter?de:ue,s.state={status:a},s.nextCallback=null,s}oe(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===de?{status:ue}:null};var n=t.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==me&&n!==fe&&(t=me):n!==me&&n!==fe||(t=xe)}this.updateStatus(!1,t)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var e,t,n,s=this.props.timeout;return e=t=n=s,null!=s&&"number"!=typeof s&&(e=s.exit,t=s.enter,n=void 0!==s.appear?s.appear:t),{exit:e,enter:t,appear:n}},n.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===me){if(this.props.unmountOnExit||this.props.mountOnEnter){var n=this.props.nodeRef?this.props.nodeRef.current:N.findDOMNode(this);n&&ce(n)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===ue&&this.setState({status:de})},n.performEnter=function(e){var t=this,n=this.props.enter,s=this.context?this.context.isMounting:e,a=this.props.nodeRef?[s]:[N.findDOMNode(this),s],o=a[0],l=a[1],r=this.getTimeouts(),i=s?r.appear:r.enter;!e&&!n||re?this.safeSetState({status:fe},(function(){t.props.onEntered(o)})):(this.props.onEnter(o,l),this.safeSetState({status:me},(function(){t.props.onEntering(o,l),t.onTransitionEnd(i,(function(){t.safeSetState({status:fe},(function(){t.props.onEntered(o,l)}))}))})))},n.performExit=function(){var e=this,t=this.props.exit,n=this.getTimeouts(),s=this.props.nodeRef?void 0:N.findDOMNode(this);t&&!re?(this.props.onExit(s),this.safeSetState({status:xe},(function(){e.props.onExiting(s),e.onTransitionEnd(n.exit,(function(){e.safeSetState({status:ue},(function(){e.props.onExited(s)}))}))}))):this.safeSetState({status:ue},(function(){e.props.onExited(s)}))},n.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},n.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(s){n&&(n=!1,t.nextCallback=null,e(s))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},n.onTransitionEnd=function(e,t){this.setNextCallback(t);var n=this.props.nodeRef?this.props.nodeRef.current:N.findDOMNode(this),s=null==e&&!this.props.addEndListener;if(n&&!s){if(this.props.addEndListener){var a=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],o=a[0],l=a[1];this.props.addEndListener(o,l)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},n.render=function(){var e=this.state.status;if(e===de)return null;var t=this.props,n=t.children;t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef;var s=se(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return m.createElement(ie.Provider,{value:null},"function"==typeof n?n(e,s):m.cloneElement(m.Children.only(n),s))},t}(m.Component);function he(){}pe.contextType=ie,pe.propTypes={},pe.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:he,onEntering:he,onEntered:he,onExit:he,onExiting:he,onExited:he},pe.UNMOUNTED=de,pe.EXITED=ue,pe.ENTERING=me,pe.ENTERED=fe,pe.EXITING=xe;var ge=function(e,t){return e&&t&&t.split(" ").forEach((function(t){return s=t,void((n=e).classList?n.classList.remove(s):"string"==typeof n.className?n.className=le(n.className,s):n.setAttribute("class",le(n.className&&n.className.baseVal||"",s)));var n,s}))},ve=function(e){function t(){for(var t,n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return(t=e.call.apply(e,[this].concat(s))||this).appliedClasses={appear:{},enter:{},exit:{}},t.onEnter=function(e,n){var s=t.resolveArguments(e,n),a=s[0],o=s[1];t.removeClasses(a,"exit"),t.addClass(a,o?"appear":"enter","base"),t.props.onEnter&&t.props.onEnter(e,n)},t.onEntering=function(e,n){var s=t.resolveArguments(e,n),a=s[0],o=s[1]?"appear":"enter";t.addClass(a,o,"active"),t.props.onEntering&&t.props.onEntering(e,n)},t.onEntered=function(e,n){var s=t.resolveArguments(e,n),a=s[0],o=s[1]?"appear":"enter";t.removeClasses(a,o),t.addClass(a,o,"done"),t.props.onEntered&&t.props.onEntered(e,n)},t.onExit=function(e){var n=t.resolveArguments(e)[0];t.removeClasses(n,"appear"),t.removeClasses(n,"enter"),t.addClass(n,"exit","base"),t.props.onExit&&t.props.onExit(e)},t.onExiting=function(e){var n=t.resolveArguments(e)[0];t.addClass(n,"exit","active"),t.props.onExiting&&t.props.onExiting(e)},t.onExited=function(e){var n=t.resolveArguments(e)[0];t.removeClasses(n,"exit"),t.addClass(n,"exit","done"),t.props.onExited&&t.props.onExited(e)},t.resolveArguments=function(e,n){return t.props.nodeRef?[t.props.nodeRef.current,e]:[e,n]},t.getClassNames=function(e){var n=t.props.classNames,s="string"==typeof n,a=s?""+(s&&n?n+"-":"")+e:n[e];return{baseClassName:a,activeClassName:s?a+"-active":n[e+"Active"],doneClassName:s?a+"-done":n[e+"Done"]}},t}oe(t,e);var n=t.prototype;return n.addClass=function(e,t,n){var s=this.getClassNames(t)[n+"ClassName"],a=this.getClassNames("enter").doneClassName;"appear"===t&&"done"===n&&a&&(s+=" "+a),"active"===n&&e&&ce(e),s&&(this.appliedClasses[t][n]=s,function(e,t){e&&t&&t.split(" ").forEach((function(t){return s=t,void((n=e).classList?n.classList.add(s):function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")}(n,s)||("string"==typeof n.className?n.className=n.className+" "+s:n.setAttribute("class",(n.className&&n.className.baseVal||"")+" "+s)));var n,s}))}(e,s))},n.removeClasses=function(e,t){var n=this.appliedClasses[t],s=n.base,a=n.active,o=n.done;this.appliedClasses[t]={},s&&ge(e,s),a&&ge(e,a),o&&ge(e,o)},n.render=function(){var e=this.props;e.classNames;var t=se(e,["classNames"]);return m.createElement(pe,E({},t,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},t}(m.Component);ve.defaultProps={classNames:""},ve.propTypes={};const be=({icon:t,text:n,className:s,url:a,onClick:o,afterClick:l})=>e.jsxs("li",{role:"menuitem",className:h("text-slate-300 bg-slate-600 hover:bg-slate-700 flex w-full cursor-pointer select-none items-center gap-2 px-3 pt-[9px] pb-2 text-start transition-all hover:bg-blue-gray-50 hover:text-blue-gray-900 focus:bg-blue-gray-50 focus:bg-opacity-80 focus:text-blue-gray-900 active:bg-blue-gray-50 active:bg-opacity-80 active:text-blue-gray-900 bg-opacity-95 hover:bg-opacity-100",s),onClick:void 0!==a?()=>{return e=a,void window.open(e,"_blank","noopener,noreferrer");var e}:()=>{null==o||o(),null==l||l()},children:[e.jsx("div",{className:"w-[1.2em] text-center",children:t&&e.jsx(b,{icon:t})}),e.jsx("p",{className:"text-sm font-medium",children:n})]}),ye=({buttonIcon:t,text:n,children:s})=>{const[a,o]=u.useState(!1),[l,r]=u.useState({opacity:0,visibility:"hidden",transition:"opacity 200ms ease, visibility 200ms ease"}),i=u.useRef(null);u.useEffect((()=>{if(i.current){const e=i.current.getBoundingClientRect(),t={top:`${e.top+window.scrollY}px`,left:e.left+window.scrollX-180+"px",opacity:a?1:0,visibility:a?"visible":"hidden",transition:"opacity 200ms ease, visibility 200ms ease"};r(t)}}),[a]);return e.jsxs("li",{ref:i,className:h("relative bg-slate-600 hover:bg-slate-700 flex w-full cursor-pointer select-none items-center justify-between gap-2 px-3 pt-[9px] pb-2 text-start transition-all bg-opacity-95 hover:bg-opacity-100",{"!bg-slate-700":a}),onClick:()=>{o(!a)},children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-[1.2em] text-center",children:t&&e.jsx(b,{icon:t})}),e.jsx("p",{className:h("text-sm font-medium mx-2"),children:n})]}),e.jsx(b,{icon:S,className:"transition-transform "+(a?"rotate-90":"")}),T.createPortal(e.jsx("ul",{style:l,className:"absolute shadow-lg shadow-blue-gray-500/10 rounded-sm border border-slate-500 overflow-auto flex flex-col min-w-[180px] z-20 ",children:s}),document.body)]})},we={voteCode:"",showPlace:!1,baseItemHeight:90,itemMargin:8,canvasWidth:500,padding:10,headerHeight:40,footerMargin:10,maxSongWidth:300,flagSize:60,rankWidth:40,cardCornerRadius:5,fontFamily:"Arial",pixelRatio:3,fontSizes:{title:28,rankNumber:28,countryName:16,artist:16,song:16,stats:12}},je={background:"#13172b",headerGradient:["#517cbc","#1a2a45","#9e33ea"],cardBackground:"rgba(40, 49, 91, 0.7)",cardBorder:"#94a3b8",rankBackground:"#334678",titleText:"#cbd5e1",rankText:"#cbd5e1",countryText:"#cbd5e1",artistText:"#94a3b8",songText:"#94a3b8",songBackground:"rgba(28, 33, 76, 0)",statLabelText:"#6b7280",statValueText:"#9ca3af",footerText:"#93c5fd",firstPlaceGlow:"rgba(100, 10, 10, 0.9)",firstPlaceGlowOpacity:.1,shadow:"rgba(0, 0, 0, 0.3)"},ke=(e,t,n)=>new Promise(((s,a)=>{fetch(e,{mode:"cors",headers:{Origin:window.location.origin}}).then((e=>{if(!e.ok)throw new Error(`Failed to load SVG: ${e.status} ${e.statusText}`);return e.text()})).then((o=>{const l=new Blob([o],{type:"image/svg+xml"}),r=URL.createObjectURL(l),i=new Image(t,n);i.onload=()=>{URL.revokeObjectURL(r),s(i)},i.onerror=()=>{URL.revokeObjectURL(r),a(new Error(`Failed to load SVG from ${e}`))},i.src=r})).catch(a)})),Ce=(e,t="normal")=>new Promise((n=>{document.fonts.ready.then((()=>{if(document.fonts.check(`${t} 16px ${e}`))n(!0);else try{const s=new FontFace(e,`local(${e})`,{weight:t});s.load().then((()=>{document.fonts.add(s),n(!0)})).catch((()=>{n(!1)}))}catch(s){n(!1)}}))})),Ne=(e,t,n,s,a,o=4)=>{s<2*o&&(o=s/2),a<2*o&&(o=a/2),e.beginPath(),e.moveTo(t+o,n),e.arcTo(t+s,n,t+s,n+a,o),e.arcTo(t+s,n+a,t,n+a,o),e.arcTo(t,n+a,t,n,o),e.arcTo(t,n,t+s,n,o),e.closePath(),e.fill()},Ee=(e,t,n,s,a,o)=>{e.fillStyle=(e=>{const t={al:"#dc3545",am:"#dc3545",au:"#28a745",at:"#dc3545",az:"#17a2b8",be:"#000000",hr:"#dc3545",cy:"#ffc107",cz:"#fd7e14",dk:"#343a40",ee:"#6f42c1",fi:"#28a745",fr:"#0d6efd",ge:"#dc3545",de:"#6c757d",gr:"#28a745",is:"#fd7e14",ie:"#28a745",il:"#28a745",it:"#28a745",lv:"#6f42c1",lt:"#ffc107",lu:"#dc3545",mt:"#28a745",me:"#6c757d",nl:"#fd7e14",no:"#dc3545",pl:"#6c757d",pt:"#28a745",sm:"#28a745",rs:"#dc3545",si:"#28a745",es:"#6f42c1",se:"#28a745",ch:"#6f42c1",ua:"#28a745",gb:"#28a745",uk:"#28a745"};if(t[e.toLowerCase()])return t[e.toLowerCase()];let n=0;for(let a=0;a<e.length;a++)n=e.charCodeAt(a)+((n<<5)-n);let s="#";for(let a=0;a<3;a++){const e=n>>8*a&255;s+=("00"+Math.min(Math.max(e,60),200).toString(16)).substr(-2)}return s})(t),e.fillRect(n,s,a,o),e.fillStyle="#ffffff",e.font="bold 16px Arial",e.textAlign="center",e.textBaseline="middle",e.fillText(t.toUpperCase(),n+a/2,s+o/2)},Se=(e,t,n,s,a,o,l,r)=>{e.fillStyle=l.background,((e,t,n,s,a,o=0,l="rgba(0, 0, 0, 0.3)")=>{e.save(),e.shadowColor=l,e.shadowBlur=4,e.shadowOffsetX=0,e.shadowOffsetY=2,o>0?Ne(e,t,n,s,a,o):e.fillRect(t,n,s,a),e.restore()})(e,t,n,s,a,r.cardCornerRadius,l.shadow),e.fillStyle=l.cardBackground,Ne(e,t,n,s,a,r.cardCornerRadius),e.strokeStyle=l.cardBorder,e.lineWidth=1,e.beginPath(),e.moveTo(t+r.cardCornerRadius,n),e.arcTo(t+s,n,t+s,n+a,r.cardCornerRadius),e.arcTo(t+s,n+a,t,n+a,r.cardCornerRadius),e.arcTo(t,n+a,t,n,r.cardCornerRadius),e.arcTo(t,n,t+s,n,r.cardCornerRadius),e.stroke()},Te=(e,s,a,o,l,r,i,c)=>{var d,u,m;const{country:f,contestant:x}=s,p=c.canvasWidth-2*c.padding,h=c.padding,g=l,v=g+r/2;Se(e,h,g,p,r,0,i,c),((e,t,n,s,a,o,l,r)=>{e.fillStyle=l.rankBackground,e.beginPath(),e.moveTo(n,s+r.cardCornerRadius),e.arcTo(n,s,n+r.cardCornerRadius,s,r.cardCornerRadius),e.lineTo(n+a,s),e.lineTo(n+a,s+o),e.lineTo(n+r.cardCornerRadius,s+o),e.arcTo(n,s+o,n,s+o-r.cardCornerRadius,r.cardCornerRadius),e.lineTo(n,s+r.cardCornerRadius),e.fill(),e.fillStyle=l.rankText,e.font=`bold ${r.fontSizes.rankNumber}px ${r.fontFamily}`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.toString(),n+a/2,s+o/2),e.strokeStyle=l.cardBorder,e.lineWidth=1,e.beginPath(),e.moveTo(n+a,s),e.lineTo(n+a,s+o),e.stroke()})(e,o,h,g,c.rankWidth,r,i,c);const b=h+c.rankWidth+15,y=v-.75*c.flagSize/2;((e,t,n,s,a,o,l)=>{if(t)try{e.globalAlpha=.8,e.drawImage(t,s,a,o,.75*o),e.globalAlpha=1}catch(r){Ee(e,n,s,a,o,.75*o)}else Ee(e,n,s,a,o,.75*o)})(e,a,f.key,b,y,c.flagSize);const w=b+c.flagSize+15;if(x){let s=1;if(x.song){e.font=`${c.fontSizes.song}px ${c.fontFamily}`;const t=`"${x.song}"`,n=x.artist;e.font=`${c.fontSizes.artist}px ${c.fontFamily}`;const a=p-(w+e.measureText(n).width+10-h)-40;if(e.measureText(t).width>a){const n=t.split(" ");let o=n[0],l=a;for(let t=1;t<n.length;t++){const a=o+" "+n[t];e.measureText(a).width<=l?o=a:(s++,o=n[t],l=c.maxSongWidth)}}}const a=x.votes&&n(c.voteCode),o=x.finalsRank&&c.showPlace,l=a||o,v=24;let b=g+(r-((2+(s>1?s-1:0)+(l?1:0))*v+(l?10:0)))/2+(n(c.voteCode)&&x.votes?15:5);e.fillStyle=i.countryText,e.font=`bold ${c.fontSizes.countryName}px ${c.fontFamily}`,e.textAlign="left",e.textBaseline="top",e.fillText(f.name,w,b),b+=v,e.fillStyle=i.artistText,e.font=`${c.fontSizes.artist}px ${c.fontFamily}`;const y=x.artist;if(e.fillText(y,w,b),x.song){e.font=`${c.fontSizes.song}px ${c.fontFamily}`;const t=`"${x.song}"`,n=w+e.measureText(y).width+10;if(e.measureText(t).width<=p-(n-h)-40){const s=e.measureText(t).width+8,a=c.fontSizes.song+2;e.fillStyle=i.songBackground,Ne(e,n-4,b-1,s,a,3),e.fillStyle=i.songText,e.fillText(t,n,b),b+=a}else{const s=t.split(" ");let a=[],o=s[0],l=n,r=p-(n-h)-40;for(let t=1;t<s.length;t++){const n=s[t],i=o+" "+n;e.measureText(i).width<=r?o=i:(a.push({text:o,x:l}),o=n,l=w,r=c.maxSongWidth)}a.push({text:o,x:l});const d=a.shift();if(d){const t=e.measureText(d.text).width+8,n=c.fontSizes.song+2;e.fillStyle=i.songBackground,Ne(e,d.x-4,b-1,t,n,3),e.fillStyle=i.songText,e.fillText(d.text,d.x,b)}b+=v,a.forEach((t=>{const n=e.measureText(t.text).width+8,s=c.fontSizes.song+2;e.fillStyle=i.songBackground,Ne(e,t.x-4,b-1,n,s,3),e.fillStyle=i.songText,e.fillText(t.text,t.x,b),b+=s}))}}else b+=v;if(a||o){let n=w;const s=80;if(b+=10,void 0!==(null==(d=x.votes)?void 0:d.totalPoints)&&t(c.voteCode,"t")&&(e.fillStyle=i.statLabelText,e.font=`${c.fontSizes.stats}px ${c.fontFamily}`,e.fillText("total:",n,b),e.fillStyle=i.statValueText,e.fillText(`${x.votes.totalPoints}`,n+35,b),n+=s),void 0!==(null==(u=x.votes)?void 0:u.telePoints)&&t(c.voteCode,"tv")&&(e.fillStyle=i.statLabelText,e.fillText("tele:",n,b),e.fillStyle=i.statValueText,e.fillText(`${x.votes.telePoints}`,n+35,b),n+=s),void 0!==(null==(m=x.votes)?void 0:m.juryPoints)&&t(c.voteCode,"j")&&(e.fillStyle=i.statLabelText,e.fillText("jury:",n,b),e.fillStyle=i.statValueText,e.fillText(`${x.votes.juryPoints}`,n+35,b)),x.finalsRank&&c.showPlace){const t=c.canvasWidth-80;e.fillStyle=i.statLabelText,e.font=`${c.fontSizes.stats}px ${c.fontFamily}`,e.fillText("place:",t,b),e.fillStyle=i.statValueText,e.fillText(`${x.finalsRank}`,t+40,b)}}}else e.fillStyle=i.countryText,e.font=`bold ${c.fontSizes.countryName}px ${c.fontFamily}`,e.textAlign="left",e.textBaseline="middle",e.fillText(f.name,w,g+r/2)},Re=async(e,t="My Eurovision Ranking",s={},a={})=>{const o={...we,...s},l={...je,...a},r=document.createElement("canvas"),i=r.getContext("2d");if(!i)throw new Error("Canvas 2D context not supported");await Ce(o.fontFamily,"normal"),await Ce(o.fontFamily,"bold");const{heights:c,totalHeight:d}=((e,t,s)=>{var a;const o=[];let l=0;for(const r of t){let t=s.baseItemHeight;if(null==(a=r.contestant)?void 0:a.song){e.font=`${s.fontSizes.song}px ${s.fontFamily}`;const a=`"${r.contestant.song}"`,o=r.contestant.artist;e.font=`${s.fontSizes.artist}px ${s.fontFamily}`;const l=e.measureText(o).width,i=s.padding+s.rankWidth+s.flagSize+15+l+15,c=s.canvasWidth-s.padding-i-40;let d=1;if(e.measureText(a).width>c){const n=a.split(" ");let o=n[0],l=c;for(let t=1;t<n.length;t++){const a=o+" "+n[t];e.measureText(a).width<=l?o=a:(d++,o=n[t],l=s.maxSongWidth)}t+=24*(d-1)}const u=r.contestant.votes&&n(s.voteCode),m=r.contestant.finalsRank&&s.showPlace,f=24*(d-1+2+(u||m?1:0))+(u||m?10:0);t=Math.max(t,f+30)}o.push(t),l+=t+s.itemMargin}return{heights:o,totalHeight:l}})(i,e,o),u=o.headerHeight+d+o.footerMargin+30,m=o.canvasWidth*o.pixelRatio,f=u*o.pixelRatio;r.width=m,r.height=f,r.style.width=`${o.canvasWidth}px`,r.style.height=`${u}px`,i.scale(o.pixelRatio,o.pixelRatio),i.fillStyle=l.background,i.fillRect(0,0,o.canvasWidth,u),((e,t,n,s,a,o)=>{const l=e.createLinearGradient(0,0,n,s);a.headerGradient.forEach(((e,t)=>{l.addColorStop(t/(a.headerGradient.length-1),e)})),e.fillStyle=l,e.fillRect(0,0,n,s),e.fillStyle=a.titleText,e.font=`bold ${o.fontSizes.title}px ${o.fontFamily}`,e.textAlign="center",e.textBaseline="middle",e.fillText(t,n/2,s/1.8)})(i,t,o.canvasWidth,o.headerHeight,l,o);const x=e.map((e=>e.country.key)),p={};await Promise.all(x.map((async e=>{try{const t=o.flagSize*Math.min(2,o.pixelRatio);p[e]=await(async(e,t,n)=>{try{const a=[`https://cdn.jsdelivr.net/gh/lipis/flag-icons/flags/4x3/${e.toLowerCase()}.svg`,`https://flagcdn.com/w320/${e.toLowerCase()}.png`,`https://flagsapi.com/${e.toUpperCase()}/flat/64.png`];for(const e of a)try{if(e.endsWith(".svg"))return await ke(e,t,n);{const s=new Image(t,n);return await new Promise(((t,n)=>{s.onload=()=>t(),s.onerror=n,s.crossOrigin="anonymous",s.src=e})),s}}catch(s){}throw new Error(`Could not load flag for ${e} from any source`)}catch(s){return null}})(e,t,.75*t)}catch(t){p[e]=null}})));let h=o.headerHeight+o.itemMargin;for(let n=0;n<e.length;n++){const t=e[n],s=n+1,a=c[n],r=p[t.country.key];Te(i,t,r,s,h,a,l,o),h+=a+o.itemMargin}return((e,t,n,s,a,o)=>{const l=e.createLinearGradient(0,0,n,0);o.headerGradient.forEach(((e,t)=>{l.addColorStop(t/(o.headerGradient.length-1),e)})),e.fillStyle=l,e.fillRect(0,a,n,s),e.fillStyle=o.footerText,e.font="14px Arial",e.textAlign="center",e.textBaseline="middle",e.fillText(t,n/2,a+s/2)})(i,"created with eurovision-ranker.com",o.canvasWidth,30,u-30,l),r},$e=({className:t="",showText:n=!0,afterClick:s=(()=>{})})=>{const[a,o]=u.useState(!1),l=p((e=>e.name)),r=p((e=>e.rankedItems)),i=p((e=>e.showPlace)),c=p((e=>e.vote));let d={};d.showPlace=i,d.voteCode=c;return e.jsx(be,{icon:$,text:"Download image",onClick:async()=>{if(0!==r.length){o(!0);try{await(async(e,t="",n={},s={})=>{if(0!==e.length){n.pixelRatio||(n.pixelRatio=2);try{const a=await Re(e,t,n,s),o=`eurovision-${t?t.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""):"eurovision-ranking"}.png`,l=await new Promise(((e,t)=>{a.toBlob((n=>{n?e(n):t(new Error("Failed to create image blob"))}),"image/png",1)})),r=URL.createObjectURL(l),i=document.createElement("a");i.href=r,i.download=o,i.click(),URL.revokeObjectURL(r),R.success("Ranking image downloaded successfully")}catch(a){R.error("Failed to create ranking image")}}else R.error("Please rank some countries first")})(r,l,d)}catch(e){R.error("Failed to create image")}finally{setTimeout((()=>{o(!1)}),1e3)}}else R.error("Please rank some countries first")},afterClick:s})},Pe=t=>{const[n,a]=u.useState(!1),o=u.useRef(null),l=p((e=>e.rankedItems)),r=p((e=>e.headerMenuOpen)),i=P(),c=u.useRef(null),d=e=>{var t;const n=e.target,s=(e=>{for(;e;){if(e.id&&e.id.startsWith("react-joyride"))return!0;e=e.parentElement}return!1})(n);(null==(t=o.current)?void 0:t.contains(n))||s||a(!1)};function m(){a(!1)}return u.useEffect((()=>(document.addEventListener("mousedown",d),()=>{document.removeEventListener("mousedown",d),clearTimeout(undefined),document.body.classList.remove("no-scroll")})),[]),u.useEffect((()=>{r?(a(!0),document.body.classList.add("no-scroll"),i(s(!1))):setTimeout((()=>{document.body.classList.remove("no-scroll")}),300)}),[r]),e.jsxs("div",{className:"relative inline-block",ref:o,children:[e.jsx("button",{className:h("tour-step-6 w-6 h-6 bg-[#6e6795] hover:bg-slate-400 rounded-full flex justify-center items-center cursor-pointer",{"!bg-slate-400":n}),onClick:()=>{const e=n;a(!n),e?setTimeout((()=>{document.body.classList.remove("no-scroll")}),300):document.body.classList.add("no-scroll")},children:e.jsx(b,{className:"text-slate-300",icon:L})}),e.jsx(ve,{in:n,timeout:200,classNames:"menu",nodeRef:c,unmountOnExit:!0,children:e.jsxs("ul",{role:"menu",className:"absolute z-20 min-w-[180px] right-0 mt-1 shadow-lg shadow-blue-gray-500/10 rounded-sm border border-slate-500 overflow-auto flex flex-col",children:[e.jsx(be,{icon:M,text:"View Heat Map",className:"tour-step-8",onClick:t.onMapClick,afterClick:m}),Z(l)&&e.jsx(be,{icon:O,text:"YouTube Playlist",className:"tour-step-7",onClick:()=>{var e;return window.open(null==(e=t.generateYoutubePlaylistUrl)?void 0:e.call(t),"_blank")},afterClick:m}),e.jsx(be,{icon:z,text:"Edit Name",onClick:()=>t.openNameModal(),afterClick:m}),e.jsx(be,{icon:D,text:"Categories",className:"tour-step-9",onClick:()=>t.openConfig("categories"),afterClick:m}),e.jsx(be,{icon:F,text:"Rankings",onClick:()=>t.openConfig("rankings"),afterClick:m}),e.jsx(be,{icon:A,text:"Display settings",onClick:()=>t.openConfig("display"),afterClick:m}),l.length>0&&e.jsx($e,{className:"text-blue-300 hover:text-white mr-2",iconClassName:"text-lg",afterClick:m}),e.jsxs(ye,{text:"Copy",buttonIcon:U,children:[e.jsx(be,{text:"URL",icon:I,onClick:q}),e.jsx(be,{text:"Text",icon:W,onClick:()=>J(l,K.TEXT)}),e.jsx(be,{text:"CSV",icon:B,onClick:()=>J(l,K.CSV)}),e.jsx(be,{text:"JSON",icon:B,onClick:()=>J(l,K.JSON)})]})]})})]})},Le=({setMapModalShow:t,generateYoutubePlaylistUrl:n,openNameModal:s,openConfig:r,supportedYears:i,className:c,downloadButton:d})=>{const m=P(),f=p((e=>e.year)),x=p((e=>e.name)),g=p((e=>e.globalSearch)),v=p((e=>e.rankedItems)),b=p((e=>e.showTotalRank)),y=p((e=>e.categories)),w=p((e=>e.showUnranked)),j=p((e=>e.activeCategory)),[k,C]=u.useState(0);return u.useEffect((()=>{0!==k?(b&&m(a(!1)),m(o(k-1))):!b&&(null==y?void 0:y.length)&&m(a(!0))}),[k]),u.useEffect((()=>{C(void 0!==j?j+1:0)}),[j]),e.jsxs("div",{className:h("z-40 rounded-t-md round-b-sm w-full text-center font-bold bg-blue-900 gradient-background text-slate-300 py-1 text-md tracking-tighter shadow-md ranked-bar-background",c),children:[w?e.jsx("div",{className:"w-full m-auto flex items-center justify-center",children:e.jsx(X,{className:"tour-step-1 min-w-[5em] w-auto",buttonClassName:"!h-[1.8em]",value:f,onChange:e=>{m(l(e))},options:i,showSearch:!0})}):e.jsxs("div",{className:"mr-2 ml-5 flex justify-between items-center",children:[(null==v?void 0:v.length)>0&&e.jsx(e.Fragment,{}),e.jsxs("div",{className:"justify-center w-full ml-2 mr-2",children:[g?null:f,x&&e.jsxs("span",{className:"font-bold text-slate-400 text-md",children:[g?"":" - ",x]})]}),e.jsx(Pe,{openNameModal:s,openConfig:r,onMapClick:t,generateYoutubePlaylistUrl:()=>n(v)})]}),!w&&y.length>0&&e.jsxs("div",{className:"flex bg-gray-800 bg-opacity-40 border-gray-200 mt-1 -mb-[0.2em] overflow-x-auto",children:[e.jsx(Q,{placeholder:e.jsx(e.Fragment,{}),children:e.jsx("button",{className:h("px-4 py-[0.2em] text-sm font-strong flex-shrink-0",0===k?"text-blue-400 border-b-0 border-blue-400":"text-gray-400 hover:text-blue-500"),onClick:()=>C(0),children:"Total"},"total-tab")},"total-ripple"),y.map(((t,n)=>e.jsx(Q,{placeholder:e.jsx(e.Fragment,{}),children:e.jsx("button",{className:h("px-4 py-[0.2em] text-sm font-medium flex-shrink-0",k===n+1?"text-blue-400 border-b-0 border-blue-400":"text-gray-500 hover:text-blue-500"),onClick:()=>C(n+1),children:t.name},`cat-btn-${n+1}`)},`ripple-${n+1}`)))]},"total-tab-container")]})},Me=m.lazy((()=>r((()=>import("./IntroColumn-DD-TWspH.js")),__vite__mapDeps([0,1,2,3,4,5])))),Oe=t=>{const[n,s]=u.useState(!1);return u.useEffect((()=>{s(!0)}),[]),e.jsx(u.Suspense,{fallback:e.jsx("div",{className:"w-[10em]"}),children:n?e.jsx(Me,{...t}):e.jsx("div",{children:"Loading..."})})},ze=({openSongModal:t,openModal:n,openConfigModal:s,setRunTour:a,openNameModal:o,openMapModal:l})=>{const r=P(),[m,g]=u.useState(0),v=p((e=>e.showUnranked)),b=p((e=>e.theme)),y=p((e=>e.showTotalRank)),w=p((e=>e.isDeleteMode)),j=p((e=>e.rankedItems)),k=p((e=>e.categories)),C=p((e=>e.activeCategory)),[N,E]=u.useState(0),S=e=>{E(e.currentTarget.scrollLeft)};u.useEffect((()=>{0!==m&&i(C,k,j)}),[m]);const T=u.useCallback((e=>{r(_(e)),g(Math.random())}),[r]);return e.jsx("div",{className:"tour-step-5 z-20",children:e.jsx(f,{droppableId:"rankedItems",children:i=>e.jsxs("div",{className:h("grid h-full max-h-full min-h-full grid-rows-[auto_1fr]"),children:[e.jsx(Le,{setMapModalShow:()=>l(),generateYoutubePlaylistUrl:()=>(e=>"https://www.youtube.com/watch_videos?video_ids="+e.map((e=>{var t,n,s;if(!(null==(n=null==(t=null==e?void 0:e.contestant)?void 0:t.youtube)?void 0:n.length))return;let a=new URL(null==(s=null==e?void 0:e.contestant)?void 0:s.youtube);return new URLSearchParams(a.search).get("v")})).filter((e=>null==e?void 0:e.length)).join(","))(j),supportedYears:c,openNameModal:o,openConfig:s,className:v?"min-w-[9em] max-w-50vw-6em":"w-[80vw] max-w-[30.5em] min-w-[20.5em]"}),e.jsx("div",{className:"px-1 overflow-y-auto h-full",children:e.jsxs("ul",{...i.droppableProps,ref:i.innerRef,className:h("overflow-y-auto overflow-x-hidden pt-3 ranked-items-background w-full h-full",v?"min-w-[9em] max-w-50vw-6em":"w-[85vw] max-w-[30em] min-w-[20em]",{"auroral-background":b.includes("ab")}),children:[0===j.length&&v&&e.jsx(Oe,{openModal:n,openConfigModal:s,setRunTour:a}),!v&&0===j.length&&e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("span",{className:"text-center mb-40 min-mt-5 text-slate-500 mx-10 text-sm",children:[e.jsx("div",{children:"Click 'Select' to choose"})," countries to rank",e.jsx("div",{children:e.jsx("img",{src:"/eurovision-heart.svg",alt:"Heart",style:{display:"inline",verticalAlign:"middle"},className:"ml-[0.5em] mt-3 w-5 h-5 opacity-70 grayscale"})})]})}),j.map(((n,s)=>e.jsx(V,{draggableId:(null==n?void 0:n.uid)??n.id,index:s,isDragDisabled:y,children:(a,o)=>e.jsx("li",{ref:a.innerRef,...a.draggableProps,...a.dragHandleProps,className:h("no-select m-2 mx-1",{"mt-0":0===s}),children:v?e.jsx(x,{className:"m-auto text-slate-400 bg-[#03022d] no-select",rank:s+1,countryContestant:n,isDeleteMode:v&&w,deleteCallBack:T,isDragging:o.isDragging},`card-${(null==n?void 0:n.uid)??n.id}`):e.jsx(ne,{rank:s+1,countryContestant:n,openSongModal:()=>t(n),isDragging:o.isDragging,categoryScrollPosition:N,onCategoryScroll:S},`card-${(null==n?void 0:n.uid)??n.id}`)},`li-${(null==n?void 0:n.uid)??n.id}`)},`draggable-${(null==n?void 0:n.uid)??n.id}`))),i.placeholder]})}),v&&(null==j?void 0:j.length)>0&&e.jsxs("div",{className:"pl-2 rounded-b-md h-8 bg-blue-900 ranked-bar-background text-slate-300 items-center flex shadow-md gradient-background",children:[e.jsx(G,{className:h("tour-step-4 ml-auto py-1 pl-[0.7em] pr-[0.9em] mr-0 w-[6em]",{"tada-animation-6s":v&&(null==j?void 0:j.length)}),onClick:()=>r(d(!v)),title:"View List"}),e.jsx(H,{className:h("ml-2 mr-auto text-lg justify-center align-center bounce-right text-blue-300",{"tada-animation":v&&(null==j?void 0:j.length)})})]})]})})})};export{ze as default};
