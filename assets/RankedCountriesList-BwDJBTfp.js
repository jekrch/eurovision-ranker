const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/IntroColumn-DLA6Yn_X.js","assets/index-Chv81lTz.js","assets/react-D41Hy763.js","assets/redux-BaDTb7KV.js","assets/index-C3hiFuee.css","assets/App-CL3dfobV.js"])))=>i.map(i=>d[i]);
import{j as e,v as t,w as a,x as n,b as s,a as o,y as l,_ as r,n as i,z as c,e as d}from"./index-Chv81lTz.js";import{r as u,R as m}from"./redux-BaDTb7KV.js";import{S as x,C as f}from"./Card-DNkWSHA8.js";import{u as p,g as h,c as g,L as v,F as b,a as y,b as w,d as k,f as j,e as C,h as N,i as E,R as S,_ as T,j as R,r as $,n as P,k as M,l as L,m as O,o as z,p as D,q as F,s as A,t as B,v as I,w as U,x as W,y as _,z as V,A as G,B as H,C as Y,D as X,P as J,I as q,E as K}from"./App-CL3dfobV.js";import{D as Q}from"./Dropdown-BqHA0GYo.js";import{c as Z,a as ee,E as te}from"./ExportUtil-IQvlDQEF.js";import{R as ae}from"./index-I9aawsp_.js";import"./react-D41Hy763.js";const ne=a=>{var n,s,o,l,r,i,c,d;const m=p((e=>e.categories)),x=p((e=>e.activeCategory)),f=p((e=>e.globalSearch)),S=p((e=>e.showTotalRank)),T=p((e=>e.showComparison)),R=p((e=>e.showThumbnail)),$=p((e=>e.showPlace)),P=p((e=>e.vote)),M=a.countryContestant.contestant,L=a.countryContestant.country,O=u.useRef(null);p((e=>e.theme));const z=h(null==M?void 0:M.youtube);u.useEffect((()=>{O.current&&(O.current.scrollLeft=a.categoryScrollPosition)}),[a.categoryScrollPosition]);const D=function(){if(S||T)return k(m,a.countryContestant)}();return e.jsxs("div",{children:[e.jsxs("div",{className:g(a.className,"m-auto text-slate-400 bg-[#03022d] bg-opacity-30 no-select","relative mx-[.5rem] min-h-[2.5em] py-[0.4em] flex flex-row","items-stretch !cursor-grabber whitespace-normal text-sm overflow-hidden","shadow rounded border border-0.5",a.isDragging?"shadow-slate-700 shadow-sm border-solid":"",a.isDragging||1!==a.rank?"":"first-card-glow",a.rank?"border-solid border-slate-400":"border-dashed"),style:{position:"relative"},children:[z&&R&&e.jsx("div",{className:"absolute top-0 right-0 h-full w-[30%] pointer-events-none overflow-hidden",children:e.jsx("div",{className:"relative w-full h-full",children:e.jsx("img",{src:z,className:"w-full h-full object-cover opacity-40",style:{display:"block",WebkitMaskImage:"linear-gradient(to right, transparent 0%, black 30%)",maskImage:"linear-gradient(to right, transparent 0%, black 30%)",objectPosition:"50% 50%",scale:"1.1"},onError:e=>{e.target.parentElement.parentElement.style.display="none"},onLoad:e=>{const t=e.target;120!==t.naturalWidth&&320!==t.naturalWidth||(t.parentElement.parentElement.style.display="none")},alt:""})})}),e.jsxs("div",{className:"relative z-10 flex flex-row items-stretch w-full",children:[e.jsx("div",{className:"-my-2 flex-shrink-0 pb-[1px] mr-3 font-bold w-8 pr-[0.01em] border-r-[0.05em] border-slate-500 bg-[#334678] bg-opacity-80 text-slate-300 tracking-tighter items-center justify-center flex text-lg rounded-sm",children:a.rank}),e.jsx("div",{className:"relative w-14 min-w-14 mr-3 flex items-center",children:e.jsxs("div",{className:"relative w-full",children:["yu"!==L.key?e.jsx(v,{code:L.key,className:"w-full opacity-80"}):e.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/6/61/Flag_of_Yugoslavia_%281946-1992%29.svg",alt:"Flag of Yugoslavia",className:"w-full h-auto opacity-80"}),f&&M&&e.jsx("div",{className:"bottom-0 left-0 right-0 bg-slate-600 bg-opacity-30 text-slate-300 text-sm font-bold text-center py-1",children:M.year})]})}),e.jsxs("div",{className:g("flex-grow text-slate-300 font-bold"),children:[e.jsxs("div",{className:"overflow-hidden overflow-ellipsis",children:[e.jsxs("span",{className:g("float-right flex flex-row items-center",(null==M?void 0:M.youtube)?"bg-opacity-80 bg-[#1c214c] border-[0.1em] border-gray-600 rounded-[0.2em] px-[0.5em] py-[0.1em] mr-[0.4em]":""),children:[(null==M?void 0:M.youtube)&&e.jsx("div",{onClick:()=>{a.openSongModal()},className:"cursor-pointer rounded text-slate-500 hover:text-slate-300 mr-[0.9em] -ml-1",children:e.jsx(b,{className:"text-base",title:"lyrics"})}),(null==M?void 0:M.youtube)&&e.jsx("a",{href:null==M?void 0:M.youtube,target:"_blank",rel:"noopener noreferrer",className:"rounded text-slate-500 hover:text-slate-300",children:e.jsx(y,{className:"text-xl -m-[0.1em] my-[0.1em]",title:"youtube"})})]}),e.jsx("span",{className:"overflow-hidden overflow-ellipsis",children:null==L?void 0:L.name})]}),e.jsx("div",{className:"pr-[1.5em] flex flex-grow items-center justify-between font-normal",children:e.jsx("div",{className:"",children:M?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"font-xs text-sm text-slate-400",children:null==M?void 0:M.artist}),e.jsx("span",{className:g("ml-2 font-xs text-xs text-slate-400 rounded-sm bg-[#1c214c] bg-opacity-60"),children:(null==(n=M.song)?void 0:n.length)&&!(null==(s=M.song)?void 0:s.includes("TBD"))?`"${M.song}"`:`${M.song}`}),e.jsxs("div",{className:"mt-1 font-xs text-xs text-gray-400 mb-1 flex flex-wrap",children:[void 0!==(null==(o=null==M?void 0:M.votes)?void 0:o.totalPoints)&&t(P,"t")&&e.jsxs("div",{className:"flex items-center mr-2",children:[e.jsx("span",{className:"text-gray-500",children:"total: "}),e.jsx("span",{children:`${null==(l=null==M?void 0:M.votes)?void 0:l.totalPoints}`})]}),void 0!==(null==(r=null==M?void 0:M.votes)?void 0:r.telePoints)&&t(P,"tv")&&e.jsxs("div",{className:"flex items-center mr-2",children:[e.jsx("span",{className:"text-gray-500",children:"tele: "}),e.jsx("span",{children:`${null==(i=null==M?void 0:M.votes)?void 0:i.telePoints}`})]}),void 0!==(null==(c=null==M?void 0:M.votes)?void 0:c.juryPoints)&&t(P,"j")&&e.jsxs("div",{className:"flex items-center mr-2",children:[e.jsx("span",{className:"text-gray-500",children:"jury: "}),e.jsx("span",{children:`${null==(d=null==M?void 0:M.votes)?void 0:d.juryPoints}`})]})]}),(null==M?void 0:M.finalsRank)&&$&&e.jsxs("div",{className:"mt-1 font-xs text-xs text-gray-400 mb-0 flex flex-wrap items-center mr-2",children:[e.jsx("span",{className:"text-gray-500",children:"place: "}),e.jsx("span",{children:`${null==M?void 0:M.finalsRank}`})]})]}):e.jsx("span",{className:"font-xs text-xs text-gray-500 strong",children:"Did not participate"})})})]}),!S&&e.jsx("div",{id:"right-edge",className:"mb-[0em] absolute bottom-0 right-0 flex-shrink-0 flex flex-row justify-between text-xl font-bold text-slate-500 z-10",children:e.jsx("div",{id:"gripper",className:"text-right pl-[0.3em] mr-[0.3em]",children:"⋮⋮"})})]})]},a.rank?"ranked-":`unranked-card-${(null==M?void 0:M.id)??L.id}`),(null==m?void 0:m.length)>0&&(S||T)&&e.jsx("div",{ref:O,className:"mt-0 mx-[0.6em] shadow-lg rounded-b-md bg-[#1c214c] bg-opacity-100 border-gray-600 border-x-[0.01em] border-b-[0.01em] overflow-x-auto relative ml-[2em]",onScroll:a.onCategoryScroll,children:e.jsx("div",{className:"flex",children:m.map(((t,n)=>{if(!S&&n===x)return null;const s=null==D?void 0:D[t.name],{arrowIcon:o,rankDifference:l}=function(e,t){const a=e&&t?t-e:0;let n=null;return a<0?n=Math.abs(a)>=3?j:C:a>0&&(n=a>=3?N:E),{arrowIcon:n,rankDifference:a}}(a.rank,s);return e.jsxs("div",{className:"px-2 py-1 text-xs flex-shrink-0 text-slate-400 h-[2em] flex",title:`weight: ${t.weight}`,children:[e.jsxs("span",{className:"",children:[t.name,":"]})," ",e.jsx("span",{className:"ml-1 font-medium text-slate-300",children:s||"--"}),o&&e.jsx(w,{icon:o,className:g("pt-[0.2em] ml-1 inline-block text-sm text-opacity-40",l<0?"text-green-500":"text-red-500")})]},n)}))})})]})};function se(e,t){if(null==e)return{};var a={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;a[n]=e[n]}return a}function oe(e,t){return(oe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function le(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,oe(e,t)}function re(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}const ie=!1,ce=m.createContext(null);var de=function(e){return e.scrollTop},ue="unmounted",me="exited",xe="entering",fe="entered",pe="exiting",he=function(e){function t(t,a){var n;n=e.call(this,t,a)||this;var s,o=a&&!a.isMounting?t.enter:t.appear;return n.appearStatus=null,t.in?o?(s=me,n.appearStatus=xe):s=fe:s=t.unmountOnExit||t.mountOnEnter?ue:me,n.state={status:s},n.nextCallback=null,n}le(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===ue?{status:me}:null};var a=t.prototype;return a.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},a.componentDidUpdate=function(e){var t=null;if(e!==this.props){var a=this.state.status;this.props.in?a!==xe&&a!==fe&&(t=xe):a!==xe&&a!==fe||(t=pe)}this.updateStatus(!1,t)},a.componentWillUnmount=function(){this.cancelNextCallback()},a.getTimeouts=function(){var e,t,a,n=this.props.timeout;return e=t=a=n,null!=n&&"number"!=typeof n&&(e=n.exit,t=n.enter,a=void 0!==n.appear?n.appear:t),{exit:e,enter:t,appear:a}},a.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===xe){if(this.props.unmountOnExit||this.props.mountOnEnter){var a=this.props.nodeRef?this.props.nodeRef.current:S.findDOMNode(this);a&&de(a)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===me&&this.setState({status:ue})},a.performEnter=function(e){var t=this,a=this.props.enter,n=this.context?this.context.isMounting:e,s=this.props.nodeRef?[n]:[S.findDOMNode(this),n],o=s[0],l=s[1],r=this.getTimeouts(),i=n?r.appear:r.enter;!e&&!a||ie?this.safeSetState({status:fe},(function(){t.props.onEntered(o)})):(this.props.onEnter(o,l),this.safeSetState({status:xe},(function(){t.props.onEntering(o,l),t.onTransitionEnd(i,(function(){t.safeSetState({status:fe},(function(){t.props.onEntered(o,l)}))}))})))},a.performExit=function(){var e=this,t=this.props.exit,a=this.getTimeouts(),n=this.props.nodeRef?void 0:S.findDOMNode(this);t&&!ie?(this.props.onExit(n),this.safeSetState({status:pe},(function(){e.props.onExiting(n),e.onTransitionEnd(a.exit,(function(){e.safeSetState({status:me},(function(){e.props.onExited(n)}))}))}))):this.safeSetState({status:me},(function(){e.props.onExited(n)}))},a.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},a.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},a.setNextCallback=function(e){var t=this,a=!0;return this.nextCallback=function(n){a&&(a=!1,t.nextCallback=null,e(n))},this.nextCallback.cancel=function(){a=!1},this.nextCallback},a.onTransitionEnd=function(e,t){this.setNextCallback(t);var a=this.props.nodeRef?this.props.nodeRef.current:S.findDOMNode(this),n=null==e&&!this.props.addEndListener;if(a&&!n){if(this.props.addEndListener){var s=this.props.nodeRef?[this.nextCallback]:[a,this.nextCallback],o=s[0],l=s[1];this.props.addEndListener(o,l)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},a.render=function(){var e=this.state.status;if(e===ue)return null;var t=this.props,a=t.children;t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef;var n=se(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return m.createElement(ce.Provider,{value:null},"function"==typeof a?a(e,n):m.cloneElement(m.Children.only(a),n))},t}(m.Component);function ge(){}he.contextType=ce,he.propTypes={},he.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:ge,onEntering:ge,onEntered:ge,onExit:ge,onExiting:ge,onExited:ge},he.UNMOUNTED=ue,he.EXITED=me,he.ENTERING=xe,he.ENTERED=fe,he.EXITING=pe;var ve=function(e,t){return e&&t&&t.split(" ").forEach((function(t){return n=t,void((a=e).classList?a.classList.remove(n):"string"==typeof a.className?a.className=re(a.className,n):a.setAttribute("class",re(a.className&&a.className.baseVal||"",n)));var a,n}))},be=function(e){function t(){for(var t,a=arguments.length,n=new Array(a),s=0;s<a;s++)n[s]=arguments[s];return(t=e.call.apply(e,[this].concat(n))||this).appliedClasses={appear:{},enter:{},exit:{}},t.onEnter=function(e,a){var n=t.resolveArguments(e,a),s=n[0],o=n[1];t.removeClasses(s,"exit"),t.addClass(s,o?"appear":"enter","base"),t.props.onEnter&&t.props.onEnter(e,a)},t.onEntering=function(e,a){var n=t.resolveArguments(e,a),s=n[0],o=n[1]?"appear":"enter";t.addClass(s,o,"active"),t.props.onEntering&&t.props.onEntering(e,a)},t.onEntered=function(e,a){var n=t.resolveArguments(e,a),s=n[0],o=n[1]?"appear":"enter";t.removeClasses(s,o),t.addClass(s,o,"done"),t.props.onEntered&&t.props.onEntered(e,a)},t.onExit=function(e){var a=t.resolveArguments(e)[0];t.removeClasses(a,"appear"),t.removeClasses(a,"enter"),t.addClass(a,"exit","base"),t.props.onExit&&t.props.onExit(e)},t.onExiting=function(e){var a=t.resolveArguments(e)[0];t.addClass(a,"exit","active"),t.props.onExiting&&t.props.onExiting(e)},t.onExited=function(e){var a=t.resolveArguments(e)[0];t.removeClasses(a,"exit"),t.addClass(a,"exit","done"),t.props.onExited&&t.props.onExited(e)},t.resolveArguments=function(e,a){return t.props.nodeRef?[t.props.nodeRef.current,e]:[e,a]},t.getClassNames=function(e){var a=t.props.classNames,n="string"==typeof a,s=n?""+(n&&a?a+"-":"")+e:a[e];return{baseClassName:s,activeClassName:n?s+"-active":a[e+"Active"],doneClassName:n?s+"-done":a[e+"Done"]}},t}le(t,e);var a=t.prototype;return a.addClass=function(e,t,a){var n=this.getClassNames(t)[a+"ClassName"],s=this.getClassNames("enter").doneClassName;"appear"===t&&"done"===a&&s&&(n+=" "+s),"active"===a&&e&&de(e),n&&(this.appliedClasses[t][a]=n,function(e,t){e&&t&&t.split(" ").forEach((function(t){return n=t,void((a=e).classList?a.classList.add(n):function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")}(a,n)||("string"==typeof a.className?a.className=a.className+" "+n:a.setAttribute("class",(a.className&&a.className.baseVal||"")+" "+n)));var a,n}))}(e,n))},a.removeClasses=function(e,t){var a=this.appliedClasses[t],n=a.base,s=a.active,o=a.done;this.appliedClasses[t]={},n&&ve(e,n),s&&ve(e,s),o&&ve(e,o)},a.render=function(){var e=this.props;e.classNames;var t=se(e,["classNames"]);return m.createElement(he,T({},t,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},t}(m.Component);be.defaultProps={classNames:""},be.propTypes={};const ye=({icon:t,text:a,className:n,url:s,onClick:o,afterClick:l,disabled:r})=>e.jsxs("li",{role:"menuitem",className:g("text-slate-300 bg-slate-600 hover:bg-slate-700 flex w-full cursor-pointer select-none items-center gap-2 px-3 pt-[9px] pb-2 text-start transition-all hover:bg-blue-gray-50 hover:text-blue-gray-900 focus:bg-blue-gray-50 focus:bg-opacity-80 focus:text-blue-gray-900 active:bg-blue-gray-50 active:bg-opacity-80 active:text-blue-gray-900 bg-opacity-95 hover:bg-opacity-100",n),onClick:void 0!==s?()=>{return e=s,void(r||window.open(e,"_blank","noopener,noreferrer"));var e}:()=>{r||(null==o||o(),null==l||l())},children:[e.jsx("div",{className:"w-[1.2em] text-center",children:t&&e.jsx(w,{icon:t,color:r?"gray":"",className:g(r?"fill-slate-300":"")})}),e.jsx("p",{className:g("text-sm font-medium",r?"text-gray-400":""),children:a})]}),we=({buttonIcon:t,text:a,children:n})=>{const[s,o]=u.useState(!1),[l,r]=u.useState({opacity:0,visibility:"hidden",transition:"opacity 200ms ease, visibility 200ms ease"}),i=u.useRef(null);u.useEffect((()=>{if(i.current){const e=i.current.getBoundingClientRect(),t={top:`${e.top+window.scrollY}px`,left:e.left+window.scrollX-180+"px",opacity:s?1:0,visibility:s?"visible":"hidden",transition:"opacity 200ms ease, visibility 200ms ease"};r(t)}}),[s]);return e.jsxs("li",{ref:i,className:g("relative bg-slate-600 hover:bg-slate-700 flex w-full cursor-pointer select-none items-center justify-between gap-2 px-3 pt-[9px] pb-2 text-start transition-all bg-opacity-95 hover:bg-opacity-100",{"!bg-slate-700":s}),onClick:()=>{o(!s)},children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-[1.2em] text-center",children:t&&e.jsx(w,{icon:t})}),e.jsx("p",{className:g("text-sm font-medium mx-2"),children:a})]}),e.jsx(w,{icon:R,className:"transition-transform "+(s?"rotate-90":"")}),$.createPortal(e.jsx("ul",{style:l,className:"absolute shadow-lg shadow-blue-gray-500/10 rounded-sm border border-slate-500 overflow-auto flex flex-col min-w-[180px] z-20 ",children:n}),document.body)]})},ke={voteCode:"",showPlace:!1,baseItemHeight:90,itemMargin:8,canvasWidth:500,padding:10,headerHeight:40,footerMargin:10,maxSongWidth:300,flagSize:60,rankWidth:45,cardCornerRadius:4,fontFamily:"Arial",pixelRatio:3,fontSizes:{title:28,rankNumber:28,countryName:16,artist:16,song:16,stats:12}},je={background:"#13172b",headerGradient:["#517cbc","#1a2a45","#9e33ea"],cardBackground:"rgba(40, 49, 91, 0.7)",cardBorder:"#94a3b8",rankBackground:"#334678",titleText:"#cbd5e1",rankText:"#cbd5e1",countryText:"#cbd5e1",artistText:"#94a3b8",songText:"#94a3b8",songBackground:"rgba(28, 33, 76, 0)",statLabelText:"#6b7280",statValueText:"#9ca3af",footerText:"#93c5fd",firstPlaceGlow:"rgba(100, 10, 10, 0.9)",firstPlaceGlowOpacity:.1,shadow:"rgba(0, 0, 0, 0.3)"},Ce=(e,t,a)=>new Promise(((n,s)=>{fetch(e,{mode:"cors",headers:{Origin:window.location.origin}}).then((e=>{if(!e.ok)throw new Error(`Failed to load SVG: ${e.status} ${e.statusText}`);return e.text()})).then((o=>{const l=new Blob([o],{type:"image/svg+xml"}),r=URL.createObjectURL(l),i=new Image(t,a);i.onload=()=>{URL.revokeObjectURL(r),n(i)},i.onerror=()=>{URL.revokeObjectURL(r),s(new Error(`Failed to load SVG from ${e}`))},i.src=r})).catch(s)})),Ne=(e,t="normal")=>new Promise((a=>{document.fonts.ready.then((()=>{if(document.fonts.check(`${t} 16px ${e}`))a(!0);else try{const n=new FontFace(e,`local(${e})`,{weight:t});n.load().then((()=>{document.fonts.add(n),a(!0)})).catch((()=>{a(!1)}))}catch(n){a(!1)}}))})),Ee=(e,t,a,n,s,o=4)=>{n<2*o&&(o=n/2),s<2*o&&(o=s/2),e.beginPath(),e.moveTo(t+o,a),e.arcTo(t+n,a,t+n,a+s,o),e.arcTo(t+n,a+s,t,a+s,o),e.arcTo(t,a+s,t,a,o),e.arcTo(t,a,t+n,a,o),e.closePath(),e.fill()},Se=(e,t,a,n,s,o)=>{e.fillStyle=(e=>{const t={al:"#dc3545",am:"#dc3545",au:"#28a745",at:"#dc3545",az:"#17a2b8",be:"#000000",hr:"#dc3545",cy:"#ffc107",cz:"#fd7e14",dk:"#343a40",ee:"#6f42c1",fi:"#28a745",fr:"#0d6efd",ge:"#dc3545",de:"#6c757d",gr:"#28a745",is:"#fd7e14",ie:"#28a745",il:"#28a745",it:"#28a745",lv:"#6f42c1",lt:"#ffc107",lu:"#dc3545",mt:"#28a745",me:"#6c757d",nl:"#fd7e14",no:"#dc3545",pl:"#6c757d",pt:"#28a745",sm:"#28a745",rs:"#dc3545",si:"#28a745",es:"#6f42c1",se:"#28a745",ch:"#6f42c1",ua:"#28a745",gb:"#28a745",uk:"#28a745"};if(t[e.toLowerCase()])return t[e.toLowerCase()];let a=0;for(let s=0;s<e.length;s++)a=e.charCodeAt(s)+((a<<5)-a);let n="#";for(let s=0;s<3;s++){const e=a>>8*s&255;n+=("00"+Math.min(Math.max(e,60),200).toString(16)).substr(-2)}return n})(t),e.fillRect(a,n,s,o),e.fillStyle="#ffffff",e.font="bold 16px Arial",e.textAlign="center",e.textBaseline="middle",e.fillText(t.toUpperCase(),a+s/2,n+o/2)},Te=(e,t,a,n,s,o,l,r)=>{e.fillStyle=l.background,((e,t,a,n,s,o=0,l="rgba(0, 0, 0, 0.3)")=>{e.save(),e.shadowColor=l,e.shadowBlur=4,e.shadowOffsetX=0,e.shadowOffsetY=2,o>0?Ee(e,t,a,n,s,o):e.fillRect(t,a,n,s),e.restore()})(e,t,a,n,s,r.cardCornerRadius,l.shadow),e.fillStyle=l.cardBackground,Ee(e,t,a,n,s,r.cardCornerRadius),e.strokeStyle=l.cardBorder,e.lineWidth=1,e.beginPath(),e.moveTo(t+r.cardCornerRadius,a),e.arcTo(t+n,a,t+n,a+s,r.cardCornerRadius),e.arcTo(t+n,a+s,t,a+s,r.cardCornerRadius),e.arcTo(t,a+s,t,a,r.cardCornerRadius),e.arcTo(t,a,t+n,a,r.cardCornerRadius),e.stroke()},Re=(e,n,s,o,l,r,i,c)=>{var d,u,m;const{country:x,contestant:f}=n,p=c.canvasWidth-2*c.padding,h=c.padding,g=l,v=g+r/2;Te(e,h,g,p,r,0,i,c),((e,t,a,n,s,o,l,r)=>{e.fillStyle=l.rankBackground,e.beginPath(),e.moveTo(a,n+r.cardCornerRadius),e.arcTo(a,n,a+r.cardCornerRadius,n,r.cardCornerRadius),e.lineTo(a+s,n),e.lineTo(a+s,n+o),e.lineTo(a+r.cardCornerRadius,n+o),e.arcTo(a,n+o,a,n+o-r.cardCornerRadius,r.cardCornerRadius),e.lineTo(a,n+r.cardCornerRadius),e.fill(),e.fillStyle=l.rankText,e.font=`bold ${r.fontSizes.rankNumber}px ${r.fontFamily}`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.toString(),a+s/2,n+o/2),e.strokeStyle=l.cardBorder,e.lineWidth=1,e.beginPath(),e.moveTo(a+s,n),e.lineTo(a+s,n+o),e.stroke()})(e,o,h,g,c.rankWidth,r,i,c);const b=h+c.rankWidth+15,y=v-.75*c.flagSize/2;((e,t,a,n,s,o,l)=>{if(t)try{e.globalAlpha=.8,e.drawImage(t,n,s,o,.75*o),e.globalAlpha=1}catch(r){Se(e,a,n,s,o,.75*o)}else Se(e,a,n,s,o,.75*o)})(e,s,x.key,b,y,c.flagSize);const w=b+c.flagSize+15;if(f){let n=1;if(f.song){e.font=`${c.fontSizes.song}px ${c.fontFamily}`;const t=`"${f.song}"`,a=f.artist;e.font=`${c.fontSizes.artist}px ${c.fontFamily}`;const s=p-(w+e.measureText(a).width+10-h)-40;if(e.measureText(t).width>s){const a=t.split(" ");let o=a[0],l=s;for(let t=1;t<a.length;t++){const s=o+" "+a[t];e.measureText(s).width<=l?o=s:(n++,o=a[t],l=c.maxSongWidth)}}}const s=f.votes&&a(c.voteCode),o=f.finalsRank&&c.showPlace,l=s||o,v=24;let b=g+(r-((2+(n>1?n-1:0)+(l?1:0))*v+(l?10:0)))/2+(a(c.voteCode)&&f.votes?10:5);e.fillStyle=i.countryText,e.font=`bold ${c.fontSizes.countryName}px ${c.fontFamily}`,e.textAlign="left",e.textBaseline="top",e.fillText(x.name,w,b),b+=v,e.fillStyle=i.artistText,e.font=`${c.fontSizes.artist}px ${c.fontFamily}`;const y=f.artist;if(e.fillText(y,w,b),f.song){e.font=`${c.fontSizes.song}px ${c.fontFamily}`;const t=`"${f.song}"`,a=w+e.measureText(y).width+10;if(e.measureText(t).width<=p-(a-h)-40){const n=e.measureText(t).width+8,s=c.fontSizes.song+2;e.fillStyle=i.songBackground,Ee(e,a-4,b-1,n,s,3),e.fillStyle=i.songText,e.fillText(t,a,b),b+=s}else{const n=t.split(" ");let s=[],o=n[0],l=a,r=p-(a-h)-40;for(let t=1;t<n.length;t++){const a=n[t],i=o+" "+a;e.measureText(i).width<=r?o=i:(s.push({text:o,x:l}),o=a,l=w,r=c.maxSongWidth)}s.push({text:o,x:l});const d=s.shift();if(d){const t=e.measureText(d.text).width+8,a=c.fontSizes.song+2;e.fillStyle=i.songBackground,Ee(e,d.x-4,b-1,t,a,3),e.fillStyle=i.songText,e.fillText(d.text,d.x,b)}b+=v,s.forEach((t=>{const a=e.measureText(t.text).width+8,n=c.fontSizes.song+2;e.fillStyle=i.songBackground,Ee(e,t.x-4,b-1,a,n,3),e.fillStyle=i.songText,e.fillText(t.text,t.x,b),b+=n}))}}else b+=v;if(s||o){let a=w;const n=80;if(b+=10,void 0!==(null==(d=f.votes)?void 0:d.totalPoints)&&t(c.voteCode,"t")&&(e.fillStyle=i.statLabelText,e.font=`${c.fontSizes.stats}px ${c.fontFamily}`,e.fillText("total:",a,b),e.fillStyle=i.statValueText,e.fillText(`${f.votes.totalPoints}`,a+35,b),a+=n),void 0!==(null==(u=f.votes)?void 0:u.telePoints)&&t(c.voteCode,"tv")&&(e.fillStyle=i.statLabelText,e.fillText("tele:",a,b),e.fillStyle=i.statValueText,e.fillText(`${f.votes.telePoints}`,a+35,b),a+=n),void 0!==(null==(m=f.votes)?void 0:m.juryPoints)&&t(c.voteCode,"j")&&(e.fillStyle=i.statLabelText,e.fillText("jury:",a,b),e.fillStyle=i.statValueText,e.fillText(`${f.votes.juryPoints}`,a+35,b)),f.finalsRank&&c.showPlace){const t=c.canvasWidth-80;e.fillStyle=i.statLabelText,e.font=`${c.fontSizes.stats}px ${c.fontFamily}`,e.fillText("place:",t,b),e.fillStyle=i.statValueText,e.fillText(`${f.finalsRank}`,t+40,b)}}}else e.fillStyle=i.countryText,e.font=`bold ${c.fontSizes.countryName}px ${c.fontFamily}`,e.textAlign="left",e.textBaseline="middle",e.fillText(x.name,w,g+r/2)},$e=async(e,t="My Eurovision Ranking",n={},s={})=>{const o={...ke,...n},l={...je,...s},r=document.createElement("canvas"),i=r.getContext("2d");if(!i)throw new Error("Canvas 2D context not supported");await Ne(o.fontFamily,"normal"),await Ne(o.fontFamily,"bold");const{heights:c,totalHeight:d}=((e,t,n)=>{var s;const o=[];let l=0;for(const r of t){let t=n.baseItemHeight;if(null==(s=r.contestant)?void 0:s.song){e.font=`${n.fontSizes.song}px ${n.fontFamily}`;const s=`"${r.contestant.song}"`,o=r.contestant.artist;e.font=`${n.fontSizes.artist}px ${n.fontFamily}`;const l=e.measureText(o).width,i=n.padding+n.rankWidth+n.flagSize+15+l+15,c=n.canvasWidth-n.padding-i-40;let d=1;if(e.measureText(s).width>c){const a=s.split(" ");let o=a[0],l=c;for(let t=1;t<a.length;t++){const s=o+" "+a[t];e.measureText(s).width<=l?o=s:(d++,o=a[t],l=n.maxSongWidth)}t+=24*(d-1)}const u=r.contestant.votes&&a(n.voteCode),m=r.contestant.finalsRank&&n.showPlace,x=24*(d-1+2+(u||m?1:0))+(u||m?10:0);t=Math.max(t,x+30)}o.push(t),l+=t+n.itemMargin}return{heights:o,totalHeight:l}})(i,e,o),u=o.headerHeight+d+o.footerMargin+30,m=o.canvasWidth*o.pixelRatio,x=u*o.pixelRatio;r.width=m,r.height=x,r.style.width=`${o.canvasWidth}px`,r.style.height=`${u}px`,i.scale(o.pixelRatio,o.pixelRatio),i.fillStyle=l.background,i.fillRect(0,0,o.canvasWidth,u),((e,t,a,n,s,o)=>{const l=e.createLinearGradient(0,0,a,n);s.headerGradient.forEach(((e,t)=>{l.addColorStop(t/(s.headerGradient.length-1),e)})),e.fillStyle=l,e.fillRect(0,0,a,n),e.fillStyle=s.titleText,e.font=`bold ${o.fontSizes.title}px ${o.fontFamily}`,e.textAlign="center",e.textBaseline="middle",e.fillText(t,a/2,n/1.8)})(i,t,o.canvasWidth,o.headerHeight,l,o);const f=e.map((e=>e.country.key)),p={};await Promise.all(f.map((async e=>{try{const t=o.flagSize*Math.min(2,o.pixelRatio);p[e]=await(async(e,t,a)=>{try{const s=[`https://flagcdn.com/w320/${e.toLowerCase()}.png`,`https://flagsapi.com/${e.toUpperCase()}/flat/64.png`];for(const e of s)try{if(e.endsWith(".svg"))return await Ce(e,t,a);{const n=new Image(t,a);return await new Promise(((t,a)=>{n.onload=()=>t(),n.onerror=a,n.crossOrigin="anonymous",n.src=e})),n}}catch(n){}throw new Error(`Could not load flag for ${e} from any source`)}catch(n){return null}})(e,t,.75*t)}catch(t){p[e]=null}})));let h=o.headerHeight+o.itemMargin;for(let a=0;a<e.length;a++){const t=e[a],n=a+1,s=c[a],r=p[t.country.key];Re(i,t,r,n,h,s,l,o),h+=s+o.itemMargin}return((e,t,a,n,s,o)=>{const l=e.createLinearGradient(0,0,a,0);o.headerGradient.forEach(((e,t)=>{l.addColorStop(t/(o.headerGradient.length-1),e)})),e.fillStyle=l,e.fillRect(0,s,a,n),e.fillStyle=o.footerText,e.font="14px Arial",e.textAlign="center",e.textBaseline="middle",e.fillText(t,a/2,s+n/2)})(i,"created with eurovision-ranker.com",o.canvasWidth,30,u-30,l),r},Pe=({className:t="",showText:a=!0,afterClick:n=(()=>{})})=>{const[s,o]=u.useState(!1),l=p((e=>e.name)),r=p((e=>e.rankedItems)),i=p((e=>e.showPlace)),c=p((e=>e.vote));let d={};d.showPlace=i,d.voteCode=c;return e.jsx(ye,{icon:M,text:"Download image",onClick:async()=>{if(0!==r.length){o(!0);try{await(async(e,t="",a={},n={})=>{if(0!==e.length){a.pixelRatio||(a.pixelRatio=2);try{const s=await $e(e,t,a,n),o=`eurovision-${t?t.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""):"eurovision-ranking"}.png`,l=await new Promise(((e,t)=>{s.toBlob((a=>{a?e(a):t(new Error("Failed to create image blob"))}),"image/png",1)})),r=URL.createObjectURL(l),i=document.createElement("a");i.href=r,i.download=o,i.click(),URL.revokeObjectURL(r),P.success("Ranking image downloaded successfully")}catch(s){P.error("Failed to create ranking image")}}else P.error("Please rank some countries first")})(r,l,d)}catch(e){P.error("Failed to create image")}finally{setTimeout((()=>{o(!1)}),1e3)}}else P.error("Please rank some countries first")},afterClick:n})},Me=t=>{const[a,s]=u.useState(!1),o=u.useRef(null),l=p((e=>e.rankedItems)),r=p((e=>e.headerMenuOpen)),i=L(),c=u.useRef(null),d=p((e=>e.showTotalRank)),m=e=>{var t;const a=e.target,n=(e=>{for(;e;){if(e.id&&e.id.startsWith("react-joyride"))return!0;e=e.parentElement}return!1})(a);(null==(t=o.current)?void 0:t.contains(a))||n||s(!1)};function x(){s(!1)}return u.useEffect((()=>(document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m),clearTimeout(undefined),document.body.classList.remove("no-scroll")})),[]),u.useEffect((()=>{r?(s(!0),document.body.classList.add("no-scroll"),i(n(!1))):setTimeout((()=>{document.body.classList.remove("no-scroll")}),300)}),[r]),e.jsxs("div",{className:"relative inline-block",ref:o,children:[e.jsx("button",{className:g("tour-step-6 w-6 h-6 bg-[#6e6795] hover:bg-slate-400 rounded-full flex justify-center items-center cursor-pointer",{"!bg-slate-400":a}),onClick:()=>{const e=a;s(!a),e?setTimeout((()=>{document.body.classList.remove("no-scroll")}),300):document.body.classList.add("no-scroll")},children:e.jsx(w,{className:"text-slate-300",icon:O})}),e.jsx(be,{in:a,timeout:200,classNames:"menu",nodeRef:c,unmountOnExit:!0,children:e.jsxs("ul",{role:"menu",className:"absolute z-20 min-w-[180px] right-0 mt-1 shadow-lg shadow-blue-gray-500/10 rounded-sm border border-slate-500 overflow-auto flex flex-col",children:[e.jsx(ye,{icon:z,text:"View Heat Map",className:"tour-step-8",onClick:t.onMapClick,afterClick:x}),D(l)&&e.jsx(ye,{icon:F,text:"YouTube Playlist",className:"tour-step-7",onClick:()=>{var e;return window.open(null==(e=t.generateYoutubePlaylistUrl)?void 0:e.call(t),"_blank")},afterClick:x}),e.jsx(ye,{icon:A,text:"Edit Name",onClick:()=>t.openNameModal(),afterClick:x}),e.jsx(ye,{icon:B,text:"Categories",className:"tour-step-9",onClick:()=>t.openConfig("categories"),afterClick:x}),e.jsx(ye,{icon:I,text:"Rankings",onClick:()=>t.openConfig("rankings"),afterClick:x}),e.jsx(ye,{icon:U,text:"Display settings",onClick:()=>t.openConfig("display"),afterClick:x}),e.jsx(ye,{icon:W,text:"Use Sorter",onClick:t.openSorterModal,disabled:l.length<2||d,afterClick:x}),l.length>0&&e.jsx(Pe,{className:"text-blue-300 hover:text-white mr-2",iconClassName:"text-lg",afterClick:x}),e.jsxs(we,{text:"Copy",buttonIcon:_,children:[e.jsx(ye,{text:"URL",icon:V,onClick:Z}),e.jsx(ye,{text:"Text",icon:G,onClick:()=>ee(l,te.TEXT)}),e.jsx(ye,{text:"CSV",icon:H,onClick:()=>ee(l,te.CSV)}),e.jsx(ye,{text:"JSON",icon:H,onClick:()=>ee(l,te.JSON)})]})]})})]})},Le=({setMapModalShow:t,generateYoutubePlaylistUrl:a,openNameModal:n,openConfig:r,supportedYears:i,className:c,downloadButton:d,openSorterModal:m})=>{const x=L(),f=p((e=>e.year)),h=p((e=>e.name)),v=p((e=>e.globalSearch)),b=p((e=>e.rankedItems)),y=p((e=>e.showTotalRank)),k=p((e=>e.categories)),j=p((e=>e.showUnranked)),C=p((e=>e.activeCategory)),[N,E]=u.useState(0);u.useEffect((()=>{0!==N?(y&&x(s(!1)),x(o(N-1))):!y&&(null==k?void 0:k.length)&&x(s(!0))}),[N]),u.useEffect((()=>{E(void 0!==C?C+1:0)}),[C]);const S=b.length<2||y;return e.jsxs("div",{className:g("z-40 rounded-t-md round-b-sm w-full text-center font-bold bg-blue-900 gradient-background text-slate-300 py-1 text-md tracking-tighter shadow-md ranked-bar-background",c),children:[j?e.jsx("div",{className:"w-full m-auto flex items-center justify-center",children:e.jsx(Q,{className:"tour-step-1 min-w-[5em] w-auto",buttonClassName:"!h-[1.8em]",value:f,onChange:e=>{x(l(e))},options:i,showSearch:!0})}):e.jsxs("div",{className:"mx-2 flex justify-between items-center",children:[e.jsxs("div",{className:"w-6 h-6 tour-step-10",children:[" ",(null==b?void 0:b.length)>0&&e.jsx("button",{title:S?"Sorter unavailable (need >1 item and not on Total Rank tab)":"Open Sorter","aria-label":"Open Sorter",className:g("w-6 h-6 bg-[#6e6795] rounded-full flex justify-center items-center text-slate-400 hover:text-slate-500",{"hover:bg-slate-400 hover:cursor-pointer":!S,"opacity-50 cursor-not-allowed":S}),onClick:m,disabled:S,children:e.jsx(w,{className:"",icon:W})})]}),e.jsxs("div",{className:"justify-center text-center flex-grow mx-2",children:[" ",v?null:f,h&&e.jsxs("span",{className:"font-bold text-slate-400 text-md",children:[v?"":" - ",h]})]}),e.jsx(Me,{openNameModal:n,openConfig:r,onMapClick:t,openSorterModal:m,generateYoutubePlaylistUrl:()=>a(b)})]}),!j&&k.length>0&&e.jsxs("div",{className:"flex bg-gray-800 bg-opacity-40 border-gray-200 mt-1 -mb-[0.2em] overflow-x-auto",children:[e.jsx(ae,{placeholder:e.jsx(e.Fragment,{}),children:e.jsx("button",{className:g("px-4 py-[0.2em] text-sm font-strong flex-shrink-0",0===N?"text-blue-400 border-b-0 border-blue-400":"text-gray-400 hover:text-blue-500"),onClick:()=>E(0),children:"Total"},"total-tab")},"total-ripple"),k.map(((t,a)=>e.jsx(ae,{placeholder:e.jsx(e.Fragment,{}),children:e.jsx("button",{className:g("px-4 py-[0.2em] text-sm font-medium flex-shrink-0",N===a+1?"text-blue-400 border-b-0 border-blue-400":"text-gray-500 hover:text-blue-500"),onClick:()=>E(a+1),children:t.name},`cat-btn-${a+1}`)},`ripple-${a+1}`)))]},"total-tab-container")]})},Oe=m.lazy((()=>r((()=>import("./IntroColumn-DLA6Yn_X.js")),__vite__mapDeps([0,1,2,3,4,5])))),ze=t=>{const[a,n]=u.useState(!1);return u.useEffect((()=>{n(!0)}),[]),e.jsx(u.Suspense,{fallback:e.jsx("div",{className:"w-[10em]"}),children:a?e.jsx(Oe,{...t}):e.jsx("div",{children:"Loading..."})})},De=({openSongModal:t,openModal:a,openConfigModal:n,setRunTour:s,setRunSortTour:o,openNameModal:l,openMapModal:r,openSorterModal:m})=>{const h=L(),[v,b]=u.useState(0),y=p((e=>e.showUnranked)),w=p((e=>e.theme)),k=p((e=>e.showTotalRank)),j=p((e=>e.isDeleteMode)),C=p((e=>e.rankedItems)),N=p((e=>e.categories)),E=p((e=>e.activeCategory)),[S,T]=u.useState(0),R=e=>{T(e.currentTarget.scrollLeft)};u.useEffect((()=>{0!==v&&i(E,N,C)}),[v]);const $=u.useCallback((e=>{h(Y(e)),b(Math.random())}),[h]);return e.jsx("div",{className:"tour-step-5 z-20",children:e.jsx(x,{droppableId:"rankedItems",children:i=>e.jsxs("div",{className:g("grid h-full max-h-full min-h-full grid-rows-[auto_1fr]"),children:[e.jsx(Le,{setMapModalShow:()=>r(),generateYoutubePlaylistUrl:()=>X(C),supportedYears:c,openNameModal:l,openConfig:n,openSorterModal:m,className:y?"min-w-[9em] max-w-50vw-6em":"w-[80vw] max-w-[30.5em] min-w-[20.5em]"}),e.jsx("div",{className:"px-1 overflow-y-auto h-full",children:e.jsxs("ul",{...i.droppableProps,ref:i.innerRef,className:g("overflow-y-auto overflow-x-hidden pt-3 ranked-items-background w-full h-full",y?"min-w-[9em] max-w-50vw-6em":"w-[85vw] max-w-[30em] min-w-[20em]",{"auroral-background":w.includes("ab")}),children:[0===C.length&&y&&e.jsx(ze,{openModal:a,openConfigModal:n,setRunTour:s,setRunSortTour:o}),!y&&0===C.length&&e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("span",{className:"text-center mb-40 min-mt-5 text-slate-500 mx-10 text-sm",children:[e.jsx("div",{children:"Click 'Select' to choose"})," countries to rank",e.jsx("div",{children:e.jsx("img",{src:"/eurovision-heart.svg",alt:"Heart",style:{display:"inline",verticalAlign:"middle"},className:"ml-[0.5em] mt-3 w-5 h-5 opacity-70 grayscale"})})]})}),C.map(((a,n)=>e.jsx(J,{draggableId:(null==a?void 0:a.uid)??a.id,index:n,isDragDisabled:k,children:(s,o)=>e.jsx("li",{ref:s.innerRef,...s.draggableProps,...s.dragHandleProps,className:g("no-select m-2 mx-1",{"mt-0":0===n}),children:y?e.jsx(f,{className:"m-auto text-slate-400 bg-[#03022d] no-select",rank:n+1,countryContestant:a,isDeleteMode:y&&j,deleteCallBack:$,isDragging:o.isDragging},`card-${(null==a?void 0:a.uid)??a.id}`):e.jsx(ne,{rank:n+1,countryContestant:a,openSongModal:()=>t(a),isDragging:o.isDragging,categoryScrollPosition:S,onCategoryScroll:R},`card-${(null==a?void 0:a.uid)??a.id}`)},`li-${(null==a?void 0:a.uid)??a.id}`)},`draggable-${(null==a?void 0:a.uid)??a.id}`))),i.placeholder]})}),y&&(null==C?void 0:C.length)>0&&e.jsxs("div",{className:"pl-2 rounded-b-md h-8 bg-blue-900 ranked-bar-background text-slate-300 items-center flex shadow-md gradient-background",children:[e.jsx(q,{className:g("tour-step-4 ml-auto py-1 pl-[0.7em] pr-[0.9em] mr-0 w-[6em]",{"tada-animation-6s":y&&(null==C?void 0:C.length)}),onClick:()=>h(d(!y)),title:"View List"}),e.jsx(K,{className:g("ml-2 mr-auto text-lg justify-center align-center bounce-right text-blue-300",{"tada-animation":y&&(null==C?void 0:C.length)})})]})]})})})};export{De as default};
